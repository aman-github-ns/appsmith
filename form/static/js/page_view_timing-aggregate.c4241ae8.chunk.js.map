{"version":3,"file":"static/js/page_view_timing-aggregate.c4241ae8.chunk.js","mappings":"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","sources":["../node_modules/@newrelic/browser-agent/dist/esm/common/harvest/harvest-scheduler.js","../node_modules/@newrelic/browser-agent/dist/esm/common/serialize/bel-serializer.js","../node_modules/@newrelic/browser-agent/dist/esm/common/unload/eol.js","../node_modules/@newrelic/browser-agent/dist/esm/common/vitals/time-to-first-byte.js","../node_modules/@newrelic/browser-agent/dist/esm/common/vitals/cumulative-layout-shift.js","../node_modules/@newrelic/browser-agent/dist/esm/common/vitals/first-input-delay.js","../node_modules/@newrelic/browser-agent/dist/esm/common/vitals/interaction-to-next-paint.js","../node_modules/@newrelic/browser-agent/dist/esm/common/vitals/largest-contentful-paint.js","../node_modules/@newrelic/browser-agent/dist/esm/common/vitals/long-task.js","../node_modules/@newrelic/browser-agent/dist/esm/features/page_view_timing/aggregate/index.js"],"sourcesContent":["/*\n * Copyright 2020 New Relic Corporation. All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as submitData from '../util/submit-data';\nimport { SharedContext } from '../context/shared-context';\nimport { Harvest } from './harvest';\nimport { subscribeToEOL } from '../unload/eol';\nimport { SESSION_EVENTS } from '../session/constants';\n\n/**\n * Periodically invokes harvest calls and handles retries\n */\nexport class HarvestScheduler extends SharedContext {\n  /**\n     * Create a HarvestScheduler\n     * @param {string} endpoint - The base BAM endpoint name -- ex. 'events'\n     * @param {object} opts - The options used to configure the HarvestScheduler\n     * @param {Function} opts.onFinished - The callback to be fired when a harvest has finished\n     * @param {Function} opts.getPayload - A callback which can be triggered to return a payload for harvesting\n     * @param {number} opts.retryDelay - The number of seconds to wait before retrying after a network failure\n     * @param {boolean} opts.raw - Use a prefabricated payload shape as the harvest payload without the need for formatting\n     * @param {string} opts.customUrl - A custom url that falls outside of the shape of the standard BAM harvester url pattern.  Will use directly instead of concatenating various pieces\n     * @param {*} parent - The parent object, whose state can be passed into SharedContext\n     */\n  constructor(endpoint, opts, parent) {\n    super(parent); // gets any allowed properties from the parent and stores them in `sharedContext`\n    this.endpoint = endpoint;\n    this.opts = opts || {};\n    this.started = false;\n    this.timeoutHandle = null;\n    this.aborted = false; // this controls the per-interval and final harvests for the scheduler (currently per feature specific!)\n\n    this.harvest = new Harvest(this.sharedContext);\n\n    // unload if EOL mechanism fires\n    subscribeToEOL(this.unload.bind(this));\n\n    /* Flush all buffered data if session resets and give up retries. This should be synchronous to ensure that the correct `session` value is sent.\n      Since session-reset generates a new session ID and the ID is grabbed at send-time, any delays or retries would cause the payload to be sent under\n      the wrong session ID. */\n    this.sharedContext?.ee.on(SESSION_EVENTS.RESET, () => this.runHarvest({\n      forceNoRetry: true\n    }));\n  }\n\n  /**\n   * This function is only meant for the last outgoing harvest cycle of a page. It trickles down to using sendBeacon, which should not be used\n   * to send payloads while the page is still active, due to limitations on how much data can be buffered in the API at any one time.\n   */\n  unload() {\n    if (this.aborted) return;\n    // If opts.onUnload is defined, these are special actions to execute before attempting to send the final payload.\n    if (this.opts.onUnload) this.opts.onUnload();\n    this.runHarvest({\n      unload: true\n    });\n  }\n  startTimer(interval, initialDelay) {\n    this.interval = interval;\n    this.started = true;\n    this.scheduleHarvest(initialDelay != null ? initialDelay : this.interval);\n  }\n  stopTimer() {\n    let permanently = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    this.aborted = permanently; // stopping permanently is same as aborting, but this function also cleans up the setTimeout loop\n    this.started = false;\n    if (this.timeoutHandle) {\n      clearTimeout(this.timeoutHandle);\n    }\n  }\n  scheduleHarvest(delay, opts) {\n    if (this.timeoutHandle) return;\n    if (delay == null) {\n      delay = this.interval;\n    }\n    this.timeoutHandle = setTimeout(() => {\n      this.timeoutHandle = null;\n      this.runHarvest(opts);\n    }, delay * 1000);\n  }\n  runHarvest(opts) {\n    if (this.aborted) return;\n\n    /**\n     * This is executed immediately after harvest sends the data via XHR, or if there's nothing to send. Note that this excludes on unloading / sendBeacon.\n     * @param {Object} result\n     */\n    const cbRanAfterSend = result => {\n      if (opts?.forceNoRetry) result.retry = false; // discard unsent data rather than re-queuing for next harvest attempt\n      this.onHarvestFinished(opts, result);\n    };\n    let harvests = [];\n    let submitMethod;\n    let payload;\n    if (this.opts.getPayload) {\n      // Ajax & PVT & SR features provide a callback function to get data for harvesting\n      submitMethod = submitData.getSubmitMethod({\n        isFinalHarvest: opts?.unload\n      });\n      if (!submitMethod) return false;\n      const retry = !opts?.unload && submitMethod === submitData.xhr;\n      payload = this.opts.getPayload({\n        retry,\n        opts\n      });\n      if (!payload) {\n        if (this.started) {\n          this.scheduleHarvest();\n        }\n        return;\n      }\n      payload = Object.prototype.toString.call(payload) === '[object Array]' ? payload : [payload];\n      harvests.push(...payload);\n    }\n\n    /** sendX is used for features that do not supply a preformatted payload via \"getPayload\" */\n    let send = args => this.harvest.sendX(args);\n    if (harvests.length) {\n      /** _send is the underlying method for sending in the harvest, if sending raw we can bypass the other helpers completely which format the payloads */\n      if (this.opts.raw) send = args => this.harvest._send(args);\n      /** send is used to formated the payloads from \"getPayload\" and obfuscate before sending */else send = args => this.harvest.send(args);\n    } else {\n      // force it to run at least once in sendX mode\n      harvests.push(undefined);\n    }\n    harvests.forEach(payload => {\n      send({\n        endpoint: this.endpoint,\n        payload,\n        opts,\n        submitMethod,\n        cbFinished: cbRanAfterSend,\n        customUrl: this.opts.customUrl,\n        raw: this.opts.raw\n      });\n    });\n    if (this.started) {\n      this.scheduleHarvest();\n    }\n  }\n  onHarvestFinished(opts, result) {\n    if (this.opts.onFinished) {\n      this.opts.onFinished(result);\n    }\n    if (result.sent && result.retry) {\n      const delay = result.delay || this.opts.retryDelay;\n      // reschedule next harvest if should be delayed longer\n      if (this.started && delay) {\n        clearTimeout(this.timeoutHandle);\n        this.timeoutHandle = null;\n        this.scheduleHarvest(delay, opts);\n      } else if (!this.started && delay) {\n        // if not running on a timer, schedule a single retry\n        this.scheduleHarvest(delay, opts);\n      }\n    }\n  }\n}","/*\n * Copyright 2020 New Relic Corporation. All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { mapOwn } from '../util/map-own';\nimport { stringify } from '../util/stringify';\nimport { Obfuscator } from '../util/obfuscate';\nvar hasOwnProp = Object.prototype.hasOwnProperty;\nvar MAX_ATTRIBUTES = 64;\nexport function nullable(val, fn, comma) {\n  return val || val === 0 || val === '' ? fn(val) + (comma ? ',' : '') : '!';\n}\nexport function numeric(n, noDefault) {\n  if (noDefault) {\n    return Math.floor(n).toString(36);\n  }\n  return n === undefined || n === 0 ? '' : Math.floor(n).toString(36);\n}\nexport function getAddStringContext(agentIdentifier) {\n  // eslint-disable-next-line\n  var stringTable = Object.hasOwnProperty('create') ? Object.create(null) : {};\n  var stringTableIdx = 0;\n  return addString;\n  function addString(str) {\n    if (typeof str === 'undefined' || str === '') return '';\n    var obfuscator = new Obfuscator({\n      agentIdentifier\n    });\n    str = String(str);\n    if (obfuscator.shouldObfuscate()) str = obfuscator.obfuscateString(str);\n    if (hasOwnProp.call(stringTable, str)) {\n      return numeric(stringTable[str], true);\n    } else {\n      stringTable[str] = stringTableIdx++;\n      return quoteString(str);\n    }\n  }\n}\nexport function addCustomAttributes(attrs, addString) {\n  var attrParts = [];\n  mapOwn(attrs, function (key, val) {\n    if (attrParts.length >= MAX_ATTRIBUTES) return;\n    var type = 5;\n    var serializedValue;\n    // add key to string table first\n    key = addString(key);\n    switch (typeof val) {\n      case 'object':\n        if (val) {\n          // serialize objects to strings\n          serializedValue = addString(stringify(val));\n        } else {\n          // null attribute type\n          type = 9;\n        }\n        break;\n      case 'number':\n        type = 6;\n        // make sure numbers contain a `.` so they are parsed as doubles\n        serializedValue = val % 1 ? val : val + '.';\n        break;\n      case 'boolean':\n        type = val ? 7 : 8;\n        break;\n      case 'undefined':\n        // we treat undefined as a null attribute (since dirac does not have a concept of undefined)\n        type = 9;\n        break;\n      default:\n        serializedValue = addString(val);\n    }\n    attrParts.push([type, key + (serializedValue ? ',' + serializedValue : '')]);\n  });\n  return attrParts;\n}\nvar escapable = /([,\\\\;])/g;\nfunction quoteString(str) {\n  return \"'\" + str.replace(escapable, '\\\\$1');\n}","/*\n * Copyright 2020 New Relic Corporation. All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { windowAddEventListener } from '../event-listener/event-listener-opts';\nimport { globalScope, isWorkerScope, isBrowserScope } from '../constants/runtime';\nimport { subscribeToVisibilityChange } from '../window/page-visibility';\nif (isWorkerScope) {\n  globalScope.cleanupTasks = []; // create new list on WorkerGlobalScope to track funcs to run before exiting thread\n\n  const origClose = globalScope.close;\n  globalScope.close = () => {\n    // on worker's EoL signal, execute all \"listeners\", e.g. final harvests\n    for (let task of globalScope.cleanupTasks) {\n      task();\n    }\n    origClose();\n  };\n}\n\n/**\n * Subscribes a provided callback to the time/event when the agent should treat it as end-of-life.\n * This is used, for example, to submit a final harvest and send all remaining data on best-effort.\n * @param {function} cb - func to run before or during the last reliable event or time of an env's life span\n */\nexport function subscribeToEOL(cb) {\n  if (isBrowserScope) {\n    subscribeToVisibilityChange(cb, true); // when user switches tab or hides window, esp. mobile scenario\n    windowAddEventListener('pagehide', cb); // when user navigates away, and because safari iOS v14.4- doesn't fully support vis change\n    // --this ought to be removed once support for version below 14.5 phases out\n  } else if (isWorkerScope) {\n    globalScope.cleanupTasks.push(cb); // close() should run these tasks before quitting thread\n  }\n  // By default (for other env), this fn has no effect.\n}","import { globalScope, isBrowserScope, isiOS, offset } from '../constants/runtime';\nimport { VITAL_NAMES } from './constants';\nimport { VitalMetric } from './vital-metric';\nimport { onTTFB } from 'web-vitals/attribution';\nexport const timeToFirstByte = new VitalMetric(VITAL_NAMES.TIME_TO_FIRST_BYTE);\nif (isBrowserScope && typeof PerformanceNavigationTiming !== 'undefined' && !isiOS) {\n  onTTFB(_ref => {\n    let {\n      value,\n      attribution\n    } = _ref;\n    if (timeToFirstByte.isValid) return;\n    timeToFirstByte.update({\n      value,\n      attrs: {\n        navigationEntry: attribution.navigationEntry\n      }\n    });\n  });\n} else {\n  if (!timeToFirstByte.isValid) {\n    const entry = {};\n    // convert real timestamps to relative timestamps to match web-vitals behavior\n    for (let key in globalScope?.performance?.timing || {}) entry[key] = Math.max(globalScope?.performance?.timing[key] - offset, 0);\n\n    // ttfb is equiv to document's responseStart property in timing API --> https://developer.mozilla.org/en-US/docs/Web/API/PerformanceTiming/responseStart\n    timeToFirstByte.update({\n      value: entry.responseStart,\n      attrs: {\n        navigationEntry: entry\n      }\n    });\n  }\n}","import { onCLS } from 'web-vitals/attribution';\nimport { VITAL_NAMES } from './constants';\nimport { VitalMetric } from './vital-metric';\nimport { isBrowserScope } from '../constants/runtime';\nexport const cumulativeLayoutShift = new VitalMetric(VITAL_NAMES.CUMULATIVE_LAYOUT_SHIFT, x => x);\nif (isBrowserScope) {\n  onCLS(_ref => {\n    let {\n      value,\n      attribution,\n      id\n    } = _ref;\n    const attrs = {\n      metricId: id,\n      largestShiftTarget: attribution.largestShiftTarget,\n      largestShiftTime: attribution.largestShiftTime,\n      largestShiftValue: attribution.largestShiftValue,\n      loadState: attribution.loadState\n    };\n    cumulativeLayoutShift.update({\n      value,\n      attrs\n    });\n  }, {\n    reportAllChanges: true\n  });\n}","import { onFID } from 'web-vitals/attribution';\nimport { VitalMetric } from './vital-metric';\nimport { VITAL_NAMES } from './constants';\nimport { initiallyHidden, isBrowserScope } from '../constants/runtime';\nexport const firstInputDelay = new VitalMetric(VITAL_NAMES.FIRST_INPUT_DELAY);\nif (isBrowserScope) {\n  onFID(_ref => {\n    let {\n      value,\n      attribution\n    } = _ref;\n    if (initiallyHidden || firstInputDelay.isValid) return;\n    const attrs = {\n      type: attribution.eventType,\n      fid: Math.round(value),\n      eventTarget: attribution.eventTarget,\n      loadState: attribution.loadState\n    };\n\n    // CWV will only report one (THE) first-input entry to us; fid isn't reported if there are no user interactions occurs before the *first* page hiding.\n    firstInputDelay.update({\n      value: attribution.eventTime,\n      attrs\n    });\n  });\n}","import { onINP } from 'web-vitals/attribution';\nimport { VitalMetric } from './vital-metric';\nimport { VITAL_NAMES } from './constants';\nimport { isBrowserScope } from '../constants/runtime';\nexport const interactionToNextPaint = new VitalMetric(VITAL_NAMES.INTERACTION_TO_NEXT_PAINT);\nif (isBrowserScope) {\n  /* Interaction-to-Next-Paint */\n  onINP(_ref => {\n    let {\n      value,\n      attribution,\n      id\n    } = _ref;\n    const attrs = {\n      metricId: id,\n      eventTarget: attribution.eventTarget,\n      eventType: attribution.eventType,\n      eventTime: attribution.eventTime,\n      loadState: attribution.loadState\n    };\n    interactionToNextPaint.update({\n      value,\n      attrs\n    });\n  });\n}","import { onLCP } from 'web-vitals/attribution';\nimport { VitalMetric } from './vital-metric';\nimport { VITAL_NAMES } from './constants';\nimport { initiallyHidden, isBrowserScope } from '../constants/runtime';\nimport { cleanURL } from '../url/clean-url';\nexport const largestContentfulPaint = new VitalMetric(VITAL_NAMES.LARGEST_CONTENTFUL_PAINT);\nif (isBrowserScope) {\n  onLCP(_ref => {\n    let {\n      value,\n      attribution\n    } = _ref;\n    /* Largest Contentful Paint - As of WV v3, it still imperfectly tries to detect document vis state asap and isn't supposed to report if page starts hidden. */\n    if (initiallyHidden || largestContentfulPaint.isValid) return;\n    let attrs;\n    const lcpEntry = attribution.lcpEntry;\n    if (lcpEntry) {\n      attrs = {\n        size: lcpEntry.size,\n        eid: lcpEntry.id,\n        element: attribution.element,\n        timeToFirstByte: attribution.timeToFirstByte,\n        resourceLoadDelay: attribution.resourceLoadDelay,\n        resourceLoadTime: attribution.resourceLoadTime,\n        elementRenderDelay: attribution.elementRenderDelay\n      };\n      if (attribution.url) attrs.elUrl = cleanURL(attribution.url);\n      if (lcpEntry.element?.tagName) attrs.elTag = lcpEntry.element.tagName;\n    }\n    largestContentfulPaint.update({\n      value,\n      attrs\n    });\n  });\n}","import { isBrowserScope } from '../constants/runtime';\nimport { subscribeToEOL } from '../unload/eol';\nimport { VITAL_NAMES } from './constants';\nimport { VitalMetric } from './vital-metric';\nexport const longTask = new VitalMetric(VITAL_NAMES.LONG_TASK);\nif (isBrowserScope) {\n  const handleEntries = entries => {\n    entries.forEach(entry => {\n      longTask.update({\n        value: entry.duration,\n        attrs: {\n          ltFrame: entry.name,\n          // MDN: the browsing context or frame that can be attributed to the long task\n          ltStart: entry.startTime,\n          // MDN: a double representing the time (millisec) when the task started\n          ltCtr: entry.attribution[0].containerType,\n          // MDN: type of frame container: 'iframe', 'embed', or 'object' ... but this can also be 'window',\n          ...(entry.attribution[0].containerType !== 'window' && {\n            ltCtrSrc: entry.attribution[0].containerSrc,\n            // MDN: container's 'src' attribute\n            ltCtrId: entry.attribution[0].containerId,\n            // MDN: container's 'id' attribute\n            ltCtrName: entry.attribution[0].containerName // MDN: container's 'name' attribute\n          })\n        }\n      });\n    });\n  };\n  let observer;\n  try {\n    if (PerformanceObserver.supportedEntryTypes.includes('longtask')) {\n      observer = new PerformanceObserver(list => {\n        // Delay by a microtask to workaround a bug in Safari where the\n        // callback is invoked immediately, rather than in a separate task.\n        // See: https://github.com/GoogleChrome/web-vitals/issues/277\n        Promise.resolve().then(() => {\n          handleEntries(list.getEntries());\n        });\n      });\n      observer.observe({\n        type: 'longtask',\n        buffered: true\n      });\n    }\n  } catch (e) {\n    // Do nothing.\n  }\n  if (observer) {\n    subscribeToEOL(() => {\n      handleEntries(observer.takeRecords());\n    }, true); // this bool is a temp arg under staged BFCache work that runs the func under the new page session logic -- tb removed w/ the feature flag later\n\n    /* No work needed on BFCache restore for long task. */\n  }\n}","/*\n * Copyright 2020 New Relic Corporation. All rights reserved.\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { nullable, numeric, getAddStringContext, addCustomAttributes } from '../../../common/serialize/bel-serializer';\nimport { mapOwn } from '../../../common/util/map-own';\nimport { HarvestScheduler } from '../../../common/harvest/harvest-scheduler';\nimport { registerHandler } from '../../../common/event-emitter/register-handler';\nimport { handle } from '../../../common/event-emitter/handle';\nimport { getInfo, getConfigurationValue } from '../../../common/config/config';\nimport { FEATURE_NAME } from '../constants';\nimport { FEATURE_NAMES } from '../../../loaders/features/features';\nimport { AggregateBase } from '../../utils/aggregate-base';\nimport { cumulativeLayoutShift } from '../../../common/vitals/cumulative-layout-shift';\nimport { firstContentfulPaint } from '../../../common/vitals/first-contentful-paint';\nimport { firstInputDelay } from '../../../common/vitals/first-input-delay';\nimport { firstPaint } from '../../../common/vitals/first-paint';\nimport { interactionToNextPaint } from '../../../common/vitals/interaction-to-next-paint';\nimport { largestContentfulPaint } from '../../../common/vitals/largest-contentful-paint';\nimport { timeToFirstByte } from '../../../common/vitals/time-to-first-byte';\nimport { longTask } from '../../../common/vitals/long-task';\nimport { subscribeToVisibilityChange } from '../../../common/window/page-visibility';\nimport { VITAL_NAMES } from '../../../common/vitals/constants';\nexport class Aggregate extends AggregateBase {\n  static featureName = FEATURE_NAME;\n  #handleVitalMetric = _ref => {\n    let {\n      name,\n      value,\n      attrs\n    } = _ref;\n    this.addTiming(name, value, attrs);\n  };\n  constructor(agentIdentifier, aggregator) {\n    var _this;\n    super(agentIdentifier, aggregator, FEATURE_NAME);\n    _this = this;\n    this.timings = [];\n    this.timingsSent = [];\n    this.curSessEndRecorded = false;\n    if (getConfigurationValue(this.agentIdentifier, 'page_view_timing.long_task') === true) longTask.subscribe(this.#handleVitalMetric);\n    registerHandler('docHidden', msTimestamp => this.endCurrentSession(msTimestamp), this.featureName, this.ee);\n    registerHandler('winPagehide', msTimestamp => this.recordPageUnload(msTimestamp), this.featureName, this.ee);\n    const initialHarvestSeconds = getConfigurationValue(this.agentIdentifier, 'page_view_timing.initialHarvestSeconds') || 10;\n    const harvestTimeSeconds = getConfigurationValue(this.agentIdentifier, 'page_view_timing.harvestTimeSeconds') || 30;\n    this.waitForFlags([]).then(() => {\n      /* It's important that CWV api, like \"onLCP\", is called before the **scheduler** is initialized. The reason is because they listen to the same\n        on vis change or pagehide events, and we'd want ex. onLCP to record the timing (win the race) before we try to send \"final harvest\". */\n      firstPaint.subscribe(this.#handleVitalMetric);\n      firstContentfulPaint.subscribe(this.#handleVitalMetric);\n      firstInputDelay.subscribe(this.#handleVitalMetric);\n      largestContentfulPaint.subscribe(this.#handleVitalMetric);\n      interactionToNextPaint.subscribe(this.#handleVitalMetric);\n      timeToFirstByte.subscribe(_ref2 => {\n        let {\n          attrs\n        } = _ref2;\n        this.addTiming('load', Math.round(attrs.navigationEntry.loadEventEnd));\n      });\n      subscribeToVisibilityChange(() => {\n        /* Downstream, the event consumer interprets all timing node value as ms-unit and converts it to seconds via division by 1000. CLS is unitless so this normally is a problem.\n          bel.6 schema also doesn't support decimal values, of which cls within [0,1). However, the two nicely cancels out, and we can multiply cls by 1000 to both negate the division\n          and send an integer > 1. We effectively lose some precision down to 3 decimal places for this workaround. E.g. (real) 0.749132... -> 749.132...-> 749 -> 0.749 (final) */\n        const {\n          name,\n          value,\n          attrs\n        } = cumulativeLayoutShift.current;\n        if (value === undefined) return;\n        this.addTiming(name, value * 1000, attrs);\n      }, true); // CLS node should only reports on vis change rather than on every change\n\n      const scheduler = new HarvestScheduler('events', {\n        onFinished: function () {\n          return _this.onHarvestFinished(...arguments);\n        },\n        getPayload: function () {\n          return _this.prepareHarvest(...arguments);\n        }\n      }, this);\n      scheduler.startTimer(harvestTimeSeconds, initialHarvestSeconds);\n      this.drain();\n    });\n  }\n\n  /**\n   * Add the time of _document visibilitychange to hidden_ to the next PVT harvest == NRDB pageHide attr.\n   * @param {number} timestamp\n   */\n  endCurrentSession(timestamp) {\n    if (!this.curSessEndRecorded) {\n      // TO DO: stage 2 - we don't want to capture this timing twice on page navigating away, but it should run again if we return to page and away *again*\n      this.addTiming('pageHide', timestamp, null);\n      this.curSessEndRecorded = true;\n    }\n  }\n\n  /**\n   * Add the time of _window pagehide event_ firing to the next PVT harvest == NRDB windowUnload attr.\n   */\n  recordPageUnload(timestamp) {\n    this.addTiming('unload', timestamp, null);\n    /*\n    Issue: Because window's pageHide commonly fires BEFORE vis change and \"final\" harvest would happen at the former in this case, we also have to add our vis-change event now or it may not be sent.\n    Affected: Safari < v14.1/.5 ; versions that don't support 'visiilitychange' event\n    Impact: For affected w/o this, NR 'pageHide' attribute may not be sent. For other browsers w/o this, NR 'pageHide' gets fragmented into its own harvest call on page unloading because of dual EoL logic.\n    Mitigation: NR 'unload' and 'pageHide' are both recorded when window pageHide fires, rather than only recording 'unload'.\n    Future: When EoL can become the singular subscribeToVisibilityChange, it's likely endCurrentSession isn't needed here as 'unload'-'pageHide' can be untangled.\n    */\n    this.endCurrentSession(timestamp);\n  }\n  addTiming(name, value, attrs) {\n    attrs = attrs || {};\n    addConnectionAttributes(attrs); // network conditions may differ from the actual for VitalMetrics when they were captured\n\n    // If cls was set to another value by `onCLS`, then it's supported and is attached onto any timing but is omitted until such time.\n    /*\n    *cli Apr'23 - Convert attach-to-all -> attach-if-not-null. See NEWRELIC-6143.\n    Issue: Because NR 'pageHide' was only sent once with what is considered the \"final\" CLS value, in the case that 'pageHide' fires before 'load' happens, we incorrectly a final CLS of 0 for that page.\n    Mitigation: We've set initial CLS to null so that it's omitted from timings like 'pageHide' in that edge case. It should only be included if onCLS callback was executed at least once.\n    Future: onCLS value changes should be reported directly & CLS separated into its own timing node so it's not beholden to 'pageHide' firing. It'd also be possible to report the real final CLS.\n    *cli Mar'24 update: CLS now emitted as its own timing node in addition to as-property under other nodes. The 'cls' property is unnecessary for cls nodes.\n    */\n    if (name !== VITAL_NAMES.CUMULATIVE_LAYOUT_SHIFT && cumulativeLayoutShift.current.value >= 0) {\n      attrs.cls = cumulativeLayoutShift.current.value;\n    }\n    this.timings.push({\n      name,\n      value,\n      attrs\n    });\n    handle('pvtAdded', [name, value, attrs], undefined, FEATURE_NAMES.sessionTrace, this.ee);\n  }\n  onHarvestFinished(result) {\n    if (result.retry && this.timingsSent.length > 0) {\n      this.timings.unshift(...this.timingsSent);\n      this.timingsSent = [];\n    }\n  }\n  appendGlobalCustomAttributes(timing) {\n    var timingAttributes = timing.attrs || {};\n    var customAttributes = getInfo(this.agentIdentifier).jsAttributes || {};\n    var reservedAttributes = ['size', 'eid', 'cls', 'type', 'fid', 'elTag', 'elUrl', 'net-type', 'net-etype', 'net-rtt', 'net-dlink'];\n    mapOwn(customAttributes, function (key, val) {\n      if (reservedAttributes.indexOf(key) < 0) {\n        timingAttributes[key] = val;\n      }\n    });\n  }\n\n  // serialize and return current timing data, clear and save current data for retry\n  prepareHarvest(options) {\n    if (this.timings.length === 0) return;\n    var payload = this.getPayload(this.timings);\n    if (options.retry) {\n      for (var i = 0; i < this.timings.length; i++) {\n        this.timingsSent.push(this.timings[i]);\n      }\n    }\n    this.timings = [];\n    return {\n      body: {\n        e: payload\n      }\n    };\n  }\n\n  // serialize array of timing data\n  getPayload(data) {\n    var addString = getAddStringContext(this.agentIdentifier);\n    var payload = 'bel.6;';\n    for (var i = 0; i < data.length; i++) {\n      var timing = data[i];\n      payload += 'e,';\n      payload += addString(timing.name) + ',';\n      payload += nullable(timing.value, numeric, false) + ',';\n      this.appendGlobalCustomAttributes(timing);\n      var attrParts = addCustomAttributes(timing.attrs, addString);\n      if (attrParts && attrParts.length > 0) {\n        payload += numeric(attrParts.length) + ';' + attrParts.join(';');\n      }\n      if (i + 1 < data.length) payload += ';';\n    }\n    return payload;\n  }\n}\nfunction addConnectionAttributes(obj) {\n  var connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection; // to date, both window & worker shares the same support for connection\n  if (!connection) return;\n  if (connection.type) obj['net-type'] = connection.type;\n  if (connection.effectiveType) obj['net-etype'] = connection.effectiveType;\n  if (connection.rtt) obj['net-rtt'] = connection.rtt;\n  if (connection.downlink) obj['net-dlink'] = connection.downlink;\n}"],"names":["HarvestScheduler","_SharedContext","endpoint","opts","parent","_this$sharedContext","_this","_classCallCheck","started","timeoutHandle","aborted","harvest","Harvest","sharedContext","subscribeToEOL","unload","bind","_assertThisInitialized","ee","on","SESSION_EVENTS","runHarvest","forceNoRetry","_inherits","_createClass","key","value","this","onUnload","interval","initialDelay","scheduleHarvest","permanently","arguments","length","undefined","clearTimeout","delay","_this2","setTimeout","_this3","submitMethod","payload","cbRanAfterSend","result","retry","onHarvestFinished","harvests","getPayload","submitData","isFinalHarvest","Object","prototype","toString","call","push","apply","_toConsumableArray","send","args","sendX","raw","_send","forEach","cbFinished","customUrl","onFinished","sent","retryDelay","SharedContext","hasOwnProp","hasOwnProperty","MAX_ATTRIBUTES","nullable","val","fn","comma","numeric","n","noDefault","Math","floor","getAddStringContext","agentIdentifier","stringTable","create","stringTableIdx","str","obfuscator","Obfuscator","String","shouldObfuscate","obfuscateString","replace","escapable","quoteString","addCustomAttributes","attrs","addString","attrParts","mapOwn","serializedValue","type","stringify","isWorkerScope","globalScope","origClose","_step","_iterator","_createForOfIteratorHelper","s","done","task","err","e","f","cb","isBrowserScope","subscribeToVisibilityChange","windowAddEventListener","timeToFirstByte","VitalMetric","VITAL_NAMES","PerformanceNavigationTiming","isiOS","onTTFB","_ref","attribution","isValid","update","navigationEntry","entry","_globalScope$performa","timing","_globalScope$performa2","max","offset","responseStart","cumulativeLayoutShift","x","onCLS","metricId","id","largestShiftTarget","largestShiftTime","largestShiftValue","loadState","reportAllChanges","firstInputDelay","onFID","initiallyHidden","eventType","fid","round","eventTarget","eventTime","interactionToNextPaint","onINP","largestContentfulPaint","onLCP","_lcpEntry$element","lcpEntry","size","eid","element","resourceLoadDelay","resourceLoadTime","elementRenderDelay","url","elUrl","cleanURL","tagName","elTag","longTask","observer","handleEntries","entries","duration","_objectSpread","ltFrame","name","ltStart","startTime","ltCtr","containerType","ltCtrSrc","containerSrc","ltCtrId","containerId","ltCtrName","containerName","PerformanceObserver","supportedEntryTypes","includes","list","Promise","resolve","then","getEntries","observe","buffered","takeRecords","_handleVitalMetric","WeakMap","Aggregate","_AggregateBase","aggregator","FEATURE_NAME","_classPrivateFieldInitSpec","writable","addTiming","timings","timingsSent","curSessEndRecorded","getConfigurationValue","subscribe","_classPrivateFieldGet","registerHandler","msTimestamp","endCurrentSession","featureName","recordPageUnload","initialHarvestSeconds","harvestTimeSeconds","waitForFlags","firstPaint","firstContentfulPaint","_ref2","loadEventEnd","_cumulativeLayoutShif","current","scheduler","_this4","prepareHarvest","startTimer","drain","timestamp","obj","connection","navigator","mozConnection","webkitConnection","effectiveType","rtt","downlink","addConnectionAttributes","cls","handle","FEATURE_NAMES","_this$timings","unshift","timingAttributes","customAttributes","getInfo","jsAttributes","reservedAttributes","indexOf","options","i","body","data","appendGlobalCustomAttributes","join","AggregateBase","_defineProperty"],"sourceRoot":""}