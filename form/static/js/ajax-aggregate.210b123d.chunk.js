"use strict";(self.webpackChunkappsmith=self.webpackChunkappsmith||[]).push([[1898],{65441:function(t,e,n){n.d(e,{R:function(){return o},z:function(){return a}});var r=n(29439),i=[];function a(t){if(0===i.length)return!0;if(void 0===t.hostname)return!1;for(var e=0;e<i.length;e++){var n=i[e];if("*"===n.hostname)return!1;if(s(n.hostname,t.hostname)&&u(n.pathname,t.pathname))return!1}return!0}function o(t){if(i=[],t&&t.length)for(var e=0;e<t.length;e++){var n=t[e];if(n){0===n.indexOf("http://")?n=n.substring(7):0===n.indexOf("https://")&&(n=n.substring(8));var a=n.indexOf("/"),o=void 0,s=void 0;a>0?(o=n.substring(0,a),s=n.substring(a)):(o=n,s="");var u=o.split(":"),d=(0,r.Z)(u,1)[0];i.push({hostname:d,pathname:s})}}}function s(t,e){return!(t.length>e.length)&&e.indexOf(t)===e.length-t.length}function u(t,e){return 0===t.indexOf("/")&&(t=t.substring(1)),0===e.indexOf("/")&&(e=e.substring(1)),""===t||t===e}},56777:function(t,e,n){n.d(e,{o:function(){return m}});var r=n(93433),i=n(15671),a=n(43144),o=n(82963),s=n(78814),u=n(61120),d=n(97326),h=n(60136),l=n(75284),c=n(9831),f=n(19198),p=n(99712),v=n(73198);var m=function(t){function e(t,n,r){var a,h,l,c,m;return(0,i.Z)(this,e),l=this,c=e,m=[r],c=(0,u.Z)(c),(h=(0,o.Z)(l,(0,s.Z)()?Reflect.construct(c,m||[],(0,u.Z)(l).constructor):c.apply(l,m))).endpoint=t,h.opts=n||{},h.started=!1,h.timeoutHandle=null,h.aborted=!1,h.harvest=new f.M(h.sharedContext),(0,p.L)(h.unload.bind((0,d.Z)(h))),null===(a=h.sharedContext)||void 0===a||a.ee.on(v.wO.RESET,(function(){return h.runHarvest({forceNoRetry:!0})})),h}return(0,h.Z)(e,t),(0,a.Z)(e,[{key:"unload",value:function(){this.aborted||(this.opts.onUnload&&this.opts.onUnload(),this.runHarvest({unload:!0}))}},{key:"startTimer",value:function(t,e){this.interval=t,this.started=!0,this.scheduleHarvest(null!=e?e:this.interval)}},{key:"stopTimer",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.aborted=t,this.started=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle)}},{key:"scheduleHarvest",value:function(t,e){var n=this;this.timeoutHandle||(null==t&&(t=this.interval),this.timeoutHandle=setTimeout((function(){n.timeoutHandle=null,n.runHarvest(e)}),1e3*t))}},{key:"runHarvest",value:function(t){var e=this;if(!this.aborted){var n,i,a=function(n){null!==t&&void 0!==t&&t.forceNoRetry&&(n.retry=!1),e.onHarvestFinished(t,n)},o=[];if(this.opts.getPayload){if(!(n=l.qD({isFinalHarvest:null===t||void 0===t?void 0:t.unload})))return!1;var s=!(null!==t&&void 0!==t&&t.unload)&&n===l.Be;if(!(i=this.opts.getPayload({retry:s,opts:t})))return void(this.started&&this.scheduleHarvest());i="[object Array]"===Object.prototype.toString.call(i)?i:[i],o.push.apply(o,(0,r.Z)(i))}var u=function(t){return e.harvest.sendX(t)};o.length?u=this.opts.raw?function(t){return e.harvest._send(t)}:function(t){return e.harvest.send(t)}:o.push(void 0),o.forEach((function(r){u({endpoint:e.endpoint,payload:r,opts:t,submitMethod:n,cbFinished:a,customUrl:e.opts.customUrl,raw:e.opts.raw})})),this.started&&this.scheduleHarvest()}}},{key:"onHarvestFinished",value:function(t,e){if(this.opts.onFinished&&this.opts.onFinished(e),e.sent&&e.retry){var n=e.delay||this.opts.retryDelay;this.started&&n?(clearTimeout(this.timeoutHandle),this.timeoutHandle=null,this.scheduleHarvest(n,t)):!this.started&&n&&this.scheduleHarvest(n,t)}}}]),e}(c.w)},84320:function(t,e,n){n.d(e,{AG:function(){return u},FX:function(){return h},n1:function(){return l},uR:function(){return d}});var r=n(44567),i=n(17610),a=n(34370),o=Object.prototype.hasOwnProperty,s=64;function u(t,e,n){return t||0===t||""===t?e(t)+(n?",":""):"!"}function d(t,e){return e?Math.floor(t).toString(36):void 0===t||0===t?"":Math.floor(t).toString(36)}function h(t){var e=Object.hasOwnProperty("create")?Object.create(null):{},n=0;return function(r){if("undefined"===typeof r||""===r)return"";var i=new a.RR({agentIdentifier:t});r=String(r),i.shouldObfuscate()&&(r=i.obfuscateString(r));return o.call(e,r)?d(e[r],!0):(e[r]=n++,function(t){return"'"+t.replace(c,"\\$1")}(r))}}function l(t,e){var n=[];return(0,r.D)(t,(function(t,r){if(!(n.length>=s)){var a,o=5;switch(t=e(t),typeof r){case"object":r?a=e((0,i.P)(r)):o=9;break;case"number":o=6,a=r%1?r:r+".";break;case"boolean":o=r?7:8;break;case"undefined":o=9;break;default:a=e(r)}n.push([o,t+(a?","+a:"")])}})),n}var c=/([,\\;])/g},99712:function(t,e,n){n.d(e,{L:function(){return u}});var r=n(37762),i=n(98841),a=n(63711),o=n(73087);if(a.v6){a._A.cleanupTasks=[];var s=a._A.close;a._A.close=function(){var t,e=(0,r.Z)(a._A.cleanupTasks);try{for(e.s();!(t=e.n()).done;){(0,t.value)()}}catch(n){e.e(n)}finally{e.f()}s()}}function u(t){a.il?((0,o.N)(t,!0),(0,i.bP)("pagehide",t)):a.v6&&a._A.cleanupTasks.push(t)}},85571:function(t,e,n){n.r(e),n.d(e,{Aggregate:function(){return O}});var r=n(1413),i=n(93433),a=n(43144),o=n(15671),s=n(82963),u=n(78814),d=n(61120),h=n(97326),l=n(60136),c=n(4942),f=n(68295),p=n(17610),v=n(84320),m=n(38450),y=n(19435),g=n(56777),b=n(65441),x=n(79289),A=n(30733),S=n(12088),j=n(14415),T=n(37762);function Z(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.body,n=t.query;if(e||n)try{var r=function(t){if(!t)return;Array.isArray(t)||(t=[t]);var e,n=[],r=[],i=(0,T.Z)(t);try{for(i.s();!(e=i.n()).done;){var a=k(e.value);a&&(n.push(a.operationName),r.push(a.operationType))}}catch(o){i.e(o)}finally{i.f()}if(!r.length)return;return{operationName:n.join(","),operationType:r.join(","),operationFramework:"GraphQL"}}(H(e));if(r)return r;var i=k(function(t){if(!t||"string"!==typeof t)return;var e=new URLSearchParams(t);return H(Object.fromEntries(e))}(n));if(i)return i}catch(a){}}function k(t){if("object"===typeof t&&t.query&&"string"===typeof t.query){var e=t.query.trim().match(/^(query|mutation|subscription)\s?(\w*)/),n=null===e||void 0===e?void 0:e[1];if(n)return{operationName:t.operationName||(null===e||void 0===e?void 0:e[2])||"Anonymous",operationType:n,operationFramework:"GraphQL"}}}function H(t){var e;if(t&&("string"===typeof t||"object"===typeof t)&&(e="string"===typeof t?JSON.parse(t):t,(null===(n=e)||void 0===n?void 0:n.constructor)==={}.constructor||Array.isArray(e))){var n;if(Array.isArray(e)?e.some((function(t){return R(t)})):R(e))return e}}function R(t){return!("object"!==typeof t||!t.query||"string"!==typeof t.query)}var w=n(90489);var O=function(t){function e(t,n){var a,l,c,j;(0,o.Z)(this,e),l=this,c=e,j=[t,n,x.t],c=(0,d.Z)(c),a=(0,s.Z)(l,(0,u.Z)()?Reflect.construct(c,j||[],(0,d.Z)(l).constructor):c.apply(l,j));var T=(0,y.P_)(t);(0,f.X)("xhr",_,a.featureName,a.ee),a.waitForFlags([]).then((function(){new g.o("events",{onFinished:I,getPayload:z},(0,h.Z)(a)).startTimer(N),a.drain()}));var k=(0,y.OP)(t),H=k.denyList;(0,b.R)(H);var R=[],O={},q=[],E=a.ee,N=T.ajax.harvestTimeSeconds||10,P=T.ajax.maxPayloadSize||1e6;a.storeXhr=_,a.prepareHarvest=z,a.getStoredEvents=function(){return{ajaxEvents:R,spaAjaxEvents:O}},E.on("interactionDone",(function(t,e){O[t.id]&&(e||O[t.id].forEach((function(t){R.push(t)})),delete O[t.id])})),(0,f.X)("returnAjax",(function(t){return R.push(t)}),a.featureName,a.ee);var D=(0,y.C5)(t).errorBeacon,F=T.proxy.beacon;function _(e,r,i,a,o){var s,u,d,h;r.time=i,h=e.cat?(0,p.P)([e.status,e.cat]):(0,p.P)([e.status,e.host,e.pathname]);var l=(0,b.z)(e),c=null===(s=T.feature_flags)||void 0===s?void 0:s.includes("ajax_metrics_deny_list");if(!l&&c||n.store("xhr",h,e,r),l){(0,m.p)("bstXhrAgg",["xhr",h,e,r],void 0,A.D.sessionTrace,E);var f=this,v={method:e.method,status:e.status,domain:e.host,path:e.pathname,requestSize:r.txSize,responseSize:r.rxSize,type:o,startTime:i,endTime:a,callbackDuration:r.cbTime};if(f.dt&&(v.spanId=f.dt.spanId,v.traceId=f.dt.traceId,v.spanTimestamp=k.timeKeeper.correctAbsoluteTimestamp(f.dt.timestamp)),v.gql=e.gql=Z({body:this.body,query:null===this||void 0===this||null===(u=this.parsedOrigin)||void 0===u?void 0:u.search}),v.gql&&(0,m.p)(S.xS,["Ajax/Events/GraphQL/Bytes-Added",(0,p.P)(v.gql).length],void 0,A.D.metrics,E),Boolean(null===(d=(0,w.ek)(t))||void 0===d||null===(d=d.features)||void 0===d?void 0:d[A.D.softNav]))(0,m.p)("ajax",[v],void 0,A.D.softNav,E);else if(this.spaNode){var y=this.spaNode.interaction.id;O[y]=O[y]||[],O[y].push(v)}else R.push(v)}else e.hostname===D||F&&e.hostname===F?((0,m.p)(S.xS,["Ajax/Events/Excluded/Agent"],void 0,A.D.metrics,E),c&&(0,m.p)(S.xS,["Ajax/Metrics/Excluded/Agent"],void 0,A.D.metrics,E)):((0,m.p)(S.xS,["Ajax/Events/Excluded/App"],void 0,A.D.metrics,E),c&&(0,m.p)(S.xS,["Ajax/Metrics/Excluded/App"],void 0,A.D.metrics,E))}function z(t){if(t=t||{},0===R.length)return null;for(var e=G(R,t.maxPayloadSize||P),n=[],r=0;r<e.length;r++)n.push({body:{e:e[r]}});return t.retry&&(q=R.slice()),R=[],n}function G(t,e,n){n=n||1;for(var r=[],i=function(t,e){e=e||t.length;for(var n=[],r=0,i=t.length;r<i;r+=e)n.push(new L(t.slice(r,r+e)));return n}(t,t.length/n),a=!1,o=0;o<i.length;o++){var s=i[o];if(s.tooBig(e)){if(1!==s.events.length){a=!0;break}}else r.push(s.payload)}return a?G(t,e,++n):r}function I(t){var e;t.retry&&q.length>0&&((e=R).unshift.apply(e,(0,i.Z)(q)),q=[])}function L(e){this.addString=(0,v.FX)(t),this.events=e,this.payload="bel.7;";for(var n=0;n<e.length;n++){var i=e[n],a=[(0,v.uR)(i.startTime),(0,v.uR)(i.endTime-i.startTime),(0,v.uR)(0),(0,v.uR)(0),this.addString(i.method),(0,v.uR)(i.status),this.addString(i.domain),this.addString(i.path),(0,v.uR)(i.requestSize),(0,v.uR)(i.responseSize),"fetch"===i.type?1:"",this.addString(0),(0,v.AG)(i.spanId,this.addString,!0)+(0,v.AG)(i.traceId,this.addString,!0)+(0,v.AG)(i.spanTimestamp,v.uR,!1)],o="2,",s=(0,v.n1)((0,r.Z)((0,r.Z)({},(0,y.C5)(t).jsAttributes||{}),i.gql||{}),this.addString);a.unshift((0,v.uR)(s.length)),o+=a.join(","),s&&s.length>0&&(o+=";"+s.join(";")),n+1<e.length&&(o+=";"),this.payload+=o}this.tooBig=function(t){return t=t||P,2*this.payload.length>t}}return a}return(0,l.Z)(e,t),(0,a.Z)(e)}(j.m);(0,c.Z)(O,"featureName",x.t)}}]);
//# sourceMappingURL=ajax-aggregate.210b123d.chunk.js.map