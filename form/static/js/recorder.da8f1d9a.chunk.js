/*! For license information please see recorder.da8f1d9a.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkappsmith=self.webpackChunkappsmith||[]).push([[7538],{48706:function(e,t,n){n.r(t),n.d(t,{Recorder:function(){return Ft}});var r,a=n(45987),o=n(93433),i=n(1413),s=n(15671),l=n(43144),c=n(72346),u=n(86033),d=n(13092),p=n(37762);function h(e){return e.nodeType===e.ELEMENT_NODE}function g(e){var t=null===e||void 0===e?void 0:e.host;return Boolean((null===t||void 0===t?void 0:t.shadowRoot)===e)}function f(e){return"[object ShadowRoot]"===Object.prototype.toString.call(e)}function m(e){try{var t=e.rules||e.cssRules;return t?((n=Array.from(t).map(v).join("")).includes(" background-clip: text;")&&!n.includes(" -webkit-background-clip: text;")&&(n=n.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),n):null}catch(r){return null}var n}function v(e){var t;if(function(e){return"styleSheet"in e}(e))try{t=m(e.styleSheet)||function(e){var t=e.cssText;if(t.split('"').length<3)return t;var n=["@import","url(".concat(JSON.stringify(e.href),")")];return""===e.layerName?n.push("layer"):e.layerName&&n.push("layer(".concat(e.layerName,")")),e.supportsText&&n.push("supports(".concat(e.supportsText,")")),e.media.length&&n.push(e.media.mediaText),n.join(" ")+";"}(e)}catch(n){}return function(e){if(e.includes(":")){var t=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return e.replace(t,"$1\\$2")}return e}(t||e.cssText)}!function(e){e[e.Document=0]="Document",e[e.DocumentType=1]="DocumentType",e[e.Element=2]="Element",e[e.Text=3]="Text",e[e.CDATA=4]="CDATA",e[e.Comment=5]="Comment"}(r||(r={}));var y=function(){function e(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}return e.prototype.getId=function(e){var t;if(!e)return-1;var n=null===(t=this.getMeta(e))||void 0===t?void 0:t.id;return null!==n&&void 0!==n?n:-1},e.prototype.getNode=function(e){return this.idNodeMap.get(e)||null},e.prototype.getIds=function(){return Array.from(this.idNodeMap.keys())},e.prototype.getMeta=function(e){return this.nodeMetaMap.get(e)||null},e.prototype.removeNodeFromMap=function(e){var t=this,n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach((function(e){return t.removeNodeFromMap(e)}))},e.prototype.has=function(e){return this.idNodeMap.has(e)},e.prototype.hasNode=function(e){return this.nodeMetaMap.has(e)},e.prototype.add=function(e,t){var n=t.id;this.idNodeMap.set(n,e),this.nodeMetaMap.set(e,t)},e.prototype.replace=function(e,t){var n=this.getNode(e);if(n){var r=this.nodeMetaMap.get(n);r&&this.nodeMetaMap.set(t,r)}this.idNodeMap.set(e,t)},e.prototype.reset=function(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap},e}();function I(e){var t=e.element,n=e.maskInputOptions,r=e.tagName,a=e.type,o=e.value,i=e.maskInputFn,s=o||"",l=a&&C(a);return(n[r.toLowerCase()]||l&&n[l])&&(s=i?i(s,t):"*".repeat(s.length)),s}function C(e){return e.toLowerCase()}var S="__rrweb_original__";function b(e){var t=e.type;return e.hasAttribute("data-rr-is-password")?"password":t?C(t):null}var A,k,w=1,M=new RegExp("[^a-z0-9-_:]"),T=-2;function R(){return w++}var Z=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,N=/^(?:[a-z+]+:)?\/\//i,E=/^www\..*/i,O=/^(data:)([^,]*),(.*)/i;function x(e,t){return(e||"").replace(Z,(function(e,n,r,a,o,i){var s,l=r||o||i,c=n||a||"";if(!l)return e;if(N.test(l)||E.test(l))return"url(".concat(c).concat(l).concat(c,")");if(O.test(l))return"url(".concat(c).concat(l).concat(c,")");if("/"===l[0])return"url(".concat(c).concat((s=t,(s.indexOf("//")>-1?s.split("/").slice(0,3).join("/"):s.split("/")[0]).split("?")[0]+l)).concat(c,")");var u=t.split("/"),d=l.split("/");u.pop();for(var p=0,h=d;p<h.length;p++){var g=h[p];"."!==g&&(".."===g?u.pop():u.push(g))}return"url(".concat(c).concat(u.join("/")).concat(c,")")}))}var F=/^[^ \t\n\r\u000c]+/,D=/^[, \t\n\r\u000c]+/;function L(e,t){if(!t||""===t.trim())return t;var n=e.createElement("a");return n.href=t,n.href}function B(e){return Boolean("svg"===e.tagName||e.ownerSVGElement)}function W(){var e=document.createElement("a");return e.href="",e.href}function V(e,t,n,r){return r?"src"===n||"href"===n&&("use"!==t||"#"!==r[0])||"xlink:href"===n&&"#"!==r[0]?L(e,r):"background"!==n||"table"!==t&&"td"!==t&&"th"!==t?"srcset"===n?function(e,t){if(""===t.trim())return t;var n=0;function r(e){var r,a=e.exec(t.substring(n));return a?(r=a[0],n+=r.length,r):""}for(var a=[];r(D),!(n>=t.length);){var o=r(F);if(","===o.slice(-1))o=L(e,o.substring(0,o.length-1)),a.push(o);else{var i="";o=L(e,o);for(var s=!1;;){var l=t.charAt(n);if(""===l){a.push((o+i).trim());break}if(s)")"===l&&(s=!1);else{if(","===l){n+=1,a.push((o+i).trim());break}"("===l&&(s=!0)}i+=l,n+=1}}}return a.join(", ")}(e,r):"style"===n?x(r,W()):"object"===t&&"data"===n?L(e,r):r:L(e,r):r}function G(e,t,n){return("video"===e||"audio"===e)&&"autoplay"===t}function K(e,t,n){if(!e)return!1;if(e.nodeType!==e.ELEMENT_NODE)return!!n&&K(e.parentNode,t,n);for(var r=e.classList.length;r--;){var a=e.classList[r];if(t.test(a))return!0}return!!n&&K(e.parentNode,t,n)}function U(e,t,n){try{var r=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(null===r)return!1;if("string"===typeof t){if(r.classList.contains(t))return!0;if(r.closest(".".concat(t)))return!0}else if(K(r,t,!0))return!0;if(n){if(r.matches(n))return!0;if(r.closest(n))return!0}}catch(a){}return!1}function _(e,t){var n=t.doc,a=t.mirror,o=t.blockClass,i=t.blockSelector,s=t.maskTextClass,l=t.maskTextSelector,c=t.inlineStylesheet,u=t.maskInputOptions,d=void 0===u?{}:u,p=t.maskTextFn,h=t.maskInputFn,g=t.dataURLOptions,f=void 0===g?{}:g,v=t.inlineImages,y=t.recordCanvas,w=t.keepIframeSrcFn,T=t.newlyAddedElement,R=void 0!==T&&T,Z=function(e,t){if(!t.hasNode(e))return;var n=t.getId(e);return 1===n?void 0:n}(n,a);switch(e.nodeType){case e.DOCUMENT_NODE:return"CSS1Compat"!==e.compatMode?{type:r.Document,childNodes:[],compatMode:e.compatMode}:{type:r.Document,childNodes:[]};case e.DOCUMENT_TYPE_NODE:return{type:r.DocumentType,name:e.name,publicId:e.publicId,systemId:e.systemId,rootId:Z};case e.ELEMENT_NODE:return function(e,t){for(var n=t.doc,a=t.blockClass,o=t.blockSelector,i=t.inlineStylesheet,s=t.maskInputOptions,l=void 0===s?{}:s,c=t.maskInputFn,u=t.dataURLOptions,d=void 0===u?{}:u,p=t.inlineImages,h=t.recordCanvas,g=t.keepIframeSrcFn,f=t.newlyAddedElement,v=void 0!==f&&f,y=t.rootId,w=function(e,t,n){try{if("string"===typeof t){if(e.classList.contains(t))return!0}else for(var r=e.classList.length;r--;){var a=e.classList[r];if(t.test(a))return!0}if(n)return e.matches(n)}catch(o){}return!1}(e,a,o),T=function(e){if(e instanceof HTMLFormElement)return"form";var t=C(e.tagName);return M.test(t)?"div":t}(e),R={},Z=e.attributes.length,N=0;N<Z;N++){var E=e.attributes[N];G(T,E.name,E.value)||(R[E.name]=V(n,T,C(E.name),E.value))}if("link"===T&&i){var O=Array.from(n.styleSheets).find((function(t){return t.href===e.href})),F=null;O&&(F=m(O)),F&&(delete R.rel,delete R.href,R._cssText=x(F,O.href))}if("style"===T&&e.sheet&&!(e.innerText||e.textContent||"").trim().length){(F=m(e.sheet))&&(R._cssText=x(F,W()))}if("input"===T||"textarea"===T||"select"===T){var D=e.value,L=e.checked;if("radio"!==R.type&&"checkbox"!==R.type&&"submit"!==R.type&&"button"!==R.type&&D){var K=b(e);R.value=I({element:e,type:K,tagName:T,value:D,maskInputOptions:l,maskInputFn:c})}else L&&(R.checked=L)}"option"===T&&(e.selected&&!l.select?R.selected=!0:delete R.selected);if("canvas"===T&&h)if("2d"===e.__context)(function(e){var t=e.getContext("2d");if(!t)return!0;for(var n=0;n<e.width;n+=50)for(var r=0;r<e.height;r+=50){var a=t.getImageData,o=S in a?a[S]:a;if(new Uint32Array(o.call(t,n,r,Math.min(50,e.width-n),Math.min(50,e.height-r)).data.buffer).some((function(e){return 0!==e})))return!1}return!0})(e)||(R.rr_dataURL=e.toDataURL(d.type,d.quality));else if(!("__context"in e)){var U=e.toDataURL(d.type,d.quality),_=document.createElement("canvas");_.width=e.width,_.height=e.height,U!==_.toDataURL(d.type,d.quality)&&(R.rr_dataURL=U)}if("img"===T&&p){A||(A=n.createElement("canvas"),k=A.getContext("2d"));var Y=e,z=Y.crossOrigin;Y.crossOrigin="anonymous";var J=function e(){Y.removeEventListener("load",e);try{A.width=Y.naturalWidth,A.height=Y.naturalHeight,k.drawImage(Y,0,0),R.rr_dataURL=A.toDataURL(d.type,d.quality)}catch(t){console.warn("Cannot inline img src=".concat(Y.currentSrc,"! Error: ").concat(t))}z?R.crossOrigin=z:Y.removeAttribute("crossorigin")};Y.complete&&0!==Y.naturalWidth?J():Y.addEventListener("load",J)}"audio"!==T&&"video"!==T||(R.rr_mediaState=e.paused?"paused":"played",R.rr_mediaCurrentTime=e.currentTime);v||(e.scrollLeft&&(R.rr_scrollLeft=e.scrollLeft),e.scrollTop&&(R.rr_scrollTop=e.scrollTop));if(w){var P=e.getBoundingClientRect(),Q=P.width,H=P.height;R={class:R.class,rr_width:"".concat(Q,"px"),rr_height:"".concat(H,"px")}}"iframe"!==T||g(R.src)||(e.contentDocument||(R.rr_src=R.src),delete R.src);return{type:r.Element,tagName:T,attributes:R,childNodes:[],isSVG:B(e)||void 0,needBlock:w,rootId:y}}(e,{doc:n,blockClass:o,blockSelector:i,inlineStylesheet:c,maskInputOptions:d,maskInputFn:h,dataURLOptions:f,inlineImages:v,recordCanvas:y,keepIframeSrcFn:w,newlyAddedElement:R,rootId:Z});case e.TEXT_NODE:return function(e,t){var n,a=t.maskTextClass,o=t.maskTextSelector,i=t.maskTextFn,s=t.rootId,l=e.parentNode&&e.parentNode.tagName,c=e.textContent,u="STYLE"===l||void 0,d="SCRIPT"===l||void 0;if(u&&c){try{e.nextSibling||e.previousSibling||(null===(n=e.parentNode.sheet)||void 0===n?void 0:n.cssRules)&&(c=m(e.parentNode.sheet))}catch(p){console.warn("Cannot get CSS styles from text's parentNode. Error: ".concat(p),e)}c=x(c,W())}d&&(c="SCRIPT_PLACEHOLDER");!u&&!d&&c&&U(e,a,o)&&(c=i?i(c):c.replace(/[\S]/g,"*"));return{type:r.Text,textContent:c||"",isStyle:u,rootId:s}}(e,{maskTextClass:s,maskTextSelector:l,maskTextFn:p,rootId:Z});case e.CDATA_SECTION_NODE:return{type:r.CDATA,textContent:"",rootId:Z};case e.COMMENT_NODE:return{type:r.Comment,textContent:e.textContent||"",rootId:Z};default:return!1}}function Y(e){return void 0===e||null===e?"":e.toLowerCase()}function z(e,t){var n,a=t.doc,o=t.mirror,i=t.blockClass,s=t.blockSelector,l=t.maskTextClass,c=t.maskTextSelector,u=t.skipChild,d=void 0!==u&&u,p=t.inlineStylesheet,m=void 0===p||p,v=t.maskInputOptions,y=void 0===v?{}:v,I=t.maskTextFn,C=t.maskInputFn,S=t.slimDOMOptions,b=t.dataURLOptions,A=void 0===b?{}:b,k=t.inlineImages,w=void 0!==k&&k,M=t.recordCanvas,Z=void 0!==M&&M,N=t.onSerialize,E=t.onIframeLoad,O=t.iframeLoadTimeout,x=void 0===O?5e3:O,F=t.onStylesheetLoad,D=t.stylesheetLoadTimeout,L=void 0===D?5e3:D,B=t.keepIframeSrcFn,W=void 0===B?function(){return!1}:B,V=t.newlyAddedElement,G=void 0!==V&&V,K=t.preserveWhiteSpace,U=void 0===K||K,J=_(e,{doc:a,mirror:o,blockClass:i,blockSelector:s,maskTextClass:l,maskTextSelector:c,inlineStylesheet:m,maskInputOptions:y,maskTextFn:I,maskInputFn:C,dataURLOptions:A,inlineImages:w,recordCanvas:Z,keepIframeSrcFn:W,newlyAddedElement:G});if(!J)return console.warn(e,"not serialized"),null;n=o.hasNode(e)?o.getId(e):!function(e,t){if(t.comment&&e.type===r.Comment)return!0;if(e.type===r.Element){if(t.script&&("script"===e.tagName||"link"===e.tagName&&("preload"===e.attributes.rel||"modulepreload"===e.attributes.rel)&&"script"===e.attributes.as||"link"===e.tagName&&"prefetch"===e.attributes.rel&&"string"===typeof e.attributes.href&&e.attributes.href.endsWith(".js")))return!0;if(t.headFavicon&&("link"===e.tagName&&"shortcut icon"===e.attributes.rel||"meta"===e.tagName&&(Y(e.attributes.name).match(/^msapplication-tile(image|color)$/)||"application-name"===Y(e.attributes.name)||"icon"===Y(e.attributes.rel)||"apple-touch-icon"===Y(e.attributes.rel)||"shortcut icon"===Y(e.attributes.rel))))return!0;if("meta"===e.tagName){if(t.headMetaDescKeywords&&Y(e.attributes.name).match(/^description|keywords$/))return!0;if(t.headMetaSocial&&(Y(e.attributes.property).match(/^(og|twitter|fb):/)||Y(e.attributes.name).match(/^(og|twitter):/)||"pinterest"===Y(e.attributes.name)))return!0;if(t.headMetaRobots&&("robots"===Y(e.attributes.name)||"googlebot"===Y(e.attributes.name)||"bingbot"===Y(e.attributes.name)))return!0;if(t.headMetaHttpEquiv&&void 0!==e.attributes["http-equiv"])return!0;if(t.headMetaAuthorship&&("author"===Y(e.attributes.name)||"generator"===Y(e.attributes.name)||"framework"===Y(e.attributes.name)||"publisher"===Y(e.attributes.name)||"progid"===Y(e.attributes.name)||Y(e.attributes.property).match(/^article:/)||Y(e.attributes.property).match(/^product:/)))return!0;if(t.headMetaVerification&&("google-site-verification"===Y(e.attributes.name)||"yandex-verification"===Y(e.attributes.name)||"csrf-token"===Y(e.attributes.name)||"p:domain_verify"===Y(e.attributes.name)||"verify-v1"===Y(e.attributes.name)||"verification"===Y(e.attributes.name)||"shopify-checkout-api-token"===Y(e.attributes.name)))return!0}}return!1}(J,S)&&(U||J.type!==r.Text||J.isStyle||J.textContent.replace(/^\s+|\s+$/gm,"").length)?R():T;var P=Object.assign(J,{id:n});if(o.add(e,P),n===T)return null;N&&N(e);var Q=!d;if(P.type===r.Element){Q=Q&&!P.needBlock,delete P.needBlock;var H=e.shadowRoot;H&&f(H)&&(P.isShadowHost=!0)}if((P.type===r.Document||P.type===r.Element)&&Q){S.headWhitespace&&P.type===r.Element&&"head"===P.tagName&&(U=!1);for(var j={doc:a,mirror:o,blockClass:i,blockSelector:s,maskTextClass:l,maskTextSelector:c,skipChild:d,inlineStylesheet:m,maskInputOptions:y,maskTextFn:I,maskInputFn:C,slimDOMOptions:S,dataURLOptions:A,inlineImages:w,recordCanvas:Z,preserveWhiteSpace:U,onSerialize:N,onIframeLoad:E,iframeLoadTimeout:x,onStylesheetLoad:F,stylesheetLoadTimeout:L,keepIframeSrcFn:W},X=0,q=Array.from(e.childNodes);X<q.length;X++){(te=z(q[X],j))&&P.childNodes.push(te)}if(h(e)&&e.shadowRoot)for(var $=0,ee=Array.from(e.shadowRoot.childNodes);$<ee.length;$++){var te;(te=z(ee[$],j))&&(f(e.shadowRoot)&&(te.isShadow=!0),P.childNodes.push(te))}}return e.parentNode&&g(e.parentNode)&&f(e.parentNode)&&(P.isShadow=!0),P.type===r.Element&&"iframe"===P.tagName&&function(e,t,n){var r=e.contentWindow;if(r){var a,o=!1;try{a=r.document.readyState}catch(l){return}if("complete"===a){var i="about:blank";if(r.location.href!==i||e.src===i||""===e.src)return setTimeout(t,0),e.addEventListener("load",t);e.addEventListener("load",t)}else{var s=setTimeout((function(){o||(t(),o=!0)}),n);e.addEventListener("load",(function(){clearTimeout(s),o=!0,t()}))}}}(e,(function(){var t=e.contentDocument;if(t&&E){var n=z(t,{doc:t,mirror:o,blockClass:i,blockSelector:s,maskTextClass:l,maskTextSelector:c,skipChild:!1,inlineStylesheet:m,maskInputOptions:y,maskTextFn:I,maskInputFn:C,slimDOMOptions:S,dataURLOptions:A,inlineImages:w,recordCanvas:Z,preserveWhiteSpace:U,onSerialize:N,onIframeLoad:E,iframeLoadTimeout:x,onStylesheetLoad:F,stylesheetLoadTimeout:L,keepIframeSrcFn:W});n&&E(e,n)}}),x),P.type===r.Element&&"link"===P.tagName&&"stylesheet"===P.attributes.rel&&function(e,t,n){var r,a=!1;try{r=e.sheet}catch(i){return}if(!r){var o=setTimeout((function(){a||(t(),a=!0)}),n);e.addEventListener("load",(function(){clearTimeout(o),a=!0,t()}))}}(e,(function(){if(F){var t=z(e,{doc:a,mirror:o,blockClass:i,blockSelector:s,maskTextClass:l,maskTextSelector:c,skipChild:!1,inlineStylesheet:m,maskInputOptions:y,maskTextFn:I,maskInputFn:C,slimDOMOptions:S,dataURLOptions:A,inlineImages:w,recordCanvas:Z,preserveWhiteSpace:U,onSerialize:N,onIframeLoad:E,iframeLoadTimeout:x,onStylesheetLoad:F,stylesheetLoadTimeout:L,keepIframeSrcFn:W});t&&F(e,t)}}),L),P}var J=/([^\\]):hover/;new RegExp(J.source,"g");var P=n(29439);function Q(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document,r={capture:!0,passive:!0};return n.addEventListener(e,t,r),function(){return n.removeEventListener(e,t,r)}}var H="Please stop import mirror directly. Instead of that,\r\nnow you can use replayer.getMirror() to access the mirror instance of a replayer,\r\nor you can use record.mirror to access the mirror instance during recording.",j={map:{},getId:function(){return console.error(H),-1},getNode:function(){return console.error(H),null},removeNodeFromMap:function(){console.error(H)},has:function(){return console.error(H),!1},reset:function(){console.error(H)}};function X(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=null,a=0;return function(){for(var o=arguments.length,i=new Array(o),s=0;s<o;s++)i[s]=arguments[s];var l=Date.now();a||!1!==n.leading||(a=l);var c=t-(l-a),u=this;c<=0||c>t?(r&&(clearTimeout(r),r=null),a=l,e.apply(u,i)):r||!1===n.trailing||(r=setTimeout((function(){a=!1===n.leading?0:Date.now(),r=null,e.apply(u,i)}),c))}}function q(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:window,o=a.Object.getOwnPropertyDescriptor(e,t);return a.Object.defineProperty(e,t,r?n:{set:function(e){var t=this;setTimeout((function(){n.set.call(t,e)}),0),o&&o.set&&o.set.call(this,e)}}),function(){return q(e,t,o||{},!0)}}function $(e,t,n){try{if(!(t in e))return function(){};var r=e[t],a=n(r);return"function"===typeof a&&(a.prototype=a.prototype||{},Object.defineProperties(a,{__rrweb_original__:{enumerable:!1,value:r}})),e[t]=a,function(){e[t]=r}}catch(o){return function(){}}}"undefined"!==typeof window&&window.Proxy&&window.Reflect&&(j=new Proxy(j,{get:function(e,t,n){return"map"===t&&console.error(H),Reflect.get(e,t,n)}}));var ee=Date.now;function te(e){var t,n,r,a,o,i,s=e.document;return{left:s.scrollingElement?s.scrollingElement.scrollLeft:void 0!==e.pageXOffset?e.pageXOffset:(null===s||void 0===s?void 0:s.documentElement.scrollLeft)||(null===(n=null===(t=null===s||void 0===s?void 0:s.body)||void 0===t?void 0:t.parentElement)||void 0===n?void 0:n.scrollLeft)||(null===(r=null===s||void 0===s?void 0:s.body)||void 0===r?void 0:r.scrollLeft)||0,top:s.scrollingElement?s.scrollingElement.scrollTop:void 0!==e.pageYOffset?e.pageYOffset:(null===s||void 0===s?void 0:s.documentElement.scrollTop)||(null===(o=null===(a=null===s||void 0===s?void 0:s.body)||void 0===a?void 0:a.parentElement)||void 0===o?void 0:o.scrollTop)||(null===(i=null===s||void 0===s?void 0:s.body)||void 0===i?void 0:i.scrollTop)||0}}function ne(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function re(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function ae(e,t,n,r){if(!e)return!1;var a=e.nodeType===e.ELEMENT_NODE?e:e.parentElement;if(!a)return!1;try{if("string"===typeof t){if(a.classList.contains(t))return!0;if(r&&null!==a.closest("."+t))return!0}else if(K(a,t,r))return!0}catch(o){}if(n){if(a.matches(n))return!0;if(r&&null!==a.closest(n))return!0}return!1}function oe(e,t){return t.getId(e)===T}function ie(e,t){if(g(e))return!1;var n=t.getId(e);return!t.has(n)||(!e.parentNode||e.parentNode.nodeType!==e.DOCUMENT_NODE)&&(!e.parentNode||ie(e.parentNode,t))}function se(e){return Boolean(e.changedTouches)}function le(e,t){return Boolean("IFRAME"===e.nodeName&&t.getMeta(e))}function ce(e,t){return Boolean("LINK"===e.nodeName&&e.nodeType===e.ELEMENT_NODE&&e.getAttribute&&"stylesheet"===e.getAttribute("rel")&&t.getMeta(e))}function ue(e){return Boolean(null===e||void 0===e?void 0:e.shadowRoot)}/[1-9][0-9]{12}/.test(Date.now().toString())||(ee=function(){return(new Date).getTime()});var de=function(){function e(){(0,s.Z)(this,e),this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}return(0,l.Z)(e,[{key:"getId",value:function(e){var t;return null!==(t=this.styleIDMap.get(e))&&void 0!==t?t:-1}},{key:"has",value:function(e){return this.styleIDMap.has(e)}},{key:"add",value:function(e,t){return this.has(e)?this.getId(e):(n=void 0===t?this.id++:t,this.styleIDMap.set(e,n),this.idStyleMap.set(n,e),n);var n}},{key:"getStyle",value:function(e){return this.idStyleMap.get(e)||null}},{key:"reset",value:function(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}},{key:"generateId",value:function(){return this.id++}}]),e}();function pe(e){var t,n,r=null;return(null===(n=null===(t=e.getRootNode)||void 0===t?void 0:t.call(e))||void 0===n?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&e.getRootNode().host&&(r=e.getRootNode().host),r}function he(e){var t=e.ownerDocument;if(!t)return!1;var n=function(e){for(var t,n=e;t=pe(n);)n=t;return n}(e);return t.contains(n)}function ge(e){var t=e.ownerDocument;return!!t&&(t.contains(e)||he(e))}var fe=function(e){return e[e.DomContentLoaded=0]="DomContentLoaded",e[e.Load=1]="Load",e[e.FullSnapshot=2]="FullSnapshot",e[e.IncrementalSnapshot=3]="IncrementalSnapshot",e[e.Meta=4]="Meta",e[e.Custom=5]="Custom",e[e.Plugin=6]="Plugin",e}(fe||{}),me=function(e){return e[e.Mutation=0]="Mutation",e[e.MouseMove=1]="MouseMove",e[e.MouseInteraction=2]="MouseInteraction",e[e.Scroll=3]="Scroll",e[e.ViewportResize=4]="ViewportResize",e[e.Input=5]="Input",e[e.TouchMove=6]="TouchMove",e[e.MediaInteraction=7]="MediaInteraction",e[e.StyleSheetRule=8]="StyleSheetRule",e[e.CanvasMutation=9]="CanvasMutation",e[e.Font=10]="Font",e[e.Log=11]="Log",e[e.Drag=12]="Drag",e[e.StyleDeclaration=13]="StyleDeclaration",e[e.Selection=14]="Selection",e[e.AdoptedStyleSheet=15]="AdoptedStyleSheet",e}(me||{}),ve=function(e){return e[e.MouseUp=0]="MouseUp",e[e.MouseDown=1]="MouseDown",e[e.Click=2]="Click",e[e.ContextMenu=3]="ContextMenu",e[e.DblClick=4]="DblClick",e[e.Focus=5]="Focus",e[e.Blur=6]="Blur",e[e.TouchStart=7]="TouchStart",e[e.TouchMove_Departed=8]="TouchMove_Departed",e[e.TouchEnd=9]="TouchEnd",e[e.TouchCancel=10]="TouchCancel",e}(ve||{}),ye=function(e){return e[e.Mouse=0]="Mouse",e[e.Pen=1]="Pen",e[e.Touch=2]="Touch",e}(ye||{}),Ie=function(e){return e[e["2D"]=0]="2D",e[e.WebGL=1]="WebGL",e[e.WebGL2=2]="WebGL2",e}(Ie||{});function Ce(e){return"__ln"in e}var Se,be=function(){function e(){(0,s.Z)(this,e),this.length=0,this.head=null,this.tail=null}return(0,l.Z)(e,[{key:"get",value:function(e){if(e>=this.length)throw new Error("Position outside of list range");for(var t=this.head,n=0;n<e;n++)t=(null===t||void 0===t?void 0:t.next)||null;return t}},{key:"addNode",value:function(e){var t={value:e,previous:null,next:null};if(e.__ln=t,e.previousSibling&&Ce(e.previousSibling)){var n=e.previousSibling.__ln.next;t.next=n,t.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=t,n&&(n.previous=t)}else if(e.nextSibling&&Ce(e.nextSibling)&&e.nextSibling.__ln.previous){var r=e.nextSibling.__ln.previous;t.previous=r,t.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=t,r&&(r.next=t)}else this.head&&(this.head.previous=t),t.next=this.head,this.head=t;null===t.next&&(this.tail=t),this.length++}},{key:"removeNode",value:function(e){var t=e.__ln;this.head&&(t.previous?(t.previous.next=t.next,t.next?t.next.previous=t.previous:this.tail=t.previous):(this.head=t.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}]),e}(),Ae=function(e,t){return"".concat(e,"@").concat(t)},ke=function(){function e(){var t=this;(0,s.Z)(this,e),this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=function(e){e.forEach(t.processMutation),t.emit()},this.emit=function(){if(!t.frozen&&!t.locked){for(var e=[],n=new Set,r=new be,a=function(e){for(var n=e,r=T;r===T;)r=(n=n&&n.nextSibling)&&t.mirror.getId(n);return r},o=function(o){if(o.parentNode&&ge(o)){var i=g(o.parentNode)?t.mirror.getId(pe(o)):t.mirror.getId(o.parentNode),s=a(o);if(-1===i||-1===s)return r.addNode(o);var l=z(o,{doc:t.doc,mirror:t.mirror,blockClass:t.blockClass,blockSelector:t.blockSelector,maskTextClass:t.maskTextClass,maskTextSelector:t.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:t.inlineStylesheet,maskInputOptions:t.maskInputOptions,maskTextFn:t.maskTextFn,maskInputFn:t.maskInputFn,slimDOMOptions:t.slimDOMOptions,dataURLOptions:t.dataURLOptions,recordCanvas:t.recordCanvas,inlineImages:t.inlineImages,onSerialize:function(e){le(e,t.mirror)&&t.iframeManager.addIframe(e),ce(e,t.mirror)&&t.stylesheetManager.trackLinkElement(e),ue(o)&&t.shadowDomManager.addShadowRoot(o.shadowRoot,t.doc)},onIframeLoad:function(e,n){t.iframeManager.attachIframe(e,n),t.shadowDomManager.observeAttachShadow(e)},onStylesheetLoad:function(e,n){t.stylesheetManager.attachLinkElement(e,n)}});l&&(e.push({parentId:i,nextId:s,node:l}),n.add(l.id))}};t.mapRemoves.length;)t.mirror.removeNodeFromMap(t.mapRemoves.shift());var i,s=(0,p.Z)(t.movedSet);try{for(s.s();!(i=s.n()).done;){var l=i.value;Me(t.removes,l,t.mirror)&&!t.movedSet.has(l.parentNode)||o(l)}}catch(k){s.e(k)}finally{s.f()}var c,u=(0,p.Z)(t.addedSet);try{for(u.s();!(c=u.n()).done;){var d=c.value;Re(t.droppedSet,d)||Me(t.removes,d,t.mirror)?Re(t.movedSet,d)?o(d):t.droppedSet.add(d):o(d)}}catch(k){u.e(k)}finally{u.f()}for(var h=null;r.length;){var f=null;if(h){var m=t.mirror.getId(h.value.parentNode),v=a(h.value);-1!==m&&-1!==v&&(f=h)}if(!f)for(var y=r.tail;y;){var I=y;if(y=y.previous,I){var C=t.mirror.getId(I.value.parentNode);if(-1===a(I.value))continue;if(-1!==C){f=I;break}var S=I.value;if(S.parentNode&&S.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){var b=S.parentNode.host;if(-1!==t.mirror.getId(b)){f=I;break}}}}if(!f){for(;r.head;)r.removeNode(r.head.value);break}h=f.previous,r.removeNode(f.value),o(f.value)}var A={texts:t.texts.map((function(e){return{id:t.mirror.getId(e.node),value:e.value}})).filter((function(e){return!n.has(e.id)})).filter((function(e){return t.mirror.has(e.id)})),attributes:t.attributes.map((function(e){var n=e.attributes;if("string"===typeof n.style){var r=JSON.stringify(e.styleDiff),a=JSON.stringify(e._unchangedStyles);r.length<n.style.length&&(r+a).split("var(").length===n.style.split("var(").length&&(n.style=e.styleDiff)}return{id:t.mirror.getId(e.node),attributes:n}})).filter((function(e){return!n.has(e.id)})).filter((function(e){return t.mirror.has(e.id)})),removes:t.removes,adds:e};(A.texts.length||A.attributes.length||A.removes.length||A.adds.length)&&(t.texts=[],t.attributes=[],t.removes=[],t.addedSet=new Set,t.movedSet=new Set,t.droppedSet=new Set,t.movedMap={},t.mutationCb(A))}},this.processMutation=function(e){if(!oe(e.target,t.mirror)){var n;try{n=document.implementation.createHTMLDocument()}catch(A){n=t.doc}switch(e.type){case"characterData":var r=e.target.textContent;ae(e.target,t.blockClass,t.blockSelector,!1)||r===e.oldValue||t.texts.push({value:U(e.target,t.maskTextClass,t.maskTextSelector)&&r?t.maskTextFn?t.maskTextFn(r):r.replace(/[\S]/g,"*"):r,node:e.target});break;case"attributes":var a=e.target,o=e.attributeName,i=e.target.getAttribute(o);if("value"===o){var s=b(a);i=I({element:a,maskInputOptions:t.maskInputOptions,tagName:a.tagName,type:s,value:i,maskInputFn:t.maskInputFn})}if(ae(e.target,t.blockClass,t.blockSelector,!1)||i===e.oldValue)return;var l=t.attributes.find((function(t){return t.node===e.target}));if("IFRAME"===a.tagName&&"src"===o&&!t.keepIframeSrcFn(i)){if(a.contentDocument)return;o="rr_src"}if(l||(l={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},t.attributes.push(l)),"type"===o&&"INPUT"===a.tagName&&"password"===(e.oldValue||"").toLowerCase()&&a.setAttribute("data-rr-is-password","true"),!G(a.tagName,o)&&(l.attributes[o]=V(t.doc,C(a.tagName),C(o),i),"style"===o)){var c=n.createElement("span");e.oldValue&&c.setAttribute("style",e.oldValue);for(var u=0,d=Array.from(a.style);u<d.length;u++){var p=d[u],h=a.style.getPropertyValue(p),m=a.style.getPropertyPriority(p);h!==c.style.getPropertyValue(p)||m!==c.style.getPropertyPriority(p)?l.styleDiff[p]=""===m?h:[h,m]:l._unchangedStyles[p]=[h,m]}for(var v=0,y=Array.from(c.style);v<y.length;v++){var S=y[v];""===a.style.getPropertyValue(S)&&(l.styleDiff[S]=!1)}}break;case"childList":if(ae(e.target,t.blockClass,t.blockSelector,!0))return;e.addedNodes.forEach((function(n){return t.genAdds(n,e.target)})),e.removedNodes.forEach((function(n){var r=t.mirror.getId(n),a=g(e.target)?t.mirror.getId(e.target.host):t.mirror.getId(e.target);ae(e.target,t.blockClass,t.blockSelector,!1)||oe(n,t.mirror)||!function(e,t){return-1!==t.getId(e)}(n,t.mirror)||(t.addedSet.has(n)?(we(t.addedSet,n),t.droppedSet.add(n)):t.addedSet.has(e.target)&&-1===r||ie(e.target,t.mirror)||(t.movedSet.has(n)&&t.movedMap[Ae(r,a)]?we(t.movedSet,n):t.removes.push({parentId:a,id:r,isShadow:!(!g(e.target)||!f(e.target))||void 0})),t.mapRemoves.push(n))}))}}},this.genAdds=function(e,n){if(!t.processedNodeManager.inOtherBuffer(e,t)&&!t.addedSet.has(e)&&!t.movedSet.has(e)){if(t.mirror.hasNode(e)){if(oe(e,t.mirror))return;t.movedSet.add(e);var r=null;n&&t.mirror.hasNode(n)&&(r=t.mirror.getId(n)),r&&-1!==r&&(t.movedMap[Ae(t.mirror.getId(e),r)]=!0)}else t.addedSet.add(e),t.droppedSet.delete(e);ae(e,t.blockClass,t.blockSelector,!1)||(e.childNodes.forEach((function(e){return t.genAdds(e)})),ue(e)&&e.shadowRoot.childNodes.forEach((function(n){t.processedNodeManager.add(n,t),t.genAdds(n,e)})))}}}return(0,l.Z)(e,[{key:"init",value:function(e){var t=this;["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach((function(n){t[n]=e[n]}))}},{key:"freeze",value:function(){this.frozen=!0,this.canvasManager.freeze()}},{key:"unfreeze",value:function(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}},{key:"isFrozen",value:function(){return this.frozen}},{key:"lock",value:function(){this.locked=!0,this.canvasManager.lock()}},{key:"unlock",value:function(){this.locked=!1,this.canvasManager.unlock(),this.emit()}},{key:"reset",value:function(){this.shadowDomManager.reset(),this.canvasManager.reset()}}]),e}();function we(e,t){e.delete(t),t.childNodes.forEach((function(t){return we(e,t)}))}function Me(e,t,n){return 0!==e.length&&Te(e,t,n)}function Te(e,t,n){var r=t.parentNode;if(!r)return!1;var a=n.getId(r);return!!e.some((function(e){return e.id===a}))||Te(e,r,n)}function Re(e,t){return 0!==e.size&&Ze(e,t)}function Ze(e,t){var n=t.parentNode;return!!n&&(!!e.has(n)||Ze(e,n))}function Ne(e){Se=e}function Ee(){Se=void 0}var Oe=function(e){if(!Se)return e;return function(){try{return e.apply(void 0,arguments)}catch(t){if(Se&&!0===Se(t))return;throw t}}},xe=[];function Fe(e){try{if("composedPath"in e){var t=e.composedPath();if(t.length)return t[0]}else if("path"in e&&e.path.length)return e.path[0]}catch(n){}return e&&e.target}function De(e,t){var n,r,a=new ke;xe.push(a),a.init(e);var o=window.MutationObserver||window.__rrMutationObserver,i=null===(r=null===(n=null===window||void 0===window?void 0:window.Zone)||void 0===n?void 0:n.__symbol__)||void 0===r?void 0:r.call(n,"MutationObserver");i&&window[i]&&(o=window[i]);var s=new o(Oe(a.processMutations.bind(a)));return s.observe(t,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function Le(e){var t=e.mouseInteractionCb,n=e.doc,r=e.mirror,a=e.blockClass,o=e.blockSelector,i=e.sampling;if(!1===i.mouseInteraction)return function(){};var s=!0===i.mouseInteraction||void 0===i.mouseInteraction?{}:i.mouseInteraction,l=[],c=null;return Object.keys(ve).filter((function(e){return Number.isNaN(Number(e))&&!e.endsWith("_Departed")&&!1!==s[e]})).forEach((function(e){var i=C(e),s=function(e){return function(n){var i=Fe(n);if(!ae(i,a,o,!0)){var s=null,l=e;if("pointerType"in n){switch(n.pointerType){case"mouse":s=ye.Mouse;break;case"touch":s=ye.Touch;break;case"pen":s=ye.Pen}s===ye.Touch?ve[e]===ve.MouseDown?l="TouchStart":ve[e]===ve.MouseUp&&(l="TouchEnd"):ye.Pen}else se(n)&&(s=ye.Touch);null!==s?(c=s,(l.startsWith("Touch")&&s===ye.Touch||l.startsWith("Mouse")&&s===ye.Mouse)&&(s=null)):ve[e]===ve.Click&&(s=c,c=null);var u=se(n)?n.changedTouches[0]:n;if(u){var d=r.getId(i),p=u.clientX,h=u.clientY;Oe(t)(Object.assign({type:ve[l],id:d,x:p,y:h},null!==s&&{pointerType:s}))}}}}(e);if(window.PointerEvent)switch(ve[e]){case ve.MouseDown:case ve.MouseUp:i=i.replace("mouse","pointer");break;case ve.TouchStart:case ve.TouchEnd:return}l.push(Q(i,s,n))})),Oe((function(){l.forEach((function(e){return e()}))}))}function Be(e){var t=e.scrollCb,n=e.doc,r=e.mirror,a=e.blockClass,o=e.blockSelector,i=e.sampling;return Q("scroll",Oe(X(Oe((function(e){var i=Fe(e);if(i&&!ae(i,a,o,!0)){var s=r.getId(i);if(i===n&&n.defaultView){var l=te(n.defaultView);t({id:s,x:l.left,y:l.top})}else t({id:s,x:i.scrollLeft,y:i.scrollTop})}})),i.scroll||100)),n)}function We(e,t){var n=Object.assign({},e);return t||delete n.userTriggered,n}var Ve=["INPUT","TEXTAREA","SELECT"],Ge=new WeakMap;function Ke(e){return function(e,t){if(ze("CSSGroupingRule")&&e.parentRule instanceof CSSGroupingRule||ze("CSSMediaRule")&&e.parentRule instanceof CSSMediaRule||ze("CSSSupportsRule")&&e.parentRule instanceof CSSSupportsRule||ze("CSSConditionRule")&&e.parentRule instanceof CSSConditionRule){var n=Array.from(e.parentRule.cssRules).indexOf(e);t.unshift(n)}else if(e.parentStyleSheet){var r=Array.from(e.parentStyleSheet.cssRules).indexOf(e);t.unshift(r)}return t}(e,[])}function Ue(e,t,n){var r,a;return e?(e.ownerNode?r=t.getId(e.ownerNode):a=n.getId(e),{styleId:a,id:r}):{}}function _e(e,t){var n,r,a,o=e.mirror,i=e.stylesheetManager,s=null;s="#document"===t.nodeName?o.getId(t):o.getId(t.host);var l="#document"===t.nodeName?null===(n=t.defaultView)||void 0===n?void 0:n.Document:null===(a=null===(r=t.ownerDocument)||void 0===r?void 0:r.defaultView)||void 0===a?void 0:a.ShadowRoot,c=Object.getOwnPropertyDescriptor(null===l||void 0===l?void 0:l.prototype,"adoptedStyleSheets");return null!==s&&-1!==s&&l&&c?(Object.defineProperty(t,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:function(){var e;return null===(e=c.get)||void 0===e?void 0:e.call(this)},set:function(e){var t,n=null===(t=c.set)||void 0===t?void 0:t.call(this,e);if(null!==s&&-1!==s)try{i.adoptStyleSheets(e,s)}catch(r){}return n}}),Oe((function(){Object.defineProperty(t,"adoptedStyleSheets",{configurable:c.configurable,enumerable:c.enumerable,get:c.get,set:c.set})}))):function(){}}function Ye(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.doc.defaultView;if(!n)return function(){};!function(e,t){var n=e.mutationCb,r=e.mousemoveCb,a=e.mouseInteractionCb,o=e.scrollCb,i=e.viewportResizeCb,s=e.inputCb,l=e.mediaInteractionCb,c=e.styleSheetRuleCb,u=e.styleDeclarationCb,d=e.canvasMutationCb,p=e.fontCb,h=e.selectionCb;e.mutationCb=function(){t.mutation&&t.mutation.apply(t,arguments),n.apply(void 0,arguments)},e.mousemoveCb=function(){t.mousemove&&t.mousemove.apply(t,arguments),r.apply(void 0,arguments)},e.mouseInteractionCb=function(){t.mouseInteraction&&t.mouseInteraction.apply(t,arguments),a.apply(void 0,arguments)},e.scrollCb=function(){t.scroll&&t.scroll.apply(t,arguments),o.apply(void 0,arguments)},e.viewportResizeCb=function(){t.viewportResize&&t.viewportResize.apply(t,arguments),i.apply(void 0,arguments)},e.inputCb=function(){t.input&&t.input.apply(t,arguments),s.apply(void 0,arguments)},e.mediaInteractionCb=function(){t.mediaInteaction&&t.mediaInteaction.apply(t,arguments),l.apply(void 0,arguments)},e.styleSheetRuleCb=function(){t.styleSheetRule&&t.styleSheetRule.apply(t,arguments),c.apply(void 0,arguments)},e.styleDeclarationCb=function(){t.styleDeclaration&&t.styleDeclaration.apply(t,arguments),u.apply(void 0,arguments)},e.canvasMutationCb=function(){t.canvasMutation&&t.canvasMutation.apply(t,arguments),d.apply(void 0,arguments)},e.fontCb=function(){t.font&&t.font.apply(t,arguments),p.apply(void 0,arguments)},e.selectionCb=function(){t.selection&&t.selection.apply(t,arguments),h.apply(void 0,arguments)}}(e,t);var r,a=De(e,e.doc),i=function(e){var t=e.mousemoveCb,n=e.sampling,r=e.doc,a=e.mirror;if(!1===n.mousemove)return function(){};var o,i="number"===typeof n.mousemove?n.mousemove:50,s="number"===typeof n.mousemoveCallback?n.mousemoveCallback:500,l=[],c=X(Oe((function(e){var n=Date.now()-o;t(l.map((function(e){return e.timeOffset-=n,e})),e),l=[],o=null})),s),u=Oe(X(Oe((function(e){var t=Fe(e),n=se(e)?e.changedTouches[0]:e,r=n.clientX,i=n.clientY;o||(o=ee()),l.push({x:r,y:i,id:a.getId(t),timeOffset:ee()-o}),c("undefined"!==typeof DragEvent&&e instanceof DragEvent?me.Drag:e instanceof MouseEvent?me.MouseMove:me.TouchMove)})),i,{trailing:!1})),d=[Q("mousemove",u,r),Q("touchmove",u,r),Q("drag",u,r)];return Oe((function(){d.forEach((function(e){return e()}))}))}(e),s=Le(e),l=Be(e),c=function(e,t){var n=e.viewportResizeCb,r=t.win,a=-1,o=-1;return Q("resize",Oe(X(Oe((function(){var e=ne(),t=re();a===e&&o===t||(n({width:Number(t),height:Number(e)}),a=e,o=t)})),200)),r)}(e,{win:n}),u=function(e){var t=e.inputCb,n=e.doc,r=e.mirror,a=e.blockClass,i=e.blockSelector,s=e.ignoreClass,l=e.ignoreSelector,c=e.maskInputOptions,u=e.maskInputFn,d=e.sampling,p=e.userTriggeredOnInput;function h(e){var t=Fe(e),r=e.isTrusted,o=t&&t.tagName;if(t&&"OPTION"===o&&(t=t.parentElement),t&&o&&!(Ve.indexOf(o)<0)&&!ae(t,a,i,!0)&&!(t.classList.contains(s)||l&&t.matches(l))){var d=t.value,h=!1,f=b(t)||"";"radio"===f||"checkbox"===f?h=t.checked:(c[o.toLowerCase()]||c[f])&&(d=I({element:t,maskInputOptions:c,tagName:o,type:f,value:d,maskInputFn:u})),g(t,Oe(We)({text:d,isChecked:h,userTriggered:r},p));var m=t.name;"radio"===f&&m&&h&&n.querySelectorAll('input[type="radio"][name="'.concat(m,'"]')).forEach((function(e){e!==t&&g(e,Oe(We)({text:e.value,isChecked:!h,userTriggered:!1},p))}))}}function g(e,n){var a=Ge.get(e);if(!a||a.text!==n.text||a.isChecked!==n.isChecked){Ge.set(e,n);var o=r.getId(e);Oe(t)(Object.assign(Object.assign({},n),{id:o}))}}var f=("last"===d.input?["change"]:["input","change"]).map((function(e){return Q(e,Oe(h),n)})),m=n.defaultView;if(!m)return function(){f.forEach((function(e){return e()}))};var v=m.Object.getOwnPropertyDescriptor(m.HTMLInputElement.prototype,"value"),y=[[m.HTMLInputElement.prototype,"value"],[m.HTMLInputElement.prototype,"checked"],[m.HTMLSelectElement.prototype,"value"],[m.HTMLTextAreaElement.prototype,"value"],[m.HTMLSelectElement.prototype,"selectedIndex"],[m.HTMLOptionElement.prototype,"selected"]];return v&&v.set&&f.push.apply(f,(0,o.Z)(y.map((function(e){return q(e[0],e[1],{set:function(){Oe(h)({target:this,isTrusted:!1})}},!1,m)})))),Oe((function(){f.forEach((function(e){return e()}))}))}(e),d=function(e){var t=e.mediaInteractionCb,n=e.blockClass,r=e.blockSelector,a=e.mirror,o=e.sampling,i=e.doc,s=Oe((function(e){return X(Oe((function(o){var i=Fe(o);if(i&&!ae(i,n,r,!0)){var s=i.currentTime,l=i.volume,c=i.muted,u=i.playbackRate;t({type:e,id:a.getId(i),currentTime:s,volume:l,muted:c,playbackRate:u})}})),o.media||500)})),l=[Q("play",s(0),i),Q("pause",s(1),i),Q("seeked",s(2),i),Q("volumechange",s(3),i),Q("ratechange",s(4),i)];return Oe((function(){l.forEach((function(e){return e()}))}))}(e),h=function(e,t){var n=e.styleSheetRuleCb,r=e.mirror,a=e.stylesheetManager,i=t.win;if(!i.CSSStyleSheet||!i.CSSStyleSheet.prototype)return function(){};var s=i.CSSStyleSheet.prototype.insertRule;i.CSSStyleSheet.prototype.insertRule=new Proxy(s,{apply:Oe((function(e,t,o){var i=(0,P.Z)(o,2),s=i[0],l=i[1],c=Ue(t,r,a.styleMirror),u=c.id,d=c.styleId;return(u&&-1!==u||d&&-1!==d)&&n({id:u,styleId:d,adds:[{rule:s,index:l}]}),e.apply(t,o)}))});var l,c,u=i.CSSStyleSheet.prototype.deleteRule;i.CSSStyleSheet.prototype.deleteRule=new Proxy(u,{apply:Oe((function(e,t,o){var i=(0,P.Z)(o,1)[0],s=Ue(t,r,a.styleMirror),l=s.id,c=s.styleId;return(l&&-1!==l||c&&-1!==c)&&n({id:l,styleId:c,removes:[{index:i}]}),e.apply(t,o)}))}),i.CSSStyleSheet.prototype.replace&&(l=i.CSSStyleSheet.prototype.replace,i.CSSStyleSheet.prototype.replace=new Proxy(l,{apply:Oe((function(e,t,o){var i=(0,P.Z)(o,1)[0],s=Ue(t,r,a.styleMirror),l=s.id,c=s.styleId;return(l&&-1!==l||c&&-1!==c)&&n({id:l,styleId:c,replace:i}),e.apply(t,o)}))})),i.CSSStyleSheet.prototype.replaceSync&&(c=i.CSSStyleSheet.prototype.replaceSync,i.CSSStyleSheet.prototype.replaceSync=new Proxy(c,{apply:Oe((function(e,t,o){var i=(0,P.Z)(o,1)[0],s=Ue(t,r,a.styleMirror),l=s.id,c=s.styleId;return(l&&-1!==l||c&&-1!==c)&&n({id:l,styleId:c,replaceSync:i}),e.apply(t,o)}))}));var d={};Je("CSSGroupingRule")?d.CSSGroupingRule=i.CSSGroupingRule:(Je("CSSMediaRule")&&(d.CSSMediaRule=i.CSSMediaRule),Je("CSSConditionRule")&&(d.CSSConditionRule=i.CSSConditionRule),Je("CSSSupportsRule")&&(d.CSSSupportsRule=i.CSSSupportsRule));var p={};return Object.entries(d).forEach((function(e){var t=(0,P.Z)(e,2),i=t[0],s=t[1];p[i]={insertRule:s.prototype.insertRule,deleteRule:s.prototype.deleteRule},s.prototype.insertRule=new Proxy(p[i].insertRule,{apply:Oe((function(e,t,i){var s=(0,P.Z)(i,2),l=s[0],c=s[1],u=Ue(t.parentStyleSheet,r,a.styleMirror),d=u.id,p=u.styleId;return(d&&-1!==d||p&&-1!==p)&&n({id:d,styleId:p,adds:[{rule:l,index:[].concat((0,o.Z)(Ke(t)),[c||0])}]}),e.apply(t,i)}))}),s.prototype.deleteRule=new Proxy(p[i].deleteRule,{apply:Oe((function(e,t,i){var s=(0,P.Z)(i,1)[0],l=Ue(t.parentStyleSheet,r,a.styleMirror),c=l.id,u=l.styleId;return(c&&-1!==c||u&&-1!==u)&&n({id:c,styleId:u,removes:[{index:[].concat((0,o.Z)(Ke(t)),[s])}]}),e.apply(t,i)}))})})),Oe((function(){i.CSSStyleSheet.prototype.insertRule=s,i.CSSStyleSheet.prototype.deleteRule=u,l&&(i.CSSStyleSheet.prototype.replace=l),c&&(i.CSSStyleSheet.prototype.replaceSync=c),Object.entries(d).forEach((function(e){var t=(0,P.Z)(e,2),n=t[0],r=t[1];r.prototype.insertRule=p[n].insertRule,r.prototype.deleteRule=p[n].deleteRule}))}))}(e,{win:n}),g=_e(e,e.doc),f=function(e,t){var n=e.styleDeclarationCb,r=e.mirror,a=e.ignoreCSSAttributes,o=e.stylesheetManager,i=t.win,s=i.CSSStyleDeclaration.prototype.setProperty;i.CSSStyleDeclaration.prototype.setProperty=new Proxy(s,{apply:Oe((function(e,t,i){var l,c=(0,P.Z)(i,3),u=c[0],d=c[1],p=c[2];if(a.has(u))return s.apply(t,[u,d,p]);var h=Ue(null===(l=t.parentRule)||void 0===l?void 0:l.parentStyleSheet,r,o.styleMirror),g=h.id,f=h.styleId;return(g&&-1!==g||f&&-1!==f)&&n({id:g,styleId:f,set:{property:u,value:d,priority:p},index:Ke(t.parentRule)}),e.apply(t,i)}))});var l=i.CSSStyleDeclaration.prototype.removeProperty;return i.CSSStyleDeclaration.prototype.removeProperty=new Proxy(l,{apply:Oe((function(e,t,i){var s,c=(0,P.Z)(i,1)[0];if(a.has(c))return l.apply(t,[c]);var u=Ue(null===(s=t.parentRule)||void 0===s?void 0:s.parentStyleSheet,r,o.styleMirror),d=u.id,p=u.styleId;return(d&&-1!==d||p&&-1!==p)&&n({id:d,styleId:p,remove:{property:c},index:Ke(t.parentRule)}),e.apply(t,i)}))}),Oe((function(){i.CSSStyleDeclaration.prototype.setProperty=s,i.CSSStyleDeclaration.prototype.removeProperty=l}))}(e,{win:n}),m=e.collectFonts?function(e){var t=e.fontCb,n=e.doc,r=n.defaultView;if(!r)return function(){};var a=[],o=new WeakMap,i=r.FontFace;r.FontFace=function(e,t,n){var r=new i(e,t,n);return o.set(r,{family:e,buffer:"string"!==typeof t,descriptors:n,fontSource:"string"===typeof t?t:JSON.stringify(Array.from(new Uint8Array(t)))}),r};var s=$(n.fonts,"add",(function(e){return function(n){return setTimeout(Oe((function(){var e=o.get(n);e&&(t(e),o.delete(n))})),0),e.apply(this,[n])}}));return a.push((function(){r.FontFace=i})),a.push(s),Oe((function(){a.forEach((function(e){return e()}))}))}(e):function(){},v=function(e){var t=e.doc,n=e.mirror,r=e.blockClass,a=e.blockSelector,o=e.selectionCb,i=!0,s=Oe((function(){var e=t.getSelection();if(!(!e||i&&(null===e||void 0===e?void 0:e.isCollapsed))){i=e.isCollapsed||!1;for(var s=[],l=e.rangeCount||0,c=0;c<l;c++){var u=e.getRangeAt(c),d=u.startContainer,p=u.startOffset,h=u.endContainer,g=u.endOffset;ae(d,r,a,!0)||ae(h,r,a,!0)||s.push({start:n.getId(d),startOffset:p,end:n.getId(h),endOffset:g})}o({ranges:s})}}));return s(),Q("selectionchange",s)}(e),y=[],C=(0,p.Z)(e.plugins);try{for(C.s();!(r=C.n()).done;){var S=r.value;y.push(S.observer(S.callback,n,S.options))}}catch(A){C.e(A)}finally{C.f()}return Oe((function(){xe.forEach((function(e){return e.reset()})),a.disconnect(),i(),s(),l(),c(),u(),d(),h(),g(),f(),m(),v(),y.forEach((function(e){return e()}))}))}function ze(e){return"undefined"!==typeof window[e]}function Je(e){return Boolean("undefined"!==typeof window[e]&&window[e].prototype&&"insertRule"in window[e].prototype&&"deleteRule"in window[e].prototype)}var Pe=function(){function e(t){(0,s.Z)(this,e),this.generateIdFn=t,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}return(0,l.Z)(e,[{key:"getId",value:function(e,t,n,r){var a=n||this.getIdToRemoteIdMap(e),o=r||this.getRemoteIdToIdMap(e),i=a.get(t);return i||(i=this.generateIdFn(),a.set(t,i),o.set(i,t)),i}},{key:"getIds",value:function(e,t){var n=this,r=this.getIdToRemoteIdMap(e),a=this.getRemoteIdToIdMap(e);return t.map((function(t){return n.getId(e,t,r,a)}))}},{key:"getRemoteId",value:function(e,t,n){var r=n||this.getRemoteIdToIdMap(e);if("number"!==typeof t)return t;var a=r.get(t);return a||-1}},{key:"getRemoteIds",value:function(e,t){var n=this,r=this.getRemoteIdToIdMap(e);return t.map((function(t){return n.getRemoteId(e,t,r)}))}},{key:"reset",value:function(e){if(!e)return this.iframeIdToRemoteIdMap=new WeakMap,void(this.iframeRemoteIdToIdMap=new WeakMap);this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}},{key:"getIdToRemoteIdMap",value:function(e){var t=this.iframeIdToRemoteIdMap.get(e);return t||(t=new Map,this.iframeIdToRemoteIdMap.set(e,t)),t}},{key:"getRemoteIdToIdMap",value:function(e){var t=this.iframeRemoteIdToIdMap.get(e);return t||(t=new Map,this.iframeRemoteIdToIdMap.set(e,t)),t}}]),e}(),Qe=function(){function e(t){(0,s.Z)(this,e),this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Pe(R),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=t.mutationCb,this.wrappedEmit=t.wrappedEmit,this.stylesheetManager=t.stylesheetManager,this.recordCrossOriginIframes=t.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Pe(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=t.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}return(0,l.Z)(e,[{key:"addIframe",value:function(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}},{key:"addLoadListener",value:function(e){this.loadListener=e}},{key:"attachIframe",value:function(e,t){var n;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:t}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),null===(n=this.loadListener)||void 0===n||n.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}},{key:"handleMessage",value:function(e){var t=e;if("rrweb"===t.data.type&&t.origin===t.data.origin&&e.source){var n=this.crossOriginIframeMap.get(e.source);if(n){var r=this.transformCrossOriginEvent(n,t.data.event);r&&this.wrappedEmit(r,t.data.isCheckout)}}}},{key:"transformCrossOriginEvent",value:function(e,t){var n,r=this;switch(t.type){case fe.FullSnapshot:this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(t.data.node,e);var a=t.data.node.id;return this.crossOriginIframeRootIdMap.set(e,a),this.patchRootIdOnNode(t.data.node,a),{timestamp:t.timestamp,type:fe.IncrementalSnapshot,data:{source:me.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:t.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}};case fe.Meta:case fe.Load:case fe.DomContentLoaded:return!1;case fe.Plugin:return t;case fe.Custom:return this.replaceIds(t.data.payload,e,["id","parentId","previousId","nextId"]),t;case fe.IncrementalSnapshot:switch(t.data.source){case me.Mutation:return t.data.adds.forEach((function(t){r.replaceIds(t,e,["parentId","nextId","previousId"]),r.replaceIdOnNode(t.node,e);var n=r.crossOriginIframeRootIdMap.get(e);n&&r.patchRootIdOnNode(t.node,n)})),t.data.removes.forEach((function(t){r.replaceIds(t,e,["parentId","id"])})),t.data.attributes.forEach((function(t){r.replaceIds(t,e,["id"])})),t.data.texts.forEach((function(t){r.replaceIds(t,e,["id"])})),t;case me.Drag:case me.TouchMove:case me.MouseMove:return t.data.positions.forEach((function(t){r.replaceIds(t,e,["id"])})),t;case me.ViewportResize:return!1;case me.MediaInteraction:case me.MouseInteraction:case me.Scroll:case me.CanvasMutation:case me.Input:return this.replaceIds(t.data,e,["id"]),t;case me.StyleSheetRule:case me.StyleDeclaration:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleId"]),t;case me.Font:return t;case me.Selection:return t.data.ranges.forEach((function(t){r.replaceIds(t,e,["start","end"])})),t;case me.AdoptedStyleSheet:return this.replaceIds(t.data,e,["id"]),this.replaceStyleIds(t.data,e,["styleIds"]),null===(n=t.data.styles)||void 0===n||n.forEach((function(t){r.replaceStyleIds(t,e,["styleId"])})),t}}}},{key:"replace",value:function(e,t,n,r){var a,o=(0,p.Z)(r);try{for(o.s();!(a=o.n()).done;){var i=a.value;(Array.isArray(t[i])||"number"===typeof t[i])&&(Array.isArray(t[i])?t[i]=e.getIds(n,t[i]):t[i]=e.getId(n,t[i]))}}catch(s){o.e(s)}finally{o.f()}return t}},{key:"replaceIds",value:function(e,t,n){return this.replace(this.crossOriginIframeMirror,e,t,n)}},{key:"replaceStyleIds",value:function(e,t,n){return this.replace(this.crossOriginIframeStyleMirror,e,t,n)}},{key:"replaceIdOnNode",value:function(e,t){var n=this;this.replaceIds(e,t,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach((function(e){n.replaceIdOnNode(e,t)}))}},{key:"patchRootIdOnNode",value:function(e,t){var n=this;e.type===r.Document||e.rootId||(e.rootId=t),"childNodes"in e&&e.childNodes.forEach((function(e){n.patchRootIdOnNode(e,t)}))}}]),e}(),He=function(){function e(t){(0,s.Z)(this,e),this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=t.mutationCb,this.scrollCb=t.scrollCb,this.bypassOptions=t.bypassOptions,this.mirror=t.mirror,this.init()}return(0,l.Z)(e,[{key:"init",value:function(){this.reset(),this.patchAttachShadow(Element,document)}},{key:"addShadowRoot",value:function(e,t){var n=this;if(f(e)&&!this.shadowDoms.has(e)){this.shadowDoms.add(e);var r=De(Object.assign(Object.assign({},this.bypassOptions),{doc:t,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push((function(){return r.disconnect()})),this.restoreHandlers.push(Be(Object.assign(Object.assign({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout((function(){e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&n.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,n.mirror.getId(e.host)),n.restoreHandlers.push(_e({mirror:n.mirror,stylesheetManager:n.bypassOptions.stylesheetManager},e))}),0)}}},{key:"observeAttachShadow",value:function(e){e.contentWindow&&e.contentDocument&&this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}},{key:"patchAttachShadow",value:function(e,t){var n=this;this.restoreHandlers.push($(e.prototype,"attachShadow",(function(e){return function(r){var a=e.call(this,r);return this.shadowRoot&&ge(this)&&n.addShadowRoot(this.shadowRoot,t),a}})))}},{key:"reset",value:function(){this.restoreHandlers.forEach((function(e){try{e()}catch(t){}})),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}]),e}(),je=n(74165);function Xe(e,t,n,r){return new(n||(n=Promise))((function(a,o){function i(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r.throw(e))}catch(t){o(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}l((r=r.apply(e,t||[])).next())}))}for(var qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",$e="undefined"===typeof Uint8Array?[]:new Uint8Array(256),et=0;et<64;et++)$e[qe.charCodeAt(et)]=et;var tt=new Map;var nt=function(e,t,n){if(e&&(ot(e,t)||"object"===typeof e)){var r=function(e,t){var n=tt.get(e);return n||(n=new Map,tt.set(e,n)),n.has(t)||n.set(t,[]),n.get(t)}(n,e.constructor.name),a=r.indexOf(e);return-1===a&&(a=r.length,r.push(e)),a}};function rt(e,t,n){if(e instanceof Array)return e.map((function(e){return rt(e,t,n)}));if(null===e)return e;if(e instanceof Float32Array||e instanceof Float64Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Int16Array||e instanceof Int8Array||e instanceof Uint8ClampedArray)return{rr_type:e.constructor.name,args:[Object.values(e)]};if(e instanceof ArrayBuffer){var r=e.constructor.name,a=function(e){var t,n=new Uint8Array(e),r=n.length,a="";for(t=0;t<r;t+=3)a+=qe[n[t]>>2],a+=qe[(3&n[t])<<4|n[t+1]>>4],a+=qe[(15&n[t+1])<<2|n[t+2]>>6],a+=qe[63&n[t+2]];return r%3===2?a=a.substring(0,a.length-1)+"=":r%3===1&&(a=a.substring(0,a.length-2)+"=="),a}(e);return{rr_type:r,base64:a}}if(e instanceof DataView)return{rr_type:e.constructor.name,args:[rt(e.buffer,t,n),e.byteOffset,e.byteLength]};if(e instanceof HTMLImageElement)return{rr_type:e.constructor.name,src:e.src};if(e instanceof HTMLCanvasElement){return{rr_type:"HTMLImageElement",src:e.toDataURL()}}return e instanceof ImageData?{rr_type:e.constructor.name,args:[rt(e.data,t,n),e.width,e.height]}:ot(e,t)||"object"===typeof e?{rr_type:e.constructor.name,index:nt(e,t,n)}:e}var at=function(e,t,n){return(0,o.Z)(e).map((function(e){return rt(e,t,n)}))},ot=function(e,t){var n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter((function(e){return"function"===typeof t[e]}));return Boolean(n.find((function(n){return e instanceof t[n]})))};function it(e,t,n,r){var a=[];try{var o=$(e.HTMLCanvasElement.prototype,"getContext",(function(e){return function(a){for(var o=arguments.length,i=new Array(o>1?o-1:0),s=1;s<o;s++)i[s-1]=arguments[s];if(!ae(this,t,n,!0)){var l=function(e){return"experimental-webgl"===e?"webgl":e}(a);if("__context"in this||(this.__context=l),r&&["webgl","webgl2"].includes(l))if(i[0]&&"object"===typeof i[0]){var c=i[0];c.preserveDrawingBuffer||(c.preserveDrawingBuffer=!0)}else i.splice(0,1,{preserveDrawingBuffer:!0})}return e.apply(this,[a].concat(i))}}));a.push(o)}catch(i){console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return function(){a.forEach((function(e){return e()}))}}function st(e,t,n,r,a,o,i){var s,l=[],c=Object.getOwnPropertyNames(e),u=(0,p.Z)(c);try{var d=function(){var o=s.value;if(["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(o))return 0;try{if("function"!==typeof e[o])return 0;var c=$(e,o,(function(e){return function(){for(var s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];var u=e.apply(this,l);if(nt(u,i,this),"tagName"in this.canvas&&!ae(this.canvas,r,a,!0)){var d=at([].concat(l),i,this),p={type:t,property:o,args:d};n(this.canvas,p)}return u}}));l.push(c)}catch(d){var u=q(e,o,{set:function(e){n(this.canvas,{type:t,property:o,args:[e],setter:!0})}});l.push(u)}};for(u.s();!(s=u.n()).done;)d()}catch(h){u.e(h)}finally{u.f()}return l}function lt(e,t,n){var r=void 0===t?null:t,a=function(e,t){var n=atob(e);if(t){for(var r=new Uint8Array(n.length),a=0,o=n.length;a<o;++a)r[a]=n.charCodeAt(a);return String.fromCharCode.apply(null,new Uint16Array(r.buffer))}return n}(e,void 0!==n&&n),o=a.indexOf("\n",10)+1,i=a.substring(o)+(r?"//# sourceMappingURL="+r:""),s=new Blob([i],{type:"application/javascript"});return URL.createObjectURL(s)}var ct,ut,dt,pt=function(e,t,n){var r;return function(a){return r=r||lt(e,t,n),new Worker(r,a)}}("Lyogcm9sbHVwLXBsdWdpbi13ZWItd29ya2VyLWxvYWRlciAqLwooZnVuY3Rpb24gKCkgewogICAgJ3VzZSBzdHJpY3QnOwoKICAgIC8qISAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKg0KICAgIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLg0KDQogICAgUGVybWlzc2lvbiB0byB1c2UsIGNvcHksIG1vZGlmeSwgYW5kL29yIGRpc3RyaWJ1dGUgdGhpcyBzb2Z0d2FyZSBmb3IgYW55DQogICAgcHVycG9zZSB3aXRoIG9yIHdpdGhvdXQgZmVlIGlzIGhlcmVieSBncmFudGVkLg0KDQogICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICJBUyBJUyIgQU5EIFRIRSBBVVRIT1IgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEgNCiAgICBSRUdBUkQgVE8gVEhJUyBTT0ZUV0FSRSBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCiAgICBBTkQgRklUTkVTUy4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUiBCRSBMSUFCTEUgRk9SIEFOWSBTUEVDSUFMLCBESVJFQ1QsDQogICAgSU5ESVJFQ1QsIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NDQogICAgTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1INCiAgICBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SDQogICAgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCiAgICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqLw0KDQogICAgZnVuY3Rpb24gX19hd2FpdGVyKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikgew0KICAgICAgICBmdW5jdGlvbiBhZG9wdCh2YWx1ZSkgeyByZXR1cm4gdmFsdWUgaW5zdGFuY2VvZiBQID8gdmFsdWUgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHZhbHVlKTsgfSk7IH0NCiAgICAgICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7DQogICAgICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvclsidGhyb3ciXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9DQogICAgICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IGFkb3B0KHJlc3VsdC52YWx1ZSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfQ0KICAgICAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpOw0KICAgICAgICB9KTsNCiAgICB9CgogICAgLyoKICAgICAqIGJhc2U2NC1hcnJheWJ1ZmZlciAxLjAuMSA8aHR0cHM6Ly9naXRodWIuY29tL25pa2xhc3ZoL2Jhc2U2NC1hcnJheWJ1ZmZlcj4KICAgICAqIENvcHlyaWdodCAoYykgMjAyMSBOaWtsYXMgdm9uIEhlcnR6ZW4gPGh0dHBzOi8vaGVydHplbi5jb20+CiAgICAgKiBSZWxlYXNlZCB1bmRlciBNSVQgTGljZW5zZQogICAgICovCiAgICB2YXIgY2hhcnMgPSAnQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODkrLyc7CiAgICAvLyBVc2UgYSBsb29rdXAgdGFibGUgdG8gZmluZCB0aGUgaW5kZXguCiAgICB2YXIgbG9va3VwID0gdHlwZW9mIFVpbnQ4QXJyYXkgPT09ICd1bmRlZmluZWQnID8gW10gOiBuZXcgVWludDhBcnJheSgyNTYpOwogICAgZm9yICh2YXIgaSA9IDA7IGkgPCBjaGFycy5sZW5ndGg7IGkrKykgewogICAgICAgIGxvb2t1cFtjaGFycy5jaGFyQ29kZUF0KGkpXSA9IGk7CiAgICB9CiAgICB2YXIgZW5jb2RlID0gZnVuY3Rpb24gKGFycmF5YnVmZmVyKSB7CiAgICAgICAgdmFyIGJ5dGVzID0gbmV3IFVpbnQ4QXJyYXkoYXJyYXlidWZmZXIpLCBpLCBsZW4gPSBieXRlcy5sZW5ndGgsIGJhc2U2NCA9ICcnOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkgKz0gMykgewogICAgICAgICAgICBiYXNlNjQgKz0gY2hhcnNbYnl0ZXNbaV0gPj4gMl07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1soKGJ5dGVzW2ldICYgMykgPDwgNCkgfCAoYnl0ZXNbaSArIDFdID4+IDQpXTsKICAgICAgICAgICAgYmFzZTY0ICs9IGNoYXJzWygoYnl0ZXNbaSArIDFdICYgMTUpIDw8IDIpIHwgKGJ5dGVzW2kgKyAyXSA+PiA2KV07CiAgICAgICAgICAgIGJhc2U2NCArPSBjaGFyc1tieXRlc1tpICsgMl0gJiA2M107CiAgICAgICAgfQogICAgICAgIGlmIChsZW4gJSAzID09PSAyKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDEpICsgJz0nOwogICAgICAgIH0KICAgICAgICBlbHNlIGlmIChsZW4gJSAzID09PSAxKSB7CiAgICAgICAgICAgIGJhc2U2NCA9IGJhc2U2NC5zdWJzdHJpbmcoMCwgYmFzZTY0Lmxlbmd0aCAtIDIpICsgJz09JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIGJhc2U2NDsKICAgIH07CgogICAgY29uc3QgbGFzdEJsb2JNYXAgPSBuZXcgTWFwKCk7DQogICAgY29uc3QgdHJhbnNwYXJlbnRCbG9iTWFwID0gbmV3IE1hcCgpOw0KICAgIGZ1bmN0aW9uIGdldFRyYW5zcGFyZW50QmxvYkZvcih3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucykgew0KICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkgew0KICAgICAgICAgICAgY29uc3QgaWQgPSBgJHt3aWR0aH0tJHtoZWlnaHR9YDsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgaWYgKHRyYW5zcGFyZW50QmxvYk1hcC5oYXMoaWQpKQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJhbnNwYXJlbnRCbG9iTWFwLmdldChpZCk7DQogICAgICAgICAgICAgICAgY29uc3Qgb2Zmc2NyZWVuID0gbmV3IE9mZnNjcmVlbkNhbnZhcyh3aWR0aCwgaGVpZ2h0KTsNCiAgICAgICAgICAgICAgICBvZmZzY3JlZW4uZ2V0Q29udGV4dCgnMmQnKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0geWllbGQgYmxvYi5hcnJheUJ1ZmZlcigpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGJhc2U2NCA9IGVuY29kZShhcnJheUJ1ZmZlcik7DQogICAgICAgICAgICAgICAgdHJhbnNwYXJlbnRCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICByZXR1cm4gYmFzZTY0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgcmV0dXJuICcnOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQogICAgY29uc3Qgd29ya2VyID0gc2VsZjsNCiAgICB3b3JrZXIub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHsNCiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHsNCiAgICAgICAgICAgIGlmICgnT2Zmc2NyZWVuQ2FudmFzJyBpbiBnbG9iYWxUaGlzKSB7DQogICAgICAgICAgICAgICAgY29uc3QgeyBpZCwgYml0bWFwLCB3aWR0aCwgaGVpZ2h0LCBkYXRhVVJMT3B0aW9ucyB9ID0gZS5kYXRhOw0KICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zcGFyZW50QmFzZTY0ID0gZ2V0VHJhbnNwYXJlbnRCbG9iRm9yKHdpZHRoLCBoZWlnaHQsIGRhdGFVUkxPcHRpb25zKTsNCiAgICAgICAgICAgICAgICBjb25zdCBvZmZzY3JlZW4gPSBuZXcgT2Zmc2NyZWVuQ2FudmFzKHdpZHRoLCBoZWlnaHQpOw0KICAgICAgICAgICAgICAgIGNvbnN0IGN0eCA9IG9mZnNjcmVlbi5nZXRDb250ZXh0KCcyZCcpOw0KICAgICAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2UoYml0bWFwLCAwLCAwKTsNCiAgICAgICAgICAgICAgICBiaXRtYXAuY2xvc2UoKTsNCiAgICAgICAgICAgICAgICBjb25zdCBibG9iID0geWllbGQgb2Zmc2NyZWVuLmNvbnZlcnRUb0Jsb2IoZGF0YVVSTE9wdGlvbnMpOw0KICAgICAgICAgICAgICAgIGNvbnN0IHR5cGUgPSBibG9iLnR5cGU7DQogICAgICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSB5aWVsZCBibG9iLmFycmF5QnVmZmVyKCk7DQogICAgICAgICAgICAgICAgY29uc3QgYmFzZTY0ID0gZW5jb2RlKGFycmF5QnVmZmVyKTsNCiAgICAgICAgICAgICAgICBpZiAoIWxhc3RCbG9iTWFwLmhhcyhpZCkgJiYgKHlpZWxkIHRyYW5zcGFyZW50QmFzZTY0KSA9PT0gYmFzZTY0KSB7DQogICAgICAgICAgICAgICAgICAgIGxhc3RCbG9iTWFwLnNldChpZCwgYmFzZTY0KTsNCiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHdvcmtlci5wb3N0TWVzc2FnZSh7IGlkIH0pOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICBpZiAobGFzdEJsb2JNYXAuZ2V0KGlkKSA9PT0gYmFzZTY0KQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQgfSk7DQogICAgICAgICAgICAgICAgd29ya2VyLnBvc3RNZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgaWQsDQogICAgICAgICAgICAgICAgICAgIHR5cGUsDQogICAgICAgICAgICAgICAgICAgIGJhc2U2NCwNCiAgICAgICAgICAgICAgICAgICAgd2lkdGgsDQogICAgICAgICAgICAgICAgICAgIGhlaWdodCwNCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICBsYXN0QmxvYk1hcC5zZXQoaWQsIGJhc2U2NCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICByZXR1cm4gd29ya2VyLnBvc3RNZXNzYWdlKHsgaWQ6IGUuZGF0YS5pZCB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgfTsKCn0pKCk7Cgo=",null,!1),ht=function(){function e(t){var n=this;(0,s.Z)(this,e),this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=function(e,t){!(n.rafStamps.invokeId&&n.rafStamps.latestId!==n.rafStamps.invokeId)&&n.rafStamps.invokeId||(n.rafStamps.invokeId=n.rafStamps.latestId),n.pendingCanvasMutations.has(e)||n.pendingCanvasMutations.set(e,[]),n.pendingCanvasMutations.get(e).push(t)};var r=t.sampling,a=void 0===r?"all":r,o=t.win,i=t.blockClass,l=t.blockSelector,c=t.recordCanvas,u=t.dataURLOptions;this.mutationCb=t.mutationCb,this.mirror=t.mirror,c&&"all"===a&&this.initCanvasMutationObserver(o,i,l),c&&"number"===typeof a&&this.initCanvasFPSObserver(a,o,i,l,{dataURLOptions:u})}return(0,l.Z)(e,[{key:"reset",value:function(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}},{key:"freeze",value:function(){this.frozen=!0}},{key:"unfreeze",value:function(){this.frozen=!1}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"initCanvasFPSObserver",value:function(e,t,n,r,a){var o=this,i=it(t,n,r,!0),s=new Map,l=new pt;l.onmessage=function(e){var t=e.data.id;if(s.set(t,!1),"base64"in e.data){var n=e.data,r=n.base64,a=n.type,i=n.width,l=n.height;o.mutationCb({id:t,type:Ie["2D"],commands:[{property:"clearRect",args:[0,0,i,l]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:r}],type:a}]},0,0]}]})}};var c,u=1e3/e,d=0;c=requestAnimationFrame((function e(i){d&&i-d<u||(d=i,function(){var e=[];return t.document.querySelectorAll("canvas").forEach((function(t){ae(t,n,r,!0)||e.push(t)})),e}().forEach((function(e){return Xe(o,void 0,void 0,(0,je.Z)().mark((function t(){var n,r,o,i;return(0,je.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=this.mirror.getId(e),!s.get(r)){t.next=3;break}return t.abrupt("return");case 3:return s.set(r,!0),["webgl","webgl2"].includes(e.__context)&&(o=e.getContext(e.__context),!1===(null===(n=null===o||void 0===o?void 0:o.getContextAttributes())||void 0===n?void 0:n.preserveDrawingBuffer)&&o.clear(o.COLOR_BUFFER_BIT)),t.next=7,createImageBitmap(e);case 7:i=t.sent,l.postMessage({id:r,bitmap:i,width:e.width,height:e.height,dataURLOptions:a.dataURLOptions},[i]);case 9:case"end":return t.stop()}}),t,this)})))}))),c=requestAnimationFrame(e)})),this.resetObservers=function(){i(),cancelAnimationFrame(c)}}},{key:"initCanvasMutationObserver",value:function(e,t,n){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();var r=it(e,t,n,!1),a=function(e,t,n,r){var a,o=[],i=Object.getOwnPropertyNames(t.CanvasRenderingContext2D.prototype),s=(0,p.Z)(i);try{var l=function(){var i=a.value;try{if("function"!==typeof t.CanvasRenderingContext2D.prototype[i])return 1;var s=$(t.CanvasRenderingContext2D.prototype,i,(function(a){return function(){for(var o=this,s=arguments.length,l=new Array(s),c=0;c<s;c++)l[c]=arguments[c];return ae(this.canvas,n,r,!0)||setTimeout((function(){var n=at([].concat(l),t,o);e(o.canvas,{type:Ie["2D"],property:i,args:n})}),0),a.apply(this,l)}}));o.push(s)}catch(c){var l=q(t.CanvasRenderingContext2D.prototype,i,{set:function(t){e(this.canvas,{type:Ie["2D"],property:i,args:[t],setter:!0})}});o.push(l)}};for(s.s();!(a=s.n()).done;)l()}catch(c){s.e(c)}finally{s.f()}return function(){o.forEach((function(e){return e()}))}}(this.processMutation.bind(this),e,t,n),i=function(e,t,n,r,a){var i=[];return i.push.apply(i,(0,o.Z)(st(t.WebGLRenderingContext.prototype,Ie.WebGL,e,n,r,0,t))),"undefined"!==typeof t.WebGL2RenderingContext&&i.push.apply(i,(0,o.Z)(st(t.WebGL2RenderingContext.prototype,Ie.WebGL2,e,n,r,0,t))),function(){i.forEach((function(e){return e()}))}}(this.processMutation.bind(this),e,t,n,this.mirror);this.resetObservers=function(){r(),a(),i()}}},{key:"startPendingCanvasMutationFlusher",value:function(){var e=this;requestAnimationFrame((function(){return e.flushPendingCanvasMutations()}))}},{key:"startRAFTimestamping",value:function(){var e=this;requestAnimationFrame((function t(n){e.rafStamps.latestId=n,requestAnimationFrame(t)}))}},{key:"flushPendingCanvasMutations",value:function(){var e=this;this.pendingCanvasMutations.forEach((function(t,n){var r=e.mirror.getId(n);e.flushPendingCanvasMutationFor(n,r)})),requestAnimationFrame((function(){return e.flushPendingCanvasMutations()}))}},{key:"flushPendingCanvasMutationFor",value:function(e,t){if(!this.frozen&&!this.locked){var n=this.pendingCanvasMutations.get(e);if(n&&-1!==t){var r=n.map((function(e){var t=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(n[r[a]]=e[r[a]])}return n}(e,["type"]);return t})),a=n[0].type;this.mutationCb({id:t,type:a,commands:r}),this.pendingCanvasMutations.delete(e)}}}}]),e}(),gt=function(){function e(t){(0,s.Z)(this,e),this.trackedLinkElements=new WeakSet,this.styleMirror=new de,this.mutationCb=t.mutationCb,this.adoptedStyleSheetCb=t.adoptedStyleSheetCb}return(0,l.Z)(e,[{key:"attachLinkElement",value:function(e,t){"_cssText"in t.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:t.id,attributes:t.attributes}]}),this.trackLinkElement(e)}},{key:"trackLinkElement",value:function(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}},{key:"adoptStyleSheets",value:function(e,t){if(0!==e.length){var n,r={id:t,styleIds:[]},a=[],o=(0,p.Z)(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,s=void 0;if(this.styleMirror.has(i))s=this.styleMirror.getId(i);else{s=this.styleMirror.add(i);var l=Array.from(i.rules||CSSRule);a.push({styleId:s,rules:l.map((function(e,t){return{rule:v(e),index:t}}))})}r.styleIds.push(s)}}catch(c){o.e(c)}finally{o.f()}a.length>0&&(r.styles=a),this.adoptedStyleSheetCb(r)}}},{key:"reset",value:function(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}},{key:"trackStylesheetInLinkElement",value:function(e){}}]),e}(),ft=function(){function e(){(0,s.Z)(this,e),this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}return(0,l.Z)(e,[{key:"periodicallyClear",value:function(){var e=this;requestAnimationFrame((function(){e.clear(),e.loop&&e.periodicallyClear()}))}},{key:"inOtherBuffer",value:function(e,t){var n=this.nodeMap.get(e);return n&&Array.from(n).some((function(e){return e!==t}))}},{key:"add",value:function(e,t){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(t))}},{key:"clear",value:function(){this.nodeMap=new WeakMap}},{key:"destroy",value:function(){this.loop=!1}}]),e}();function mt(e){return Object.assign(Object.assign({},e),{timestamp:ee()})}var vt=!1,yt=new y;function It(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.emit,n=e.checkoutEveryNms,r=e.checkoutEveryNth,a=e.blockClass,o=void 0===a?"rr-block":a,i=e.blockSelector,s=void 0===i?null:i,l=e.ignoreClass,c=void 0===l?"rr-ignore":l,u=e.ignoreSelector,d=void 0===u?null:u,h=e.maskTextClass,g=void 0===h?"rr-mask":h,f=e.maskTextSelector,m=void 0===f?null:f,v=e.inlineStylesheet,I=void 0===v||v,C=e.maskAllInputs,S=e.maskInputOptions,b=e.slimDOMOptions,A=e.maskInputFn,k=e.maskTextFn,w=e.hooks,M=e.packFn,T=e.sampling,R=void 0===T?{}:T,Z=e.dataURLOptions,N=void 0===Z?{}:Z,E=e.mousemoveWait,O=e.recordCanvas,x=void 0!==O&&O,F=e.recordCrossOriginIframes,D=void 0!==F&&F,L=e.recordAfter,B=void 0===L?"DOMContentLoaded"===e.recordAfter?e.recordAfter:"load":L,W=e.userTriggeredOnInput,V=void 0!==W&&W,G=e.collectFonts,K=void 0!==G&&G,U=e.inlineImages,_=void 0!==U&&U,Y=e.plugins,J=e.keepIframeSrcFn,P=void 0===J?function(){return!1}:J,H=e.ignoreCSSAttributes,j=void 0===H?new Set([]):H;Ne(e.errorHandler);var X=!D||window.parent===window,q=!1;if(!X)try{window.parent.document&&(q=!1)}catch(we){q=!0}if(X&&!t)throw new Error("emit function is required");void 0!==E&&void 0===R.mousemove&&(R.mousemove=E),yt.reset();var $,ee=!0===C?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:void 0!==S?S:{password:!0},ae=!0===b||"all"===b?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:"all"===b,headMetaDescKeywords:"all"===b}:b||{};!function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window;"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=n[0];if(!(0 in n))throw new TypeError("1 argument is required");do{if(e===a)return!0}while(a=a&&a.parentNode);return!1})}();var oe=0,ie=function(e){var t,n=(0,p.Z)(Y||[]);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.eventProcessor&&(e=r.eventProcessor(e))}}catch(a){n.e(a)}finally{n.f()}return M&&!q&&(e=M(e)),e};ct=function(e,a){var o;if(!(null===(o=xe[0])||void 0===o?void 0:o.isFrozen())||e.type===fe.FullSnapshot||e.type===fe.IncrementalSnapshot&&e.data.source===me.Mutation||xe.forEach((function(e){return e.unfreeze()})),X)null===t||void 0===t||t(ie(e),a);else if(q){var i={type:"rrweb",event:ie(e),origin:window.location.origin,isCheckout:a};window.parent.postMessage(i,"*")}if(e.type===fe.FullSnapshot)$=e,oe=0;else if(e.type===fe.IncrementalSnapshot){if(e.data.source===me.Mutation&&e.data.isAttachIframe)return;oe++;var s=r&&oe>=r,l=n&&e.timestamp-$.timestamp>n;(s||l)&&ut(!0)}};var se,de=function(e){ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.Mutation},e)}))},pe=function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.Scroll},e)}))},he=function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.CanvasMutation},e)}))},ge=new gt({mutationCb:de,adoptedStyleSheetCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.AdoptedStyleSheet},e)}))}}),ve=new Qe({mirror:yt,mutationCb:de,stylesheetManager:ge,recordCrossOriginIframes:D,wrappedEmit:ct}),ye=(0,p.Z)(Y||[]);try{for(ye.s();!(se=ye.n()).done;){var Ie=se.value;Ie.getMirror&&Ie.getMirror({nodeMirror:yt,crossOriginIframeMirror:ve.crossOriginIframeMirror,crossOriginIframeStyleMirror:ve.crossOriginIframeStyleMirror})}}catch(Me){ye.e(Me)}finally{ye.f()}var Ce=new ft;dt=new ht({recordCanvas:x,mutationCb:he,win:window,blockClass:o,blockSelector:s,mirror:yt,sampling:R.canvas,dataURLOptions:N});var Se=new He({mutationCb:de,scrollCb:pe,bypassOptions:{blockClass:o,blockSelector:s,maskTextClass:g,maskTextSelector:m,inlineStylesheet:I,maskInputOptions:ee,dataURLOptions:N,maskTextFn:k,maskInputFn:A,recordCanvas:x,inlineImages:_,sampling:R,slimDOMOptions:ae,iframeManager:ve,stylesheetManager:ge,canvasManager:dt,keepIframeSrcFn:P,processedNodeManager:Ce},mirror:yt});ut=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];ct(mt({type:fe.Meta,data:{href:window.location.href,width:re(),height:ne()}}),e),ge.reset(),Se.init(),xe.forEach((function(e){return e.lock()}));var t=function(e,t){var n=t||{},r=n.mirror,a=void 0===r?new y:r,o=n.blockClass,i=void 0===o?"rr-block":o,s=n.blockSelector,l=void 0===s?null:s,c=n.maskTextClass,u=void 0===c?"rr-mask":c,d=n.maskTextSelector,p=void 0===d?null:d,h=n.inlineStylesheet,g=void 0===h||h,f=n.inlineImages,m=void 0!==f&&f,v=n.recordCanvas,I=void 0!==v&&v,C=n.maskAllInputs,S=void 0!==C&&C,b=n.maskTextFn,A=n.maskInputFn,k=n.slimDOM,w=void 0!==k&&k,M=n.dataURLOptions,T=n.preserveWhiteSpace,R=n.onSerialize,Z=n.onIframeLoad,N=n.iframeLoadTimeout,E=n.onStylesheetLoad,O=n.stylesheetLoadTimeout,x=n.keepIframeSrcFn;return z(e,{doc:e,mirror:a,blockClass:i,blockSelector:l,maskTextClass:u,maskTextSelector:p,skipChild:!1,inlineStylesheet:g,maskInputOptions:!0===S?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:!1===S?{password:!0}:S,maskTextFn:b,maskInputFn:A,slimDOMOptions:!0===w||"all"===w?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:"all"===w,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:!1===w?{}:w,dataURLOptions:M,inlineImages:m,recordCanvas:I,preserveWhiteSpace:T,onSerialize:R,onIframeLoad:Z,iframeLoadTimeout:N,onStylesheetLoad:E,stylesheetLoadTimeout:O,keepIframeSrcFn:void 0===x?function(){return!1}:x,newlyAddedElement:!1})}(document,{mirror:yt,blockClass:o,blockSelector:s,maskTextClass:g,maskTextSelector:m,inlineStylesheet:I,maskAllInputs:ee,maskTextFn:k,slimDOM:ae,dataURLOptions:N,recordCanvas:x,inlineImages:_,onSerialize:function(e){le(e,yt)&&ve.addIframe(e),ce(e,yt)&&ge.trackLinkElement(e),ue(e)&&Se.addShadowRoot(e.shadowRoot,document)},onIframeLoad:function(e,t){ve.attachIframe(e,t),Se.observeAttachShadow(e)},onStylesheetLoad:function(e,t){ge.attachLinkElement(e,t)},keepIframeSrcFn:P});if(!t)return console.warn("Failed to snapshot the document");ct(mt({type:fe.FullSnapshot,data:{node:t,initialOffset:te(window)}}),e),xe.forEach((function(e){return e.unlock()})),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&ge.adoptStyleSheets(document.adoptedStyleSheets,yt.getId(document))};try{var be=[],Ae=function(e){var t;return Oe(Ye)({mutationCb:de,mousemoveCb:function(e,t){return ct(mt({type:fe.IncrementalSnapshot,data:{source:t,positions:e}}))},mouseInteractionCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.MouseInteraction},e)}))},scrollCb:pe,viewportResizeCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.ViewportResize},e)}))},inputCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.Input},e)}))},mediaInteractionCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.MediaInteraction},e)}))},styleSheetRuleCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.StyleSheetRule},e)}))},styleDeclarationCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.StyleDeclaration},e)}))},canvasMutationCb:he,fontCb:function(e){return ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.Font},e)}))},selectionCb:function(e){ct(mt({type:fe.IncrementalSnapshot,data:Object.assign({source:me.Selection},e)}))},blockClass:o,ignoreClass:c,ignoreSelector:d,maskTextClass:g,maskTextSelector:m,maskInputOptions:ee,inlineStylesheet:I,sampling:R,recordCanvas:x,inlineImages:_,userTriggeredOnInput:V,collectFonts:K,doc:e,maskInputFn:A,maskTextFn:k,keepIframeSrcFn:P,blockSelector:s,slimDOMOptions:ae,dataURLOptions:N,mirror:yt,iframeManager:ve,stylesheetManager:ge,shadowDomManager:Se,processedNodeManager:Ce,canvasManager:dt,ignoreCSSAttributes:j,plugins:(null===(t=null===Y||void 0===Y?void 0:Y.filter((function(e){return e.observer})))||void 0===t?void 0:t.map((function(e){return{observer:e.observer,options:e.options,callback:function(t){return ct(mt({type:fe.Plugin,data:{plugin:e.name,payload:t}}))}}})))||[]},w)};ve.addLoadListener((function(e){try{be.push(Ae(e.contentDocument))}catch(t){console.warn(t)}}));var ke=function(){ut(),be.push(Ae(document)),vt=!0};return"interactive"===document.readyState||"complete"===document.readyState?ke():(be.push(Q("DOMContentLoaded",(function(){ct(mt({type:fe.DomContentLoaded,data:{}})),"DOMContentLoaded"===B&&ke()}))),be.push(Q("load",(function(){ct(mt({type:fe.Load,data:{}})),"load"===B&&ke()}),window))),function(){be.forEach((function(e){return e()})),Ce.destroy(),vt=!1,Ee()}}catch(Te){console.warn(Te)}}It.addCustomEvent=function(e,t){if(!vt)throw new Error("please add custom event after start recording");ct(mt({type:fe.Custom,data:{tag:e,payload:t}}))},It.freezePage=function(){xe.forEach((function(e){return e.freeze()}))},It.takeFullSnapshot=function(e){if(!vt)throw new Error("please take full snapshot after start recording");ut(e)},It.mirror=yt;var Ct=n(17610),St=n(90830),bt=n(19435),At=function(){function e(t){(0,s.Z)(this,e);var n=t.canCorrectTimestamps;this.events=[],this.cycleTimestamp=Date.now(),this.canCorrectTimestamps=!!n,this.payloadBytesEstimation=0,this.hasSnapshot=!1,this.hasMeta=!1,this.hasError=!1,this.inlinedAllStylesheets=!0}return(0,l.Z)(e,[{key:"add",value:function(e){this.events.push(e)}}]),e}(),kt=n(73198),wt=n(98097),Mt=n(38450),Tt=n(12088),Rt=n(30733),Zt=["__serialized","timestamp"],Nt=new WeakMap,Et=new WeakMap,Ot=new WeakMap,xt=new WeakMap,Ft=function(){function e(t){var n,r,a;(0,s.Z)(this,e),(0,c.Z)(this,Nt,{writable:!0,value:void 0}),(0,c.Z)(this,Et,{writable:!0,value:void 0}),(0,c.Z)(this,Ot,{writable:!0,value:void 0}),(0,c.Z)(this,xt,{writable:!0,value:!1}),(0,d.Z)(this,Nt,new At({canCorrectTimestamps:!(null===(n=t.timeKeeper)||void 0===n||!n.ready)})),(0,d.Z)(this,Et,new At({canCorrectTimestamps:!(null===(r=t.timeKeeper)||void 0===r||!r.ready)})),(0,d.Z)(this,Ot,[new At({canCorrectTimestamps:!(null===(a=t.timeKeeper)||void 0===a||!a.ready)})]),this.recording=!1,this.currentBufferTarget=(0,u.Z)(this,Nt),this.lastMeta=!1,this.parent=t,this.shouldInlineStylesheets=(0,bt.Mt)(this.parent.agentIdentifier,"session_replay.inline_stylesheet"),this.shouldFix=this.shouldInlineStylesheets,this.stopRecording=function(){}}return(0,l.Z)(e,[{key:"getEvents",value:function(){var e;if(null!==(e=(0,u.Z)(this,Ot)[0])&&void 0!==e&&e.events.length){var t=this.returnCorrectTimestamps((0,u.Z)(this,Ot)[0]);return(0,i.Z)((0,i.Z)({},(0,u.Z)(this,Ot)[0]),{},{events:t,type:"preloaded"})}var n=this.returnCorrectTimestamps((0,u.Z)(this,Et)),r=this.returnCorrectTimestamps((0,u.Z)(this,Nt));return{events:[].concat((0,o.Z)(n),(0,o.Z)(r)).filter((function(e){return e})),type:"standard",cycleTimestamp:Math.min((0,u.Z)(this,Et).cycleTimestamp,(0,u.Z)(this,Nt).cycleTimestamp),payloadBytesEstimation:(0,u.Z)(this,Et).payloadBytesEstimation+(0,u.Z)(this,Nt).payloadBytesEstimation,hasError:(0,u.Z)(this,Et).hasError||(0,u.Z)(this,Nt).hasError,hasMeta:(0,u.Z)(this,Et).hasMeta||(0,u.Z)(this,Nt).hasMeta,hasSnapshot:(0,u.Z)(this,Et).hasSnapshot||(0,u.Z)(this,Nt).hasSnapshot,inlinedAllStylesheets:!!(0,u.Z)(this,Et).events.length&&(0,u.Z)(this,Et).inlinedAllStylesheets||(0,u.Z)(this,Nt).inlinedAllStylesheets}}},{key:"returnCorrectTimestamps",value:function(e){var t,n=this;return null!==(t=this.parent.timeKeeper)&&void 0!==t&&t.ready?e.canCorrectTimestamps?e.events:e.events.map((function(e){e.__serialized;var t=e.timestamp,r=(0,a.Z)(e,Zt);return(0,i.Z)({timestamp:n.parent.timeKeeper.correctAbsoluteTimestamp(t)},r)})):e.events}},{key:"clearBuffer",value:function(){var e,t,n;null!==(e=(0,u.Z)(this,Ot)[0])&&void 0!==e&&e.events.length?(0,u.Z)(this,Ot).shift():this.parent.mode===kt.IK.ERROR?(0,d.Z)(this,Et,(0,u.Z)(this,Nt)):(0,d.Z)(this,Et,new At({canCorrectTimestamps:!(null===(t=this.parent.timeKeeper)||void 0===t||!t.ready)})),(0,d.Z)(this,Nt,new At({canCorrectTimestamps:!(null===(n=this.parent.timeKeeper)||void 0===n||!n.ready)}))}},{key:"startRecording",value:function(){var e=this;this.recording=!0;var t=(0,bt.Mt)(this.parent.agentIdentifier,"session_replay"),n=t.block_class,r=t.ignore_class,a=t.mask_text_class,o=t.block_selector,i=t.mask_input_options,s=t.mask_text_selector,l=t.mask_all_inputs,c=t.inline_stylesheet,u=t.inline_images,d=t.collect_fonts,p=It({emit:this.audit.bind(this),blockClass:n,ignoreClass:r,maskTextClass:a,blockSelector:o,maskInputOptions:i,maskTextSelector:s,maskAllInputs:l,inlineStylesheet:c,inlineImages:u,collectFonts:d,checkoutEveryNms:St.u0[this.parent.mode]});this.stopRecording=function(){e.recording=!1,p()}}},{key:"audit",value:function(e,t){var n=this;if(!1===this.shouldInlineStylesheets||!this.shouldFix)return this.currentBufferTarget.inlinedAllStylesheets=!1,this.store(e,t);var r=wt.j.evaluate();!r&&(0,u.Z)(this,xt)&&e.type===St.i9.Meta&&(0,d.Z)(this,xt,!1),r>0&&(wt.j.fix().then((function(e){e>0&&(n.currentBufferTarget.inlinedAllStylesheets=!1,n.shouldFix=!1),(0,Mt.p)(Tt.xS,["SessionReplay/Payload/Missing-Inline-Css/Failed",e],void 0,Rt.D.metrics,n.parent.ee),(0,Mt.p)(Tt.xS,["SessionReplay/Payload/Missing-Inline-Css/Fixed",r-e],void 0,Rt.D.metrics,n.parent.ee),n.takeFullSnapshot()})),e.type!==St.i9.FullSnapshot&&e.type!==St.i9.Meta||(0,d.Z)(this,xt,!0)),(0,u.Z)(this,xt)||this.store(e,t)}},{key:"store",value:function(e,t){if(e&&(!this.parent.scheduler&&(0,u.Z)(this,Ot).length?this.currentBufferTarget=(0,u.Z)(this,Ot)[(0,u.Z)(this,Ot).length-1]:this.currentBufferTarget=(0,u.Z)(this,Nt),!this.parent.blocked)){this.currentBufferTarget.canCorrectTimestamps&&(e.timestamp=this.parent.timeKeeper.correctAbsoluteTimestamp(e.timestamp)),e.__serialized=(0,Ct.P)(e);var n,r=e.__serialized.length,a=this.getPayloadSize(r);if(this.parent.mode===kt.IK.ERROR&&t&&e.type===St.i9.Meta&&this.clearBuffer(),e.type===St.i9.Meta&&(this.currentBufferTarget.hasMeta=!0),e.type===St.i9.FullSnapshot&&(this.currentBufferTarget.hasSnapshot=!0),this.currentBufferTarget.add(e),this.currentBufferTarget.payloadBytesEstimation+=r,a>St.fm&&this.parent.mode!==kt.IK.ERROR)if(this.parent.scheduler)this.parent.scheduler.runHarvest();else(0,u.Z)(this,Ot).push(new At({canCorrectTimestamps:!(null===(n=this.parent.timeKeeper)||void 0===n||!n.ready)}))}}},{key:"takeFullSnapshot",value:function(){try{if(!this.recording)return;It.takeFullSnapshot()}catch(e){}}},{key:"clearTimestamps",value:function(){this.currentBufferTarget.cycleTimestamp=void 0}},{key:"getPayloadSize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.estimateCompression(this.currentBufferTarget.payloadBytesEstimation+e)+St.J0}},{key:"estimateCompression",value:function(e){return this.parent.gzipper&&this.parent.u8?e*St.Vb:e}}]),e}()},98097:function(e,t,n){n.d(t,{j:function(){return S}});var r=n(74165),a=n(15861),o=n(15671),i=n(43144),s=n(40101),l=n(4942),c=n(72346),u=n(13092),d=n(43889),p=n(86033),h=n(19435),g=n(63711),f=new WeakMap,m=new WeakMap,v=new WeakSet,y=function(){function e(){(0,o.Z)(this,e),(0,s.Z)(this,v),(0,c.Z)(this,f,{writable:!0,value:new WeakSet}),(0,c.Z)(this,m,{writable:!0,value:[]}),(0,l.Z)(this,"invalidStylesheetsDetected",!1),(0,l.Z)(this,"failedToFix",0)}return(0,i.Z)(e,[{key:"evaluate",value:function(){var e=0;if(g.il)for(var t=0;t<Object.keys(document.styleSheets).length;t++)if(!(0,p.Z)(this,f).has(document.styleSheets[t])){(0,p.Z)(this,f).add(document.styleSheets[t]);try{document.styleSheets[t].cssRules}catch(n){if(!document.styleSheets[t].href)return;e++,(0,p.Z)(this,m).push((0,d.Z)(this,v,I).call(this,document.styleSheets[t]))}}return e&&(this.invalidStylesheetsDetected=!0),e}},{key:"fix",value:function(){var e=(0,a.Z)((0,r.Z)().mark((function e(){var t;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all((0,p.Z)(this,m));case 2:return(0,u.Z)(this,m,[]),t=this.failedToFix,this.failedToFix=0,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();function I(e){return C.apply(this,arguments)}function C(){return(C=(0,a.Z)((0,r.Z)().mark((function e(t){var n,a,o;return(0,r.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==t&&void 0!==t&&t.href){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,e.next=5,h.Yu.FETCH.bind(window)(t.href);case 5:if((n=e.sent).ok){e.next=9;break}return this.failedToFix++,e.abrupt("return");case 9:return e.next=11,n.text();case 11:return a=e.sent,e.prev=12,o=new CSSStyleSheet,e.next=16,o.replace(a);case 16:Object.defineProperty(t,"cssRules",{get:function(){return o.cssRules}}),Object.defineProperty(t,"rules",{get:function(){return o.rules}}),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(12),Object.defineProperty(t,"cssText",{get:function(){return a}}),this.failedToFix++;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(2),this.failedToFix++;case 29:case"end":return e.stop()}}),e,this,[[2,26],[12,20]])})))).apply(this,arguments)}var S=new y}}]);
//# sourceMappingURL=recorder.da8f1d9a.chunk.js.map