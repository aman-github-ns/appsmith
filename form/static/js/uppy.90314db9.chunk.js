(self.webpackChunkappsmith=self.webpackChunkappsmith||[]).push([[4875],{84595:function(e){"use strict";function t(e){var o="function"===typeof Map?new Map:void 0;return t=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof o){if(o.has(e))return o.get(e);o.set(e,s)}function s(){return i(e,arguments,r(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),n(s,e)},t(e)}function i(e,t,r){return i=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return i&&n(o,i.prototype),o},i.apply(null,arguments)}function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}var o=function(e){var t,i;function n(){var t;return(t=e.call(this,"Authorization required")||this).name="AuthError",t.isAuthError=!0,t}return i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n}(t(Error));e.exports=o},51134:function(e,t,i){"use strict";function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}var r=i(38284),o=i(54452),s=i(99075);e.exports=function(e){var t,i;function o(t,i){var n;return(n=e.call(this,t,i)||this).provider=i.provider,n.id=n.provider,n.name=n.opts.name||n.id.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "),n.pluginId=n.opts.pluginId,n.tokenKey="companion-"+n.pluginId+"-auth-token",n.companionKeysParams=n.opts.companionKeysParams,n.preAuthToken=null,n}i=e,(t=o).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var a=o.prototype;return a.headers=function(){var t=this;return Promise.all([e.prototype.headers.call(this),this.getAuthToken()]).then((function(e){var i=e[0],r=e[1],o={};return r&&(o["uppy-auth-token"]=r),t.companionKeysParams&&(o["uppy-credentials-params"]=btoa(JSON.stringify({params:t.companionKeysParams}))),n({},i,o)}))},a.onReceiveResponse=function(t){t=e.prototype.onReceiveResponse.call(this,t);var i=this.uppy.getPlugin(this.pluginId),n=i.getPluginState().authenticated?401!==t.status:t.status<400;return i.setPluginState({authenticated:n}),t},a.setAuthToken=function(e){return this.uppy.getPlugin(this.pluginId).storage.setItem(this.tokenKey,e)},a.getAuthToken=function(){return this.uppy.getPlugin(this.pluginId).storage.getItem(this.tokenKey)},a.authUrl=function(e){void 0===e&&(e={}),this.preAuthToken&&(e.uppyPreAuthToken=this.preAuthToken);var t=r(e);return t=t?"?"+t:t,this.hostname+"/"+this.id+"/connect"+t},a.fileUrl=function(e){return this.hostname+"/"+this.id+"/get/"+e},a.fetchPreAuthToken=function(){var e=this;return this.companionKeysParams?this.post(this.id+"/preauth/",{params:this.companionKeysParams}).then((function(t){e.preAuthToken=t.token})).catch((function(t){e.uppy.log("[CompanionClient] unable to fetch preAuthToken "+t,"warning")})):Promise.resolve()},a.list=function(e){return this.get(this.id+"/list/"+(e||""))},a.logout=function(){var e=this;return this.get(this.id+"/logout").then((function(t){return Promise.all([t,e.uppy.getPlugin(e.pluginId).storage.removeItem(e.tokenKey)])})).then((function(e){return e[0]}))},o.initPlugin=function(e,t,i){if(e.type="acquirer",e.files=[],i&&(e.opts=n({},i,t)),t.serverUrl||t.serverPattern)throw new Error("`serverUrl` and `serverPattern` have been renamed to `companionUrl` and `companionAllowedHosts` respectively in the 0.30.5 release. Please consult the docs (for example, https://uppy.io/docs/instagram/ for the Instagram plugin) and use the updated options.`");if(t.companionAllowedHosts){var r=t.companionAllowedHosts;if("string"!==typeof r&&!Array.isArray(r)&&!(r instanceof RegExp))throw new TypeError(e.id+': the option "companionAllowedHosts" must be one of string, Array, RegExp');e.opts.companionAllowedHosts=r}else/^(?!https?:\/\/).*$/i.test(t.companionUrl)?e.opts.companionAllowedHosts="https://"+t.companionUrl.replace(/^\/\//,""):e.opts.companionAllowedHosts=t.companionUrl;e.storage=e.opts.storage||s},o}(o)},54452:function(e,t,i){"use strict";var n,r;function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o.apply(this,arguments)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=i(84595),c=i(60781);e.exports=(r=n=function(){function e(e,t){this.uppy=e,this.opts=t,this.onReceiveResponse=this.onReceiveResponse.bind(this),this.allowedHeaders=["accept","content-type","uppy-auth-token"],this.preflightDone=!1}var t,i,n,r=e.prototype;return r.headers=function(){var e=this.opts.companionHeaders||this.opts.serverHeaders||{};return Promise.resolve(o({},this.defaultHeaders,e))},r._getPostResponseFunc=function(e){var t=this;return function(i){return e?i:t.onReceiveResponse(i)}},r.onReceiveResponse=function(e){var t,i=this.uppy.getState().companion||{},n=this.opts.companionUrl,r=e.headers;r.has("i-am")&&r.get("i-am")!==i[n]&&this.uppy.setState({companion:o({},i,(t={},t[n]=r.get("i-am"),t))});return e},r._getUrl=function(e){return/^(https?:|)\/\//.test(e)?e:this.hostname+"/"+e},r._json=function(e){if(401===e.status)throw new a;if(e.status<200||e.status>300){var t="Failed request with status: "+e.status+". "+e.statusText;return e.json().then((function(e){throw t=e.message?t+" message: "+e.message:t,t=e.requestId?t+" request-Id: "+e.requestId:t,new Error(t)})).catch((function(){throw new Error(t)}))}return e.json()},r.preflight=function(e){var t=this;return this.preflightDone?Promise.resolve(this.allowedHeaders.slice()):fetch(this._getUrl(e),{method:"OPTIONS"}).then((function(e){return e.headers.has("access-control-allow-headers")&&(t.allowedHeaders=e.headers.get("access-control-allow-headers").split(",").map((function(e){return e.trim().toLowerCase()}))),t.preflightDone=!0,t.allowedHeaders.slice()})).catch((function(e){return t.uppy.log("[CompanionClient] unable to make preflight request "+e,"warning"),t.preflightDone=!0,t.allowedHeaders.slice()}))},r.preflightAndHeaders=function(e){var t=this;return Promise.all([this.preflight(e),this.headers()]).then((function(e){var i=e[0],n=e[1];return Object.keys(n).forEach((function(e){-1===i.indexOf(e.toLowerCase())&&(t.uppy.log("[CompanionClient] excluding unallowed header "+e),delete n[e])})),n}))},r.get=function(e,t){var i=this;return this.preflightAndHeaders(e).then((function(t){return c(i._getUrl(e),{method:"get",headers:t,credentials:i.opts.companionCookiesRule||"same-origin"})})).then(this._getPostResponseFunc(t)).then((function(e){return i._json(e)})).catch((function(t){return t=t.isAuthError?t:new Error("Could not get "+i._getUrl(e)+". "+t),Promise.reject(t)}))},r.post=function(e,t,i){var n=this;return this.preflightAndHeaders(e).then((function(i){return c(n._getUrl(e),{method:"post",headers:i,credentials:n.opts.companionCookiesRule||"same-origin",body:JSON.stringify(t)})})).then(this._getPostResponseFunc(i)).then((function(e){return n._json(e)})).catch((function(t){return t=t.isAuthError?t:new Error("Could not post "+n._getUrl(e)+". "+t),Promise.reject(t)}))},r.delete=function(e,t,i){var n=this;return this.preflightAndHeaders(e).then((function(i){return c(n.hostname+"/"+e,{method:"delete",headers:i,credentials:n.opts.companionCookiesRule||"same-origin",body:t?JSON.stringify(t):null})})).then(this._getPostResponseFunc(i)).then((function(e){return n._json(e)})).catch((function(t){return t=t.isAuthError?t:new Error("Could not delete "+n._getUrl(e)+". "+t),Promise.reject(t)}))},t=e,(i=[{key:"hostname",get:function(){var e=this.uppy.getState().companion,t=this.opts.companionUrl;return(e&&e[t]?e[t]:t).replace(/\/$/,"")}},{key:"defaultHeaders",get:function(){return{Accept:"application/json","Content-Type":"application/json","Uppy-Versions":"@uppy/companion-client="+e.VERSION}}}])&&s(t.prototype,i),n&&s(t,n),e}(),n.VERSION="1.8.1",r)},63542:function(e,t,i){"use strict";var n=i(54452);e.exports=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,i)||this).provider=i.provider,n.id=n.provider,n.name=n.opts.name||n.id.split("-").map((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})).join(" "),n.pluginId=n.opts.pluginId,n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.fileUrl=function(e){return this.hostname+"/search/"+this.id+"/get/"+e},r.search=function(e,t){return t=t?"&"+t:"",this.get("search/"+this.id+"/list?q="+encodeURIComponent(e)+t)},n}(n)},1207:function(e,t,i){var n=i(41695);e.exports=function(){function e(e){this.opts=e,this._queued=[],this.isOpen=!1,this.emitter=n(),this._handleMessage=this._handleMessage.bind(this),this.close=this.close.bind(this),this.emit=this.emit.bind(this),this.on=this.on.bind(this),this.once=this.once.bind(this),this.send=this.send.bind(this),e&&!1===e.autoOpen||this.open()}var t=e.prototype;return t.open=function(){var e=this;this.socket=new WebSocket(this.opts.target),this.socket.onopen=function(t){for(e.isOpen=!0;e._queued.length>0&&e.isOpen;){var i=e._queued[0];e.send(i.action,i.payload),e._queued=e._queued.slice(1)}},this.socket.onclose=function(t){e.isOpen=!1},this.socket.onmessage=this._handleMessage},t.close=function(){this.socket&&this.socket.close()},t.send=function(e,t){this.isOpen?this.socket.send(JSON.stringify({action:e,payload:t})):this._queued.push({action:e,payload:t})},t.on=function(e,t){this.emitter.on(e,t)},t.emit=function(e,t){this.emitter.emit(e,t)},t.once=function(e,t){this.emitter.once(e,t)},t._handleMessage=function(e){try{var t=JSON.parse(e.data);this.emit(t.action,t.payload)}catch(i){console.log(i)}},e}()},88772:function(e,t,i){"use strict";var n=i(54452),r=i(51134),o=i(63542),s=i(1207);e.exports={RequestClient:n,Provider:r,SearchProvider:o,Socket:s}},99075:function(e){"use strict";e.exports.setItem=function(e,t){return new Promise((function(i){localStorage.setItem(e,t),i()}))},e.exports.getItem=function(e){return Promise.resolve(localStorage.getItem(e))},e.exports.removeItem=function(e){return new Promise((function(t){localStorage.removeItem(e),t()}))}},67606:function(e,t,i){var n=i(58511).ProviderViews;e.exports=function(e){var t,i;function n(){return e.apply(this,arguments)||this}return i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.prototype.toggleCheckbox=function(t,i){t.stopPropagation(),t.preventDefault(),i.custom.isTeamDrive||i.custom.isSharedDrive||e.prototype.toggleCheckbox.call(this,t,i)},n}(n)},35541:function(e,t,i){var n,r;function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var s=i(92432).Plugin,a=i(88772).Provider,c=i(67606),u=i(75045).h;e.exports=(r=n=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,i)||this).id=n.opts.id||"GoogleDrive",n.title=n.opts.title||"Google Drive",a.initPlugin(o(n),i),n.title=n.opts.title||"Google Drive",n.icon=function(){return u("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},u("g",{fill:"none","fill-rule":"evenodd"},u("rect",{fill:"#4285F4",width:"32",height:"32",rx:"16"}),u("path",{d:"M10.324 23.3l3-5.1H25l-3 5.1H10.324zM13 18.2l-3 5.1-3-5.1 5.839-9.924 2.999 5.1L13 18.2zm11.838-.276h-6L13 8h6l5.84 9.924h-.002z",fill:"#FFF"})))},n.provider=new a(t,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders,companionKeysParams:n.opts.companionKeysParams,companionCookiesRule:n.opts.companionCookiesRule,provider:"drive",pluginId:n.id}),n.onFirstRender=n.onFirstRender.bind(o(n)),n.render=n.render.bind(o(n)),n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.install=function(){this.view=new c(this,{provider:this.provider});var e=this.opts.target;e&&this.mount(e,this)},r.uninstall=function(){this.view.tearDown(),this.unmount()},r.onFirstRender=function(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder("root","/")])},r.render=function(e){return this.view.render(e)},n}(s),n.VERSION="1.5.22",r)},943:function(e,t,i){var n,r;function o(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var s=i(92432).Plugin,a=i(88772).Provider,c=i(58511).ProviderViews,u=i(75045).h;e.exports=(r=n=function(e){var t,i;function n(t,i){var n;return(n=e.call(this,t,i)||this).id=n.opts.id||"OneDrive",a.initPlugin(o(n),i),n.title=n.opts.title||"OneDrive",n.icon=function(){return u("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},u("g",{fill:"none","fill-rule":"evenodd"},u("rect",{width:"32",height:"32",rx:"16",fill:"#0262C0"}),u("g",{fill:"#FFF","fill-rule":"nonzero"},u("path",{d:"M24.157 22s1.492-.205 1.79-1.655a2.624 2.624 0 0 0 .03-.878c-.22-1.64-1.988-2.01-1.988-2.01s.307-1.765-1.312-2.69c-1.62-.925-3.1 0-3.1 0S18.711 13 16.366 13c-3.016 0-3.519 3.448-3.519 3.448S10 16.618 10 19.14c0 2.523 2.597 2.86 2.597 2.86h11.56z"}),u("path",{d:"M9.421 19.246c0-2.197 1.606-3.159 2.871-3.472.44-1.477 1.654-3.439 4.135-3.439H16.445c1.721 0 2.79.823 3.368 1.476a3.99 3.99 0 0 1 1.147-.171h.01l.03.002C21.017 13.5 20.691 10 16.757 10c-2.69 0-3.639 2.345-3.639 2.345s-1.95-1.482-3.955.567c-1.028 1.052-.79 2.669-.79 2.669S6 15.824 6 18.412C6 20.757 8.452 21 8.452 21h1.372a3.77 3.77 0 0 1-.403-1.754z"}))))},n.provider=new a(t,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders,companionCookiesRule:n.opts.companionCookiesRule,provider:"onedrive",pluginId:n.id}),n.onFirstRender=n.onFirstRender.bind(o(n)),n.render=n.render.bind(o(n)),n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.install=function(){this.view=new c(this,{provider:this.provider});var e=this.opts.target;e&&this.mount(e,this)},r.uninstall=function(){this.view.tearDown(),this.unmount()},r.onFirstRender=function(){return Promise.all([this.provider.fetchPreAuthToken(),this.view.getFolder()])},r.render=function(e){return this.view.render(e)},n}(s),n.VERSION="1.1.22",r)},7404:function(e,t,i){var n=i(75045).h,r=function(e){return n("span",null,n("button",{type:"button",class:"uppy-u-reset",onclick:e.getFolder},e.title),e.isLast?"":" / ")};e.exports=function(e){return n("div",{class:"uppy-Provider-breadcrumbs"},n("div",{class:"uppy-Provider-breadcrumbsIcon"},e.breadcrumbsIcon),e.directories.map((function(t,i){return n(r,{key:t.id,getFolder:function(){return e.getFolder(t.id)},title:0===i?e.title:t.title,isLast:i+1===e.directories.length})})))}},18349:function(e,t,i){function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}var r=i(97715),o=i(91933),s=i(4110),a=i(27034),c=i(75045).h;e.exports=function(e){var t=e.currentSelection,i=e.folders,u=e.files,l=e.uppyFiles,p=e.filterItems,h=i,d=u;""!==e.filterInput&&(h=p(i),d=p(u));var f=t.length;return c("div",{class:r("uppy-ProviderBrowser","uppy-ProviderBrowser-viewType--"+e.viewType)},c("div",{class:"uppy-ProviderBrowser-header"},c("div",{class:r("uppy-ProviderBrowser-headerBar",!e.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple")},e.headerComponent)),e.showFilter&&c(o,e),c(s,{columns:[{name:"Name",key:"title"}],folders:h,files:d,sortByTitle:e.sortByTitle,sortByDate:e.sortByDate,isChecked:e.isChecked,handleFolderClick:e.getNextFolder,toggleCheckbox:e.toggleCheckbox,handleScroll:e.handleScroll,title:e.title,showTitles:e.showTitles,i18n:e.i18n,viewType:e.viewType,validateRestrictions:e.validateRestrictions,uppyFiles:l,currentSelection:t}),f>0&&c(a,n({selected:f},e)))}},50766:function(e,t,i){var n=i(75045).Component;e.exports=function(e){var t,i;function n(){return e.apply(this,arguments)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.componentWillUnmount=function(){this.props.onUnmount()},r.render=function(){return this.props.children[0]},n}(n)},91933:function(e,t,i){var n=i(75045),r=n.h,o=n.Component;e.exports=function(e){var t,i;function n(t){var i;return(i=e.call(this,t)||this).preventEnterPress=i.preventEnterPress.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(i)),i}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var o=n.prototype;return o.preventEnterPress=function(e){13===e.keyCode&&(e.stopPropagation(),e.preventDefault())},o.render=function(){var e=this;return r("div",{class:"uppy-ProviderBrowser-search"},r("input",{class:"uppy-u-reset uppy-ProviderBrowser-searchInput",type:"text",placeholder:this.props.i18n("filter"),"aria-label":this.props.i18n("filter"),onkeyup:this.preventEnterPress,onkeydown:this.preventEnterPress,onkeypress:this.preventEnterPress,oninput:function(t){return e.props.filterQuery(t)},value:this.props.filterInput}),r("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon uppy-ProviderBrowser-searchIcon",width:"12",height:"12",viewBox:"0 0 12 12"},r("path",{d:"M8.638 7.99l3.172 3.172a.492.492 0 1 1-.697.697L7.91 8.656a4.977 4.977 0 0 1-2.983.983C2.206 9.639 0 7.481 0 4.819 0 2.158 2.206 0 4.927 0c2.721 0 4.927 2.158 4.927 4.82a4.74 4.74 0 0 1-1.216 3.17zm-3.71.685c2.176 0 3.94-1.726 3.94-3.856 0-2.129-1.764-3.855-3.94-3.855C2.75.964.984 2.69.984 4.819c0 2.13 1.765 3.856 3.942 3.856z"})),this.props.filterInput&&r("button",{class:"uppy-u-reset uppy-ProviderBrowser-searchClose",type:"button","aria-label":this.props.i18n("resetFilter"),title:this.props.i18n("resetFilter"),onclick:this.props.filterQuery},r("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",viewBox:"0 0 19 19"},r("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"}))))},n}(o)},27034:function(e,t,i){var n=i(75045).h;e.exports=function(e){return n("div",{class:"uppy-ProviderBrowser-footer"},n("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary",onclick:e.done},e.i18n("selectX",{smart_count:e.selected})),n("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onclick:e.cancel},e.i18n("cancel")))}},16699:function(e,t,i){var n=i(75045).h;e.exports=function(e){return n("li",{class:e.className,title:e.isDisabled?e.restrictionReason:null},n("div",{"aria-hidden":!0,class:"uppy-ProviderBrowserItem-fakeCheckbox "+(e.isChecked?"uppy-ProviderBrowserItem-fakeCheckbox--is-checked":"")}),n("button",{type:"button",class:"uppy-u-reset uppy-ProviderBrowserItem-inner",onclick:e.toggleCheckbox,role:"option","aria-label":e.isChecked?e.i18n("unselectFileNamed",{name:e.title}):e.i18n("selectFileNamed",{name:e.title}),"aria-selected":e.isChecked,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"data-uppy-super-focusable":!0},e.itemIconEl,e.showTitles&&e.title))}},22231:function(e,t,i){var n=i(75045).h;function r(){return n("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:11,height:14.5,viewBox:"0 0 44 58"},n("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"}))}function o(){return n("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",style:{minWidth:16,marginRight:3},viewBox:"0 0 276.157 276.157"},n("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"}))}function s(){return n("svg",{"aria-hidden":"true",focusable:"false",style:{width:16,marginRight:4},viewBox:"0 0 58 58"},n("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),n("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}))}e.exports=function(e){if(null!==e.itemIconString)switch(e.itemIconString){case"file":return n(r,null);case"folder":return n(o,null);case"video":return n(s,null);default:return n("img",{src:e.itemIconString})}}},52098:function(e,t,i){var n=i(75045).h,r=function(e){return"folder"===e.type?e.isChecked?e.i18n("unselectAllFilesFromFolderNamed",{name:e.title}):e.i18n("selectAllFilesFromFolderNamed",{name:e.title}):e.isChecked?e.i18n("unselectFileNamed",{name:e.title}):e.i18n("selectFileNamed",{name:e.title})};e.exports=function(e){return n("li",{class:e.className,title:e.isDisabled?e.restrictionReason:null},n("button",{type:"button",class:"uppy-u-reset uppy-ProviderBrowserItem-fakeCheckbox "+(e.isChecked?"uppy-ProviderBrowserItem-fakeCheckbox--is-checked":""),onClick:e.toggleCheckbox,id:e.id,role:"option","aria-label":r(e),"aria-selected":e.isChecked,"aria-disabled":e.isDisabled,disabled:e.isDisabled,"data-uppy-super-focusable":!0}),"file"===e.type?n("label",{for:e.id,class:"uppy-u-reset uppy-ProviderBrowserItem-inner"},n("div",{class:"uppy-ProviderBrowserItem-iconWrap"},e.itemIconEl),e.showTitles&&e.title):n("button",{type:"button",class:"uppy-u-reset uppy-ProviderBrowserItem-inner",onclick:e.handleFolderClick,"aria-label":e.i18n("openFolderNamed",{name:e.title})},n("div",{class:"uppy-ProviderBrowserItem-iconWrap"},e.itemIconEl),e.showTitles&&n("span",null,e.title)))}},93448:function(e,t,i){function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}var r=i(75045).h,o=i(97715),s=i(22231),a=i(16699),c=i(52098);e.exports=function(e){var t=e.getItemIcon(),i=o("uppy-ProviderBrowserItem",{"uppy-ProviderBrowserItem--selected":e.isChecked},{"uppy-ProviderBrowserItem--disabled":e.isDisabled},{"uppy-ProviderBrowserItem--noPreview":"video"===t}),u=r(s,{itemIconString:t});switch(e.viewType){case"grid":return r(a,n({},e,{className:i,itemIconEl:u}));case"list":return r(c,n({},e,{className:i,itemIconEl:u}));default:throw new Error("There is no such type "+e.viewType)}}},4110:function(e,t,i){function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}var r=i(75045).h,o=i(13185),s=i(93448),a=function(e,t){return{id:e.id,title:e.name,getItemIcon:function(){return e.icon},isChecked:t.isChecked(e),toggleCheckbox:function(i){return t.toggleCheckbox(i,e)},columns:t.columns,showTitles:t.showTitles,viewType:t.viewType,i18n:t.i18n}};e.exports=function(e){return e.folders.length||e.files.length?r("div",{class:"uppy-ProviderBrowser-body"},r("ul",{class:"uppy-ProviderBrowser-list",onscroll:e.handleScroll,role:"listbox",tabindex:"-1"},e.folders.map((function(t){return s(n({},a(t,e),{type:"folder",isDisabled:!!e.isChecked(t)&&e.isChecked(t).loading,handleFolderClick:function(){return e.handleFolderClick(t)}}))})),e.files.map((function(t){var i=e.validateRestrictions(o(t),[].concat(e.uppyFiles,e.currentSelection)),r=a(t,e),c=i.reason;return s(n({},r,{type:"file",isDisabled:!i.result&&!r.isChecked,restrictionReason:c}))})))):r("div",{class:"uppy-Provider-empty"},e.i18n("noFilesFound"))}},3451:function(e,t,i){var n=i(75045).h;e.exports=function(e){return n("div",{class:"uppy-Provider-loading"},n("span",null,e.i18n("loading")))}},47:function(e,t,i){var n=i(75045),r=n.h,o=function(e){var t,i;function n(){return e.apply(this,arguments)||this}return i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i,n.prototype.render=function(){var e=r("span",{class:"uppy-Provider-authTitleName"},this.props.pluginName,r("br",null));return r("div",{class:"uppy-Provider-auth"},r("div",{class:"uppy-Provider-authIcon"},this.props.pluginIcon()),r("div",{class:"uppy-Provider-authTitle"},this.props.i18nArray("authenticateWithTitle",{pluginName:e})),r("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn",onclick:this.props.handleAuth,"data-uppy-super-focusable":!0},this.props.i18nArray("authenticateWith",{pluginName:this.props.pluginName})))},n}(n.Component);e.exports=o},32708:function(e,t,i){var n=i(36377),r=i(7404);e.exports=function(e){var t=[];return e.showBreadcrumbs&&t.push(r({getFolder:e.getFolder,directories:e.directories,breadcrumbsIcon:e.pluginIcon&&e.pluginIcon(),title:e.title})),t.push(n({logout:e.logout,username:e.username,i18n:e.i18n})),t}},34448:function(e,t,i){var n,r;function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o.apply(this,arguments)}var s=i(75045).h,a=i(47),c=i(32708),u=i(18349),l=i(3451),p=i(8277),h=i(90353),d=i(30746),f=i(86615),g=i(50766);e.exports=(r=n=function(){function e(e,t){this.plugin=e,this.provider=t.provider,this._sharedHandler=new f(e);this.opts=o({},{viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0},t),this.addFile=this.addFile.bind(this),this.filterQuery=this.filterQuery.bind(this),this.getFolder=this.getFolder.bind(this),this.getNextFolder=this.getNextFolder.bind(this),this.logout=this.logout.bind(this),this.preFirstRender=this.preFirstRender.bind(this),this.handleAuth=this.handleAuth.bind(this),this.sortByTitle=this.sortByTitle.bind(this),this.sortByDate=this.sortByDate.bind(this),this.handleError=this.handleError.bind(this),this.handleScroll=this.handleScroll.bind(this),this.listAllFiles=this.listAllFiles.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelPicking=this.cancelPicking.bind(this),this.clearSelection=this.clearSelection.bind(this),this.render=this.render.bind(this),this.clearSelection(),this.plugin.setPluginState({authenticated:!1,files:[],folders:[],directories:[],filterInput:"",isSearchVisible:!1})}var t=e.prototype;return t.tearDown=function(){},t._updateFilesAndFolders=function(e,t,i){this.nextPagePath=e.nextPagePath,e.items.forEach((function(e){e.isFolder?i.push(e):t.push(e)})),this.plugin.setPluginState({folders:i,files:t})},t.preFirstRender=function(){this.plugin.setPluginState({didFirstRender:!0}),this.plugin.onFirstRender()},t.getFolder=function(e,t){var i=this;return this._sharedHandler.loaderWrapper(this.provider.list(e),(function(n){var r,o=i.plugin.getPluginState(),s=function(e,t){for(var i=0;i<e.length;i++)if(t(e[i]))return i;return-1}(o.directories,(function(t){return e===t.id}));r=-1!==s?o.directories.slice(0,s+1):o.directories.concat([{id:e,title:t}]),i.username=n.username||i.username,i._updateFilesAndFolders(n,[],[]),i.plugin.setPluginState({directories:r})}),this.handleError)},t.getNextFolder=function(e){this.getFolder(e.requestPath,e.name),this.lastCheckbox=void 0},t.addFile=function(e){var t={id:this.providerFileToId(e),source:this.plugin.id,data:e,name:e.name||e.id,type:e.mimeType,isRemote:!0,body:{fileId:e.id},remote:{companionUrl:this.plugin.opts.companionUrl,url:""+this.provider.fileUrl(e.requestPath),body:{fileId:e.id},providerOptions:this.provider.opts}},i=h(t);i&&d(i)&&(t.preview=e.thumbnail),this.plugin.uppy.log("Adding remote file");try{return this.plugin.uppy.addFile(t),!0}catch(n){return n.isRestriction||this.plugin.uppy.log(n),!1}},t.logout=function(){var e=this;this.provider.logout().then((function(t){if(t.ok){if(!t.revoked){var i=e.plugin.uppy.i18n("companionUnauthorizeHint",{provider:e.plugin.title,url:t.manual_revoke_url});e.plugin.uppy.info(i,"info",7e3)}e.plugin.setPluginState({authenticated:!1,files:[],folders:[],directories:[]})}})).catch(this.handleError)},t.filterQuery=function(e){var t=this.plugin.getPluginState();this.plugin.setPluginState(o({},t,{filterInput:e?e.target.value:""}))},t.sortByTitle=function(){var e=o({},this.plugin.getPluginState()),t=e.files,i=e.folders,n=e.sorting,r=t.sort((function(e,t){return"titleDescending"===n?t.name.localeCompare(e.name):e.name.localeCompare(t.name)})),s=i.sort((function(e,t){return"titleDescending"===n?t.name.localeCompare(e.name):e.name.localeCompare(t.name)}));this.plugin.setPluginState(o({},e,{files:r,folders:s,sorting:"titleDescending"===n?"titleAscending":"titleDescending"}))},t.sortByDate=function(){var e=o({},this.plugin.getPluginState()),t=e.files,i=e.folders,n=e.sorting,r=t.sort((function(e,t){var i=new Date(e.modifiedDate),r=new Date(t.modifiedDate);return"dateDescending"===n?i>r?-1:i<r?1:0:i>r?1:i<r?-1:0})),s=i.sort((function(e,t){var i=new Date(e.modifiedDate),r=new Date(t.modifiedDate);return"dateDescending"===n?i>r?-1:i<r?1:0:i>r?1:i<r?-1:0}));this.plugin.setPluginState(o({},e,{files:r,folders:s,sorting:"dateDescending"===n?"dateAscending":"dateDescending"}))},t.sortBySize=function(){var e=o({},this.plugin.getPluginState()),t=e.files,i=e.sorting;if(t.length&&this.plugin.getItemData(t[0]).size){var n=t.sort((function(e,t){var n=e.size,r=t.size;return"sizeDescending"===i?n>r?-1:n<r?1:0:n>r?1:n<r?-1:0}));this.plugin.setPluginState(o({},e,{files:n,sorting:"sizeDescending"===i?"sizeAscending":"sizeDescending"}))}},t.addFolder=function(e){var t=this,i=this.providerFileToId(e),n=o({},this.plugin.getPluginState().selectedFolders);if(!(i in n)||!n[i].loading)return n[i]={loading:!0,files:[]},this.plugin.setPluginState({selectedFolders:o({},n)}),this.listAllFiles(e.requestPath).then((function(r){var o=0;r.forEach((function(e){t.addFile(e)&&o++}));var s,a=r.map(t.providerFileToId);n[i]={loading:!1,files:a},t.plugin.setPluginState({selectedFolders:n}),s=r.length?t.plugin.uppy.i18n("folderAdded",{smart_count:o,folder:e.name}):t.plugin.uppy.i18n("emptyFolderAdded"),t.plugin.uppy.info(s)})).catch((function(e){var n=o({},t.plugin.getPluginState().selectedFolders);delete n[i],t.plugin.setPluginState({selectedFolders:n}),t.handleError(e)}))},t.providerFileToId=function(e){return p({data:e,name:e.name||e.id,type:e.mimeType})},t.handleAuth=function(){var t=this,i=btoa(JSON.stringify({origin:"origin"in location?location.origin:location.protocol+"//"+location.hostname+(location.port?":"+location.port:"")})),n="@uppy/provider-views="+e.VERSION,r=this.provider.authUrl({state:i,uppyVersions:n}),o=window.open(r,"_blank");window.addEventListener("message",(function e(i){if(t._isOriginAllowed(i.origin,t.plugin.opts.companionAllowedHosts)&&i.source===o){var n="string"===typeof i.data?JSON.parse(i.data):i.data;n.token?(o.close(),window.removeEventListener("message",e),t.provider.setAuthToken(n.token),t.preFirstRender()):t.plugin.uppy.log("did not receive token from auth window")}else t.plugin.uppy.log("rejecting event from "+i.origin+" vs allowed pattern "+t.plugin.opts.companionAllowedHosts)}))},t._isOriginAllowed=function(e,t){var i=function(e){return"string"===typeof e?new RegExp("^"+e+"$"):e instanceof RegExp?e:void 0};return(Array.isArray(t)?t.map(i):[i(t)]).filter((function(e){return null!=e})).some((function(t){return t.test(e)||t.test(e+"/")}))},t.handleError=function(e){var t=this.plugin.uppy;if(t.log(e.toString()),!e.isAuthError){var i=t.i18n("companionError");t.info({message:i,details:e.toString()},"error",5e3)}},t.handleScroll=function(e){var t=this,i=e.target.scrollHeight-(e.target.scrollTop+e.target.offsetHeight),n=this.nextPagePath||null;i<50&&n&&!this._isHandlingScroll&&(this.provider.list(n).then((function(e){var i=t.plugin.getPluginState(),n=i.files,r=i.folders;t._updateFilesAndFolders(e,n,r)})).catch(this.handleError).then((function(){t._isHandlingScroll=!1})),this._isHandlingScroll=!0)},t.listAllFiles=function(e,t){var i=this;return void 0===t&&(t=null),t=t||[],new Promise((function(n,r){i.provider.list(e).then((function(e){e.items.forEach((function(e){e.isFolder?i.addFolder(e):t.push(e)}));var o=e.nextPagePath||null;return o?i.listAllFiles(o,t).then((function(e){return n(e)})).catch((function(e){return r(e)})):n(t)})).catch((function(e){return r(e)}))}))},t.donePicking=function(){var e=this,t=this.plugin.getPluginState().currentSelection.map((function(t){return t.isFolder?e.addFolder(t):e.addFile(t)}));this._sharedHandler.loaderWrapper(Promise.all(t),(function(){e.clearSelection()}),(function(){}))},t.cancelPicking=function(){this.clearSelection();var e=this.plugin.uppy.getPlugin("Dashboard");e&&e.hideAllPanels()},t.clearSelection=function(){this.plugin.setPluginState({currentSelection:[]})},t.render=function(e,t){void 0===t&&(t={});var i=this.plugin.getPluginState(),n=i.authenticated;if(i.didFirstRender||this.preFirstRender(),this.plugin.getPluginState().loading)return s(g,{onUnmount:this.clearSelection},s(l,{i18n:this.plugin.uppy.i18n}));if(!n)return s(g,{onUnmount:this.clearSelection},s(a,{pluginName:this.plugin.title,pluginIcon:this.plugin.icon,handleAuth:this.handleAuth,i18n:this.plugin.uppy.i18n,i18nArray:this.plugin.uppy.i18nArray}));var r=o({},this.opts,t),p={showBreadcrumbs:r.showBreadcrumbs,getFolder:this.getFolder,directories:this.plugin.getPluginState().directories,pluginIcon:this.plugin.icon,title:this.plugin.title,logout:this.logout,username:this.username,i18n:this.plugin.uppy.i18n},h=o({},this.plugin.getPluginState(),{username:this.username,getNextFolder:this.getNextFolder,getFolder:this.getFolder,filterItems:this._sharedHandler.filterItems,filterQuery:this.filterQuery,sortByTitle:this.sortByTitle,sortByDate:this.sortByDate,logout:this.logout,isChecked:this._sharedHandler.isChecked,toggleCheckbox:this._sharedHandler.toggleCheckbox,handleScroll:this.handleScroll,listAllFiles:this.listAllFiles,done:this.donePicking,cancel:this.cancelPicking,headerComponent:c(p),title:this.plugin.title,viewType:r.viewType,showTitles:r.showTitles,showFilter:r.showFilter,showBreadcrumbs:r.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:this.plugin.uppy.i18n,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:this.plugin.uppy.validateRestrictions});return s(g,{onUnmount:this.clearSelection},s(u,h))},e}(),n.VERSION="1.11.0",r)},36377:function(e,t,i){var n=i(75045).h;e.exports=function(e){return[n("span",{class:"uppy-ProviderBrowser-user",key:"username"},e.username),n("button",{type:"button",onclick:e.logout,class:"uppy-u-reset uppy-ProviderBrowser-userLogout",key:"logout"},e.i18n("logOut"))]}},66492:function(e,t,i){e.exports=i(34448)},19395:function(e,t,i){var n=i(75045).h;e.exports=function(e){return n("button",{type:"button",onclick:e.triggerSearchInput,class:"uppy-u-reset uppy-ProviderBrowser-userLogout"},e.i18n("backToSearch"))}},99725:function(e,t,i){var n=i(75045).h;e.exports=function(e){var t,i=function(){t.value&&e.search(t.value)};return n("div",{class:"uppy-SearchProvider"},n("input",{class:"uppy-u-reset uppy-c-textInput uppy-SearchProvider-input",type:"text","aria-label":e.i18n("enterTextToSearch"),placeholder:e.i18n("enterTextToSearch"),onkeyup:function(e){13===e.keyCode&&i()},ref:function(e){t=e},"data-uppy-super-focusable":!0}),n("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-SearchProvider-searchButton",type:"button",onclick:i},e.i18n("searchImages")))}},54284:function(e,t,i){var n,r;function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o.apply(this,arguments)}var s=i(75045).h,a=i(99725),c=i(18349),u=i(3451),l=i(8277),p=i(90353),h=i(30746),d=i(19395),f=i(86615),g=i(50766);e.exports=(r=n=function(){function e(e,t){this.plugin=e,this.provider=t.provider,this._sharedHandler=new f(e);this.opts=o({},{viewType:"grid",showTitles:!1,showFilter:!1,showBreadcrumbs:!1},t),this.search=this.search.bind(this),this.triggerSearchInput=this.triggerSearchInput.bind(this),this.addFile=this.addFile.bind(this),this.preFirstRender=this.preFirstRender.bind(this),this.handleError=this.handleError.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelPicking=this.cancelPicking.bind(this),this.clearSelection=this.clearSelection.bind(this),this.render=this.render.bind(this),this.clearSelection(),this.plugin.setPluginState({isInputMode:!0,files:[],folders:[],directories:[],filterInput:"",isSearchVisible:!1})}var t=e.prototype;return t.tearDown=function(){},t._updateFilesAndInputMode=function(e,t){this.nextPageQuery=e.nextPageQuery,this._searchTerm=e.searchedFor,e.items.forEach((function(e){t.push(e)})),this.plugin.setPluginState({isInputMode:!1,files:t})},t.preFirstRender=function(){this.plugin.setPluginState({didFirstRender:!0}),this.plugin.onFirstRender()},t.search=function(e){var t=this;if(!e||e!==this._searchTerm)return this._sharedHandler.loaderWrapper(this.provider.search(e),(function(e){t._updateFilesAndInputMode(e,[])}),this.handleError);this.plugin.setPluginState({isInputMode:!1})},t.triggerSearchInput=function(){this.plugin.setPluginState({isInputMode:!0})},t.addFile=function(e){var t={id:this.providerFileToId(e),source:this.plugin.id,data:e,name:e.name||e.id,type:e.mimeType,isRemote:!0,body:{fileId:e.id},remote:{companionUrl:this.plugin.opts.companionUrl,url:""+this.provider.fileUrl(e.requestPath),body:{fileId:e.id},providerOptions:o({},this.provider.opts,{provider:null})}},i=p(t);i&&h(i)&&(t.preview=e.thumbnail),this.plugin.uppy.log("Adding remote file");try{this.plugin.uppy.addFile(t)}catch(n){n.isRestriction||this.plugin.uppy.log(n)}},t.providerFileToId=function(e){return l({data:e,name:e.name||e.id,type:e.mimeType})},t.handleError=function(e){var t=this.plugin.uppy;t.log(e.toString());var i=t.i18n("companionError");t.info({message:i,details:e.toString()},"error",5e3)},t.handleScroll=function(e){var t=this,i=e.target.scrollHeight-(e.target.scrollTop+e.target.offsetHeight),n=this.nextPageQuery||null;i<50&&n&&!this._isHandlingScroll&&(this.provider.search(this._searchTerm,n).then((function(e){var i=t.plugin.getPluginState().files;t._updateFilesAndInputMode(e,i)})).catch(this.handleError).then((function(){t._isHandlingScroll=!1})),this._isHandlingScroll=!0)},t.donePicking=function(){var e=this,t=this.plugin.getPluginState().currentSelection.map((function(t){return e.addFile(t)}));this._sharedHandler.loaderWrapper(Promise.all(t),(function(){e.clearSelection()}),(function(){}))},t.cancelPicking=function(){this.clearSelection();var e=this.plugin.uppy.getPlugin("Dashboard");e&&e.hideAllPanels()},t.clearSelection=function(){this.plugin.setPluginState({currentSelection:[]})},t.render=function(e,t){void 0===t&&(t={});var i=this.plugin.getPluginState(),n=i.didFirstRender,r=i.isInputMode;if(n||this.preFirstRender(),this.plugin.getPluginState().loading)return s(g,{onUnmount:this.clearSelection},s(u,{i18n:this.plugin.uppy.i18n}));if(r)return s(g,{onUnmount:this.clearSelection},s(a,{search:this.search,i18n:this.plugin.uppy.i18n}));var l=o({},this.opts,t),p=o({},this.plugin.getPluginState(),{isChecked:this._sharedHandler.isChecked,toggleCheckbox:this._sharedHandler.toggleCheckbox,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,headerComponent:d({triggerSearchInput:this.triggerSearchInput,i18n:this.plugin.uppy.i18n}),title:this.plugin.title,viewType:l.viewType,showTitles:l.showTitles,showFilter:l.showFilter,showBreadcrumbs:l.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:this.plugin.uppy.i18n,uppyFiles:this.plugin.uppy.getFiles(),validateRestrictions:this.plugin.uppy.validateRestrictions});return s(g,{onUnmount:this.clearSelection},s(c,p))},e}(),n.VERSION="1.11.0",r)},39208:function(e,t,i){e.exports=i(54284)},86615:function(e,t,i){var n=i(13185);e.exports=function(){function e(e){this.plugin=e,this.filterItems=this.filterItems.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.isChecked=this.isChecked.bind(this),this.loaderWrapper=this.loaderWrapper.bind(this)}var t=e.prototype;return t.filterItems=function(e){var t=this.plugin.getPluginState();return t.filterInput&&""!==t.filterInput?e.filter((function(e){return-1!==e.name.toLowerCase().indexOf(t.filterInput.toLowerCase())})):e},t.toggleCheckbox=function(e,t){var i=this;e.stopPropagation(),e.preventDefault(),e.currentTarget.focus();var r=this.plugin.getPluginState(),o=r.folders,s=r.files,a=this.filterItems(o.concat(s));if(this.lastCheckbox&&e.shiftKey){var c,u=a.indexOf(this.lastCheckbox),l=a.indexOf(t);return c=(c=u<l?a.slice(u,l+1):a.slice(l,u+1)).reduce((function(e,t){var r=i.plugin.uppy,o=r.validateRestrictions(n(t),[].concat(r.getFiles(),e));return o.result?[].concat(e,[t]):(r.info({message:o.reason},"error",r.opts.infoTimeout),e)})),void this.plugin.setPluginState({currentSelection:c})}this.lastCheckbox=t;var p=this.plugin.getPluginState().currentSelection;this.isChecked(t)?this.plugin.setPluginState({currentSelection:p.filter((function(e){return e.id!==t.id}))}):this.plugin.setPluginState({currentSelection:p.concat([t])})},t.isChecked=function(e){return this.plugin.getPluginState().currentSelection.some((function(t){return t.id===e.id}))},t.loaderWrapper=function(e,t,i){var n=this;e.then((function(e){n.plugin.setPluginState({loading:!1}),t(e)})).catch((function(e){n.plugin.setPluginState({loading:!1}),i(e)})),this.plugin.setPluginState({loading:!0})},e}()},58511:function(e,t,i){var n=i(66492),r=i(39208);e.exports={ProviderViews:n,SearchProviderViews:r}},71631:function(e,t,i){function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var r=i(75045),o=r.h,s=function(e){var t,i;function r(t){var i;return(i=e.call(this,t)||this).handleKeyPress=i.handleKeyPress.bind(n(i)),i.handleClick=i.handleClick.bind(n(i)),i}i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var s=r.prototype;return s.componentDidMount=function(){this.input.value=""},s.handleKeyPress=function(e){13===e.keyCode&&this.props.addFile(this.input.value)},s.handleClick=function(){this.props.addFile(this.input.value)},s.render=function(){var e=this;return o("div",{class:"uppy-Url"},o("input",{class:"uppy-u-reset uppy-c-textInput uppy-Url-input",type:"text","aria-label":this.props.i18n("enterUrlToImport"),placeholder:this.props.i18n("enterUrlToImport"),onkeyup:this.handleKeyPress,ref:function(t){e.input=t},"data-uppy-super-focusable":!0}),o("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton",type:"button",onclick:this.handleClick},this.props.i18n("import")))},r}(r.Component);e.exports=s},50381:function(e,t,i){var n,r;function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o.apply(this,arguments)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var a=i(92432).Plugin,c=i(12540),u=i(75045).h,l=i(88772).RequestClient,p=i(71631),h=i(47066);function d(){return u("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},u("g",{fill:"none","fill-rule":"evenodd"},u("rect",{fill:"#FF753E",width:"32",height:"32",rx:"16"}),u("path",{d:"M22.788 15.389l-2.199 2.19a3.184 3.184 0 0 1-.513.437c-.806.584-1.686.876-2.638.876a4.378 4.378 0 0 1-3.519-1.752c-.22-.292-.146-.802.147-1.021.293-.22.806-.146 1.026.146.953 1.313 2.785 1.532 4.105.583a.571.571 0 0 0 .293-.292l2.199-2.189c1.1-1.167 1.1-2.992-.073-4.086a2.976 2.976 0 0 0-4.105 0l-1.246 1.24a.71.71 0 0 1-1.026 0 .703.703 0 0 1 0-1.022l1.246-1.24a4.305 4.305 0 0 1 6.083 0c1.833 1.605 1.906 4.451.22 6.13zm-7.183 5.035l-1.246 1.24a2.976 2.976 0 0 1-4.105 0c-1.172-1.094-1.172-2.991-.073-4.086l2.2-2.19.292-.291c.66-.438 1.393-.657 2.2-.584.805.146 1.465.51 1.905 1.168.22.292.733.365 1.026.146.293-.22.367-.73.147-1.022-.733-.949-1.76-1.532-2.859-1.678-1.1-.22-2.272.073-3.225.802l-.44.438-2.199 2.19c-1.686 1.75-1.612 4.524.074 6.202.88.803 1.979 1.241 3.078 1.241 1.1 0 2.199-.438 3.079-1.24l1.246-1.241a.703.703 0 0 0 0-1.022c-.294-.292-.807-.365-1.1-.073z",fill:"#FFF","fill-rule":"nonzero"})))}e.exports=(r=n=function(e){var t,i;function n(t,i){var n;(n=e.call(this,t,i)||this).id=n.opts.id||"Url",n.title=n.opts.title||"Link",n.type="acquirer",n.icon=function(){return u(d,null)},n.defaultLocale={strings:{import:"Import",enterUrlToImport:"Enter URL to import a file",failedToFetch:"Companion failed to fetch this URL, please make sure it\u2019s correct",enterCorrectUrl:"Incorrect URL: Please make sure you are entering a direct link to a file"}};if(n.opts=o({},{},i),n.i18nInit(),n.hostname=n.opts.companionUrl,!n.hostname)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");return n.getMeta=n.getMeta.bind(s(n)),n.addFile=n.addFile.bind(s(n)),n.handleRootDrop=n.handleRootDrop.bind(s(n)),n.handleRootPaste=n.handleRootPaste.bind(s(n)),n.client=new l(t,{companionUrl:n.opts.companionUrl,companionHeaders:n.opts.companionHeaders||n.opts.serverHeaders}),n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.setOptions=function(t){e.prototype.setOptions.call(this,t),this.i18nInit()},r.i18nInit=function(){this.translator=new c([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},r.getFileNameFromUrl=function(e){return e.substring(e.lastIndexOf("/")+1)},r.checkIfCorrectURL=function(e){if(!e)return!1;var t=e.match(/^([a-z0-9]+):\/\//)[1];return"http"===t||"https"===t},r.addProtocolToURL=function(e){return/^[a-z0-9]+:\/\//.test(e)?e:"http://"+e},r.getMeta=function(e){var t=this;return this.client.post("url/meta",{url:e}).then((function(e){if(e.error)throw t.uppy.log("[URL] Error:"),t.uppy.log(e.error),new Error("Failed to fetch the file");return e}))},r.addFile=function(e){var t=this;return e=this.addProtocolToURL(e),this.checkIfCorrectURL(e)?this.getMeta(e).then((function(i){return{source:t.id,name:t.getFileNameFromUrl(e),type:i.type,data:{size:i.size},isRemote:!0,body:{url:e},remote:{companionUrl:t.opts.companionUrl,url:t.hostname+"/url/get",body:{fileId:e,url:e},providerOptions:t.client.opts}}})).then((function(e){t.uppy.log("[Url] Adding remote file");try{t.uppy.addFile(e)}catch(i){i.isRestriction||t.uppy.log(i)}})).catch((function(e){t.uppy.log(e),t.uppy.info({message:t.i18n("failedToFetch"),details:e},"error",4e3)})):(this.uppy.log("[URL] Incorrect URL entered: "+e),void this.uppy.info(this.i18n("enterCorrectUrl"),"error",4e3))},r.handleRootDrop=function(e){var t=this;h(e.dataTransfer,"drop",(function(e){t.uppy.log("[URL] Adding file from dropped url: "+e),t.addFile(e)}))},r.handleRootPaste=function(e){var t=this;h(e.clipboardData,"paste",(function(e){t.uppy.log("[URL] Adding file from pasted url: "+e),t.addFile(e)}))},r.render=function(e){return u(p,{i18n:this.i18n,addFile:this.addFile})},r.install=function(){var e=this.opts.target;e&&this.mount(e,this)},r.uninstall=function(){this.unmount()},n}(a),n.VERSION="1.5.16",r)},47066:function(e,t,i){var n=i(36508);e.exports=function(e,t,i){var r,o=n(e.items);switch(t){case"paste":if(o.some((function(e){return"file"===e.kind})))return;r=o.filter((function(e){return"string"===e.kind&&"text/plain"===e.type}));break;case"drop":r=o.filter((function(e){return"string"===e.kind&&"text/uri-list"===e.type}));break;default:throw new Error("isDropOrPaste must be either 'drop' or 'paste', but it's "+t)}r.forEach((function(e){e.getAsString((function(e){return i(e)}))}))}},29588:function(e){function t(e){var o="function"===typeof Map?new Map:void 0;return t=function(e){if(null===e||(t=e,-1===Function.toString.call(t).indexOf("[native code]")))return e;var t;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof o){if(o.has(e))return o.get(e);o.set(e,s)}function s(){return i(e,arguments,r(this).constructor)}return s.prototype=Object.create(e.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),n(s,e)},t(e)}function i(e,t,r){return i=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,i){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return i&&n(o,i.prototype),o},i.apply(null,arguments)}function n(e,t){return n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(e,t)}function r(e){return r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(e)}var o=function(e){var t,i;function r(t,i){var n;return void 0===i&&(i=null),(n=e.call(this,"This looks like a network error, the endpoint might be blocked by an internet provider or a firewall.\n\nSource error: ["+t+"]")||this).isNetworkError=!0,n.request=i,n}return i=e,(t=r).prototype=Object.create(i.prototype),t.prototype.constructor=t,n(t,i),r}(t(Error));e.exports=o},63759:function(e,t,i){var n=i(6493);e.exports=function(e,t,i){return e.toBlob?new Promise((function(n){e.toBlob(n,t,i)})):Promise.resolve().then((function(){return n(e.toDataURL(t,i),{})}))}},60781:function(e,t,i){var n=i(29588);e.exports=function(){return fetch.apply(void 0,arguments).catch((function(e){throw"AbortError"===e.name?e:new n(e)}))}},82227:function(e){var t={"audio/mp3":"mp3","audio/mp4":"mp4","audio/ogg":"ogg","audio/webm":"webm","image/gif":"gif","image/heic":"heic","image/heif":"heif","image/jpeg":"jpg","image/png":"png","image/svg+xml":"svg","video/mp4":"mp4","video/ogg":"ogv","video/quicktime":"mov","video/webm":"webm","video/x-matroska":"mkv","video/x-msvideo":"avi"};e.exports=function(e){return e=e.replace(/;.*$/,""),t[e]||null}},13185:function(e,t,i){function n(){return n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},n.apply(this,arguments)}var r=i(43231);e.exports=function(e){return n({},e,{type:e.mimeType,extension:e.name?r(e.name).extension:null})}},20170:function(e,t,i){var n=i(75045).h;e.exports=function(e){return n("svg",{"aria-hidden":"true",focusable:"false",fill:"#0097DC",width:"66",height:"55",viewBox:"0 0 66 55"},n("path",{d:"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z","fill-rule":"evenodd"}))}},58950:function(e,t,i){var n=i(75045),r=n.h,o=n.Component,s=i(51949),a=i(60848),c=i(46836),u=i(9414);function l(e,t){return-1!==e.indexOf(t)}var p=function(e){var t,i;function n(){return e.apply(this,arguments)||this}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var o=n.prototype;return o.componentDidMount=function(){this.props.onFocus()},o.componentWillUnmount=function(){this.props.onStop()},o.render=function(){var e=this.props.supportsRecording&&(l(this.props.modes,"video-only")||l(this.props.modes,"audio-only")||l(this.props.modes,"video-audio")),t=l(this.props.modes,"picture"),i=this.props.supportsRecording&&this.props.showRecordingLength,n=this.props.showVideoSourceDropdown&&this.props.videoSources&&this.props.videoSources.length>1;return r("div",{class:"uppy uppy-Webcam-container"},r("div",{class:"uppy-Webcam-videoContainer"},r("video",{class:"uppy-Webcam-video  "+(this.props.mirror?"uppy-Webcam-video--mirrored":""),autoplay:!0,muted:!0,playsinline:!0,srcObject:this.props.src||""})),r("div",{class:"uppy-Webcam-footer"},r("div",{class:"uppy-Webcam-videoSourceContainer"},n?u(this.props):null),r("div",{class:"uppy-Webcam-buttonContainer"},t?s(this.props):null," ",e?a(this.props):null),r("div",{class:"uppy-Webcam-recordingLength"},i?c(this.props):null)))},n}(o);e.exports=p},51594:function(e,t,i){var n=i(75045).h;e.exports=function(e){return n("div",{class:"uppy-Webcam-permissons"},n("div",{class:"uppy-Webcam-permissonsIcon"},e.icon()),n("h1",{class:"uppy-Webcam-title"},e.hasCamera?e.i18n("allowAccessTitle"):e.i18n("noCameraTitle")),n("p",null,e.hasCamera?e.i18n("allowAccessDescription"):e.i18n("noCameraDescription")))}},60848:function(e,t,i){var n=i(75045).h;e.exports=function(e){var t=e.recording,i=e.onStartRecording,r=e.onStopRecording,o=e.i18n;return t?n("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:o("stopRecording"),"aria-label":o("stopRecording"),onclick:r,"data-uppy-super-focusable":!0},n("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},n("rect",{x:"15",y:"15",width:"70",height:"70"}))):n("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:o("startRecording"),"aria-label":o("startRecording"),onclick:i,"data-uppy-super-focusable":!0},n("svg",{"aria-hidden":"true",focusable:"false",class:"uppy-c-icon",width:"100",height:"100",viewBox:"0 0 100 100"},n("circle",{cx:"50",cy:"50",r:"40"})))}},46836:function(e,t,i){var n=i(75045).h,r=i(97798);e.exports=function(e){var t=e.recordingLengthSeconds,i=e.i18n,o=r(t);return n("span",{"aria-label":i("recordingLength",{recording_length:o})},o)}},51949:function(e,t,i){var n=i(75045).h,r=i(20170);e.exports=function(e){var t=e.onSnapshot,i=e.i18n;return n("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture",type:"button",title:i("takePicture"),"aria-label":i("takePicture"),onclick:t,"data-uppy-super-focusable":!0},r())}},9414:function(e,t,i){var n=i(75045).h;e.exports=function(e){var t=e.currentDeviceId,i=e.videoSources,r=e.onChangeVideoSource;return n("div",{className:"uppy-Webcam-videoSource"},n("select",{className:"uppy-u-reset uppy-Webcam-videoSource-select",onchange:function(e){r(e.target.value)}},i.map((function(e){return n("option",{key:e.deviceId,value:e.deviceId,selected:e.deviceId===t},e.label)}))))}},97798:function(e){e.exports=function(e){return Math.floor(e/60)+":"+String(e%60).padStart(2,0)}},37037:function(e,t,i){var n,r;function o(){return o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e},o.apply(this,arguments)}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var a=i(75045).h,c=i(92432).Plugin,u=i(12540),l=i(82227),p=i(29233),h=i(63759),d=i(96431),f=i(20170),g=i(58950),v=i(51594);function m(e){return"."===e[0]?p[e.slice(1)]:e}function y(e){return/^video\/[^*]+$/.test(e)}function b(e){return/^image\/[^*]+$/.test(e)}e.exports=(r=n=function(e){var t,i;function n(t,i){var n;(n=e.call(this,t,i)||this).mediaDevices=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices;var e=navigator.mozGetUserMedia||navigator.webkitGetUserMedia;return e?{getUserMedia:function(t){return new Promise((function(i,n){e.call(navigator,t,i,n)}))}}:null}(),n.supportsUserMedia=!!n.mediaDevices,n.protocol=location.protocol.match(/https/i)?"https":"http",n.id=n.opts.id||"Webcam",n.title=n.opts.title||"Camera",n.type="acquirer",n.icon=function(){return a("svg",{"aria-hidden":"true",focusable:"false",width:"32",height:"32",viewBox:"0 0 32 32"},a("g",{fill:"none","fill-rule":"evenodd"},a("rect",{fill:"#03BFEF",width:"32",height:"32",rx:"16"}),a("path",{d:"M22 11c1.133 0 2 .867 2 2v7.333c0 1.134-.867 2-2 2H10c-1.133 0-2-.866-2-2V13c0-1.133.867-2 2-2h2.333l1.134-1.733C13.6 9.133 13.8 9 14 9h4c.2 0 .4.133.533.267L19.667 11H22zm-6 1.533a3.764 3.764 0 0 0-3.8 3.8c0 2.129 1.672 3.801 3.8 3.801s3.8-1.672 3.8-3.8c0-2.13-1.672-3.801-3.8-3.801zm0 6.261c-1.395 0-2.46-1.066-2.46-2.46 0-1.395 1.065-2.461 2.46-2.461s2.46 1.066 2.46 2.46c0 1.395-1.065 2.461-2.46 2.461z",fill:"#FFF","fill-rule":"nonzero"})))},n.defaultLocale={strings:{smile:"Smile!",takePicture:"Take a picture",startRecording:"Begin video recording",stopRecording:"Stop video recording",allowAccessTitle:"Please allow access to your camera",allowAccessDescription:"In order to take pictures or record video with your camera, please allow camera access for this site.",noCameraTitle:"Camera Not Available",noCameraDescription:"In order to take pictures or record video, please connect a camera device",recordingStoppedMaxSize:"Recording stopped because the file size is about to exceed the limit",recordingLength:"Recording length %{recording_length}"}};var r={onBeforeSnapshot:function(){return Promise.resolve()},countdown:!1,modes:["video-audio","video-only","audio-only","picture"],mirror:!0,showVideoSourceDropdown:!1,facingMode:"user",preferredImageMimeType:null,preferredVideoMimeType:null,showRecordingLength:!1};return n.opts=o({},r,i),n.i18nInit(),n.install=n.install.bind(s(n)),n.setPluginState=n.setPluginState.bind(s(n)),n.render=n.render.bind(s(n)),n._start=n._start.bind(s(n)),n._stop=n._stop.bind(s(n)),n._takeSnapshot=n._takeSnapshot.bind(s(n)),n._startRecording=n._startRecording.bind(s(n)),n._stopRecording=n._stopRecording.bind(s(n)),n._oneTwoThreeSmile=n._oneTwoThreeSmile.bind(s(n)),n._focus=n._focus.bind(s(n)),n._changeVideoSource=n._changeVideoSource.bind(s(n)),n.webcamActive=!1,n.opts.countdown&&(n.opts.onBeforeSnapshot=n._oneTwoThreeSmile),n.setPluginState({hasCamera:!1,cameraReady:!1,cameraError:null,recordingLengthSeconds:0,videoSources:[],currentDeviceId:null}),n}i=e,(t=n).prototype=Object.create(i.prototype),t.prototype.constructor=t,t.__proto__=i;var r=n.prototype;return r.setOptions=function(t){e.prototype.setOptions.call(this,o({},t,{videoConstraints:o({},this.opts.videoConstraints,null==t?void 0:t.videoConstraints)})),this.i18nInit()},r.i18nInit=function(){this.translator=new u([this.defaultLocale,this.uppy.locale,this.opts.locale]),this.i18n=this.translator.translate.bind(this.translator),this.i18nArray=this.translator.translateArray.bind(this.translator),this.setPluginState()},r.hasCameraCheck=function(){return this.mediaDevices?this.mediaDevices.enumerateDevices().then((function(e){return e.some((function(e){return"videoinput"===e.kind}))})):Promise.resolve(!1)},r.getConstraints=function(e){var t;void 0===e&&(e=null);var i=-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("audio-only"),n=-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("video-only")||-1!==this.opts.modes.indexOf("picture"),r=o({},null!=(t=this.opts.videoConstraints)?t:{facingMode:this.opts.facingMode},e?{deviceId:e,facingMode:null}:{});return{audio:i,video:!!n&&r}},r._start=function(e){var t=this;if(void 0===e&&(e=null),!this.supportsUserMedia)return Promise.reject(new Error("Webcam access not supported"));this.webcamActive=!0;var i=this.getConstraints(e&&e.deviceId?e.deviceId:null);this.hasCameraCheck().then((function(n){return t.setPluginState({hasCamera:n}),t.mediaDevices.getUserMedia(i).then((function(i){t.stream=i;var n=null;e&&e.deviceId?i.getVideoTracks().forEach((function(t){t.getSettings().deviceId===e.deviceId&&(n=t.getSettings().deviceId)})):n=i.getVideoTracks()[0].getSettings().deviceId,t.updateVideoSources(),t.setPluginState({currentDeviceId:n,cameraReady:!0})})).catch((function(e){t.setPluginState({cameraReady:!1,cameraError:e}),t.uppy.info(e.message,"error")}))}))},r._getMediaRecorderOptions=function(){var e={};if(MediaRecorder.isTypeSupported){var t=this.uppy.opts.restrictions,i=[];this.opts.preferredVideoMimeType?i=[this.opts.preferredVideoMimeType]:t.allowedFileTypes&&(i=t.allowedFileTypes.map(m).filter(y));var n=i.filter((function(e){return MediaRecorder.isTypeSupported(e)&&l(e)}));n.length>0&&(e.mimeType=n[0])}return e},r._startRecording=function(){var e=this;this.recorder=new MediaRecorder(this.stream,this._getMediaRecorderOptions()),this.recordingChunks=[];var t=!1;this.recorder.addEventListener("dataavailable",(function(i){e.recordingChunks.push(i.data);var n=e.uppy.opts.restrictions;if(e.recordingChunks.length>1&&null!=n.maxFileSize&&!t){var r=e.recordingChunks.reduce((function(e,t){return e+t.size}),0),o=3*((r-e.recordingChunks[0].size)/(e.recordingChunks.length-1));r>Math.max(0,n.maxFileSize-o)&&(t=!0,e.uppy.info(e.i18n("recordingStoppedMaxSize"),"warning",4e3),e._stopRecording())}})),this.recorder.start(500),this.opts.showRecordingLength&&(this.recordingLengthTimer=setInterval((function(){var t=e.getPluginState().recordingLengthSeconds;e.setPluginState({recordingLengthSeconds:t+1})}),1e3)),this.setPluginState({isRecording:!0})},r._stopRecording=function(){var e=this;return new Promise((function(t,i){e.recorder.addEventListener("stop",(function(){t()})),e.recorder.stop(),e.opts.showRecordingLength&&(clearInterval(e.recordingLengthTimer),e.setPluginState({recordingLengthSeconds:0}))})).then((function(){return e.setPluginState({isRecording:!1}),e.getVideo()})).then((function(t){try{e.uppy.addFile(t)}catch(i){i.isRestriction||e.uppy.log(i)}})).then((function(){e.recordingChunks=null,e.recorder=null}),(function(t){throw e.recordingChunks=null,e.recorder=null,t}))},r._stop=function(){this.stream&&(this.stream.getAudioTracks().forEach((function(e){e.stop()})),this.stream.getVideoTracks().forEach((function(e){e.stop()}))),this.webcamActive=!1,this.stream=null},r._getVideoElement=function(){return this.el.querySelector(".uppy-Webcam-video")},r._oneTwoThreeSmile=function(){var e=this;return new Promise((function(t,i){var n=e.opts.countdown,r=setInterval((function(){if(!e.webcamActive)return clearInterval(r),e.captureInProgress=!1,i(new Error("Webcam is not active"));n>0?(e.uppy.info(n+"...","warning",800),n--):(clearInterval(r),e.uppy.info(e.i18n("smile"),"success",1500),setTimeout((function(){return t()}),1500))}),1e3)}))},r._takeSnapshot=function(){var e=this;this.captureInProgress||(this.captureInProgress=!0,this.opts.onBeforeSnapshot().catch((function(t){var i="object"===typeof t?t.message:t;return e.uppy.info(i,"error",5e3),Promise.reject(new Error("onBeforeSnapshot: "+i))})).then((function(){return e._getImage()})).then((function(t){e.captureInProgress=!1;try{e.uppy.addFile(t)}catch(i){i.isRestriction||e.uppy.log(i)}}),(function(t){throw e.captureInProgress=!1,t})))},r._getImage=function(){var e=this,t=this._getVideoElement();if(!t)return Promise.reject(new Error("No video element found, likely due to the Webcam tab being closed."));var i=t.videoWidth,n=t.videoHeight,r=document.createElement("canvas");r.width=i,r.height=n,r.getContext("2d").drawImage(t,0,0);var o=this.uppy.opts.restrictions,s=[];this.opts.preferredImageMimeType?s=[this.opts.preferredImageMimeType]:o.allowedFileTypes&&(s=o.allowedFileTypes.map(m).filter(b));var a=s[0]||"image/jpeg",c=l(a)||"jpg",u="cam-"+Date.now()+"."+c;return h(r,a).then((function(t){return{source:e.id,name:u,data:new Blob([t],{type:a}),type:a}}))},r.getVideo=function(){var e=this.recordingChunks[0].type,t=l(e);if(!t)return Promise.reject(new Error('Could not retrieve recording: Unsupported media type "'+e+'"'));var i="webcam-"+Date.now()+"."+t,n=new Blob(this.recordingChunks,{type:e}),r={source:this.id,name:i,data:new Blob([n],{type:e}),type:e};return Promise.resolve(r)},r._focus=function(){var e=this;this.opts.countdown&&setTimeout((function(){e.uppy.info(e.i18n("smile"),"success",1500)}),1e3)},r._changeVideoSource=function(e){this._stop(),this._start({deviceId:e})},r.updateVideoSources=function(){var e=this;this.mediaDevices.enumerateDevices().then((function(t){e.setPluginState({videoSources:t.filter((function(e){return"videoinput"===e.kind}))})}))},r.render=function(){this.webcamActive||this._start();var e=this.getPluginState();return e.cameraReady&&e.hasCamera?a(g,o({},e,{onChangeVideoSource:this._changeVideoSource,onSnapshot:this._takeSnapshot,onStartRecording:this._startRecording,onStopRecording:this._stopRecording,onFocus:this._focus,onStop:this._stop,i18n:this.i18n,modes:this.opts.modes,showRecordingLength:this.opts.showRecordingLength,showVideoSourceDropdown:this.opts.showVideoSourceDropdown,supportsRecording:d(),recording:e.isRecording,mirror:this.opts.mirror,src:this.stream})):a(v,{icon:f,i18n:this.i18n,hasCamera:e.hasCamera})},r.install=function(){var e=this;this.setPluginState({cameraReady:!1,recordingLengthSeconds:0});var t=this.opts.target;t&&this.mount(t,this),this.mediaDevices&&(this.updateVideoSources(),this.mediaDevices.ondevicechange=function(t){if(e.updateVideoSources(),e.stream){var i=!0,n=e.getPluginState(),r=n.videoSources,o=n.currentDeviceId;r.forEach((function(e){o===e.deviceId&&(i=!1)})),i&&(e._stop(),e._start())}})},r.uninstall=function(){this.stream&&this._stop(),this.unmount()},n}(c),n.VERSION="1.8.4",r)},96431:function(e){e.exports=function(){return"function"===typeof MediaRecorder&&!!MediaRecorder.prototype&&"function"===typeof MediaRecorder.prototype.start}},38284:function(e){var t=Object.prototype.hasOwnProperty;e.exports=function e(i,n){var r=[];for(var o in i)if(t.call(i,o)){var s,a=i[o],c=encodeURIComponent(o);s="object"===typeof a?e(a,n?n+"["+c+"]":c):(n?n+"["+c+"]":c)+"="+encodeURIComponent(a),r.push(s)}return r.join("&")}}}]);
//# sourceMappingURL=uppy.90314db9.chunk.js.map